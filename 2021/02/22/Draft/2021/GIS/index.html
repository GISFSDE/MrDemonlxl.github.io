<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>GIS - 魑魅先生</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="魑魅先生"><meta name="msapplication-TileImage" content="https://gitee.com/mychimei/picture/raw/master/透明头像.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="魑魅先生"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="MAPBOX MAPBOX流程  准备：熟悉linux 安装、网络、文件等基本操作，JS、HTML等熟悉，Mapbox熟悉，SQL熟悉，，， 注意参数：同一套坐标、经纬度等   Ubuntu环境准备&amp;#x3D;&amp;#x3D;&amp;#x3D;》其他格式数据&amp;#x3D;&amp;#x3D;&amp;#x3D;》shp数据&amp;#x3D;&amp;#x3D;&amp;#x3D;》Windows导入postgresql数据库&amp;#x3D;&amp;#x3D;&amp;#x3D;》通过ogr2ogr转换为geojson&amp;#x3D;&amp;#x3D;&amp;#x3D;》通过tippecanoe切片（参数自控）》~~数据打包（传"><meta property="og:type" content="blog"><meta property="og:title" content="魑魅先生"><meta property="og:url" content="https://mrdemonlxl.github.io/"><meta property="og:site_name" content="魑魅先生"><meta property="og:description" content="MAPBOX MAPBOX流程  准备：熟悉linux 安装、网络、文件等基本操作，JS、HTML等熟悉，Mapbox熟悉，SQL熟悉，，， 注意参数：同一套坐标、经纬度等   Ubuntu环境准备&amp;#x3D;&amp;#x3D;&amp;#x3D;》其他格式数据&amp;#x3D;&amp;#x3D;&amp;#x3D;》shp数据&amp;#x3D;&amp;#x3D;&amp;#x3D;》Windows导入postgresql数据库&amp;#x3D;&amp;#x3D;&amp;#x3D;》通过ogr2ogr转换为geojson&amp;#x3D;&amp;#x3D;&amp;#x3D;》通过tippecanoe切片（参数自控）》~~数据打包（传"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://gitee.com/mychimei/picture/raw/master/微信图片_20210131173244.jpg"><meta property="article:published_time" content="2021-02-22T14:10:43.000Z"><meta property="article:modified_time" content="2022-03-23T15:12:00.544Z"><meta property="article:author" content="mrdemonlxl"><meta property="article:tag" content="前端"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://gitee.com/mychimei/picture/raw/master/微信图片_20210131173244.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://mrdemonlxl.github.io/2021/02/22/Draft/2021/GIS/"},"headline":"魑魅先生","image":["https://gitee.com/mychimei/picture/raw/master/屏幕截图 2021-02-19 212211.png"],"datePublished":"2021-02-22T14:10:43.000Z","dateModified":"2022-03-23T15:12:00.544Z","author":{"@type":"Person","name":"魑魅先生"},"description":"MAPBOX MAPBOX流程  准备：熟悉linux 安装、网络、文件等基本操作，JS、HTML等熟悉，Mapbox熟悉，SQL熟悉，，， 注意参数：同一套坐标、经纬度等   Ubuntu环境准备&#x3D;&#x3D;&#x3D;》其他格式数据&#x3D;&#x3D;&#x3D;》shp数据&#x3D;&#x3D;&#x3D;》Windows导入postgresql数据库&#x3D;&#x3D;&#x3D;》通过ogr2ogr转换为geojson&#x3D;&#x3D;&#x3D;》通过tippecanoe切片（参数自控）》~~数据打包（传"}</script><link rel="canonical" href="http://mrdemonlxl.github.io/2021/02/22/Draft/2021/GIS/"><link rel="icon" href="https://gitee.com/mychimei/picture/raw/master/透明头像.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><link rel="stylesheet" href="/live2d/waifu.css"><script type="text/javascript" async src="/live2d/autoload.js"></script><meta name="generator" content="Hexo 5.3.0"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://gitee.com/mychimei/picture/raw/master/彩色logo.png" alt="魑魅先生" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/album">相册</a><a class="navbar-item" href="/friend">友链</a><a class="navbar-item" href="/message">留言</a><a class="navbar-item" href="/self-talking">碎碎念</a><a class="navbar-item" href="/music">音乐</a><a class="navbar-item" href="/media">影音</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Join Gitter" href="https://gitter.im/hexo-theme-amazing/community"><i class="fab fa-gitter"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="https://gitee.com/mychimei/picture/raw/master/屏幕截图 2021-02-19 212211.png" alt="GIS"></span></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2021-02-22  <a class="commentCountImg" href="/2021/02/22/Draft/2021/GIS/#comment-container"><span class="display-none-class">8aed1d935e7f063b128198e8e550082c</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="8aed1d935e7f063b128198e8e550082c">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>2 小时  <i class="fas fa-pencil-alt"> </i>18.3 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">GIS</h1><div class="content"><h1 id="mapbox">MAPBOX</h1>
<h2 id="mapbox%E6%B5%81%E7%A8%8B" id="MAPBOX流程">MAPBOX流程</h2>
<blockquote>
<p>准备：熟悉linux 安装、网络、文件等基本操作，JS、HTML等熟悉，Mapbox熟悉，SQL熟悉，，，</p>
<p>注意参数：同一套坐标、经纬度等</p>
</blockquote>
<blockquote>
<p>Ubuntu环境准备===》其他格式数据===》shp数据===》Windows导入postgresql数据库===》通过ogr2ogr转换为geojson===》通过tippecanoe切片（参数自控）<mark>》~~数据打包（传输更快）~~windows共享文件夹</mark>=》准备mapbox2000 js css文件====》mapbox前端代码导入数据并显示====》准备图标数据===》filter分类图标显示=====》分层数据显示====》细节优化（颜色，光，字体大小，图片大小）<mark><mark>》加入点击显示位置</mark></mark>》其他点击功能====》wfts底图切换==》控件加载===》wfs，wms数据加载（不同数据源）==》其他模型加入</p>
</blockquote>
<a id="more"></a>
<h2 id="%E8%AF%A6%E7%BB%86%E6%AD%A5%E9%AA%A4" id="详细步骤">详细步骤</h2>
<h3 id="%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87" id="环境准备"><a target="_blank" rel="noopener" href="https://my.oschina.net/u/1464512/blog/1631972">环境准备</a></h3>
<h4 id="ubuntu%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%9A" id="Ubuntu虚拟机：">Ubuntu虚拟机：</h4>
<p>网络环境，数据共享，Postgresql，Tippecanoe，PROJ.4、GEOS和GDAL（ogr2ogr），gcc、g++、make</p>
<h3 id="windows%EF%BC%9A" id="windows：">windows：</h3>
<p>Postgresql,VMware,Ubuntu镜像（官方指定），Navicat（方便查看数据和建立空间数据库），VSCode</p>
<h3 id="%E8%AF%A6%E7%BB%86%E6%AD%A5%E9%AA%A4%EF%BC%9A" id="详细步骤：">详细步骤：</h3>
<ol>
<li>
<h4 id="%E5%AE%89%E8%A3%85postgresql%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8C%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%EF%BC%8C%E5%AF%BC%E5%85%A5shp" id="安装Postgresql数据库，环境配置，导入shp"><a target="_blank" rel="noopener" href="https://blog.csdn.net/zhangshuanlai/article/details/84100165">安装Postgresql数据库，环境配置，导入shp</a></h4>
<h4 id="windows%E5%AE%89%E8%A3%85postgresql" id="Windows安装Postgresql">Windows安装Postgresql</h4>
<p><a target="_blank" rel="noopener" href="https://www.postgresql.org/">下载</a></p>
<p>环境变量添加</p>
<p>设置外网访问（pg_hba.conf）</p>
<figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># <span class="type">TYPE</span>  <span class="type">DATABASE</span>        <span class="type">USER</span>            <span class="type">ADDRESS</span>                 <span class="type">METHOD</span></span><br><span class="line"></span><br><span class="line"># <span class="type">IPv4</span> local connections:</span><br><span class="line"><span class="title">host</span>    all             all             <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/<span class="number">32</span>            md5</span><br><span class="line"><span class="title">host</span>    all             all             <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">0</span>            md5</span><br><span class="line"># <span class="type">IPv6</span> local connections:</span><br><span class="line"><span class="title">host</span>    all             all             ::<span class="number">1</span>/<span class="number">128</span>                 md5</span><br><span class="line"># <span class="type">Allow</span> replication connections from localhost, by a user with the</span><br><span class="line"># replication privilege.</span><br><span class="line">#host    replication     postgres        <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/<span class="number">32</span>            md5</span><br><span class="line">#host    replication     postgres        ::<span class="number">1</span>/<span class="number">128</span>                 md5</span><br></pre></td></tr></table></figure>
<p>建立空间数据库,目标数据库执行以下语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> extension postgis;</span><br><span class="line"><span class="keyword">create</span> extension postgis_topology;</span><br><span class="line"><span class="keyword">create</span> extension fuzzystrmatch;</span><br><span class="line"><span class="keyword">create</span> extension postgis_tiger_geocoder;</span><br></pre></td></tr></table></figure>
<p>在SHP文件夹新建txt文件，粘贴以下代码，导入数据到数据库，相关参数如下，改成bat后缀，双击运行后输入密码，显示类似 insert 1成功</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shp2pgsql <span class="operator">-</span>s <span class="number">4544</span> <span class="operator">-</span>c <span class="operator">-</span>W “GBK” DJQ5120812018.shp public.DJQ5120812018 <span class="operator">|</span> psql <span class="operator">-</span>d shp2pgsqldemo <span class="operator">-</span>U postgres <span class="operator">-</span>W</span><br><span class="line">示例  ：shp2pgsql <span class="operator">-</span>s <span class="number">4544</span> <span class="operator">-</span>c <span class="operator">-</span>W &quot;UTF-8&quot; ADDRESS.shp  public.rrrrr<span class="operator">|</span> psql <span class="operator">-</span>h <span class="number">192.168</span><span class="number">.22</span><span class="number">.128</span> <span class="operator">-</span>d postgres <span class="operator">-</span>U postgres <span class="operator">-</span>W</span><br><span class="line">                               编码格式  SHP数据    public下的rrrrr表        导入数据库地址     数据库名     用户名</span><br></pre></td></tr></table></figure>
<p>也可分为两个步骤，先转换为sql语句，再导入,步骤同上</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shp2pgsql -s 4544 -c -W “GBK” DJQ5120812018.shp&gt;DJQ5120812018.sql</span><br><span class="line">psql -d shp2pgsqldemo -U postgres -f DJQ5120812018.sql -W</span><br></pre></td></tr></table></figure>
<h4 id="%E5%8F%AF%E8%83%BD%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98-%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95" id="可能出现的问题-解决办法">可能出现的问题                 解决办法</h4>
<p>乱码                                     更改编码</p>
<p>导入中断，数据库无数据     数据过大</p>
<h4 id="%E5%8F%82%E6%95%B0-%E5%90%AB%E4%B9%89" id="参数-含义">参数	               含义</h4>
<p>-s		空间参考标识符（SRID）<br />
-d    	重新建立表，并插入数据</p>
<p>-a   	 在同一个表中增加数据</p>
<p>-c 		建立新表，并插入数据(缺省)</p>
<p>-p		只创建表</p>
<p>-g		 指定要创建的表的空间字段名称(在追加数据时有用)<br />
-D 		使用dump方式，比缺省生成sql的速度快<br />
-G 		使用类型geography<br />
-k		 保持标识符（列名，模式，属性）大小写。<br />
-i		 将所有整型都转为标准的32-bit整数<br />
-I 		在几何列上建立GIST索引<br />
-S		生成简单几何，而非MULTI几何<br />
-t		  指定几何的维度<br />
-w		指定输出格式为WKT<br />
-W		输入的dbf文件编码方式<br />
-N		指定几何为空时的操作<br />
-n		只导入dbf文件<br />
-T		指定表的表空间<br />
-X		指定索引的表空间<br />
-?		帮助</p>
</li>
<li>
<h4 id="%E9%80%9A%E8%BF%87ogr2ogr%E8%BD%AC%E6%8D%A2%E4%B8%BAgeojson" id="通过ogr2ogr转换为geojson">通过ogr2ogr转换为geojson</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ogr2ogr <span class="operator">-</span>f &quot;GeoJSON&quot; .<span class="operator">/</span>asstln.json PG:&quot;host=localhost dbname=postgres user=postgres password=111111&quot; <span class="operator">-</span><span class="keyword">sql</span> &quot;select * from asstln&quot;</span><br><span class="line">                       目标文件名          导出数据库连接信息                                                            导出表名</span><br></pre></td></tr></table></figure>
</li>
<li>
<h4 id="%E9%80%9A%E8%BF%87tippecanoe%E5%88%87%E7%89%87%EF%BC%88%E5%8F%82%E6%95%B0%E8%87%AA%E6%8E%A7%EF%BC%89" id="通过tippecanoe切片（参数自控）">通过tippecanoe切片（参数自控）</h4>
<p><strong>单数据源</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tippecanoe <span class="operator">-</span>e tracenln <span class="operator">-</span>pC <span class="operator">-</span>Z0 <span class="operator">-</span>z20 <span class="operator">-</span>f tracenln.json</span><br><span class="line">              目标文件夹     切片等级空值   源文件名</span><br></pre></td></tr></table></figure>
<p><strong>单层多数据源合并</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">where</span>确定级别</span><br><span class="line">ogr2ogr <span class="operator">-</span>f &quot;GeoJSON&quot; .<span class="operator">/</span>veg_py.json PG:&quot;host=126.10.9.16 dbname=postgres user=postgres password=724111&quot; <span class="operator">-</span><span class="keyword">sql</span> &quot;select * from veg_py fscale=10&quot; </span><br><span class="line">tippecanoe <span class="operator">-</span>e tracenln <span class="operator">-</span>pC <span class="operator">-</span>Z0 <span class="operator">-</span>z20 <span class="operator">-</span>f tracenln1.json tracenln2.json tracenln3.json</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://www.yuque.com/geoway-vision/vision/tippecanoe">参数查看</a></p>
</li>
<li>
<h4 id="%E6%95%B0%E6%8D%AE%E6%89%93%E5%8C%85-%E5%A4%8D%E5%88%B6%E5%88%B0%E7%BC%96%E7%A8%8B%E7%AB%AF%EF%BC%88%E4%BC%A0%E8%BE%93%E6%9B%B4%E5%BF%AB%EF%BC%89-windows%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%8C%E6%88%96tomcat%EF%BC%8C%E6%88%96%E5%9C%A8%E7%BA%BF%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A5%E4%BE%BF%E6%95%B0%E6%8D%AE%E8%B0%83%E7%94%A8%EF%BC%8C%E6%B3%A8%E6%84%8F%E8%A7%A3%E5%86%B3%E8%A7%A6%E8%B7%A8%E5%9F%9F%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE" id="数据打包-复制到编程端（传输更快）-windows文件共享文件夹，或Tomcat，或在线服务器以便数据调用，注意解决触跨域资源访问"><s>数据打包</s> <s>复制到编程端（传输更快）</s>   windows文件共享文件夹，或Tomcat，或在线服务器以便数据调用，注意解决触跨域资源访问</h4>
<p><img src="https://gitee.com/mychimei/picture/raw/master/image-20210325142648372.png" alt="image-20210325142648372" /></p>
</li>
<li>
<h4 id="%E5%87%86%E5%A4%87mapbox2000-js-css%E6%96%87%E4%BB%B6" id="准备mapbox2000-js-css文件">准备mapbox2000 js css文件</h4>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/donglaoxie/article/details/104453761">windows 安装 git</a><br />
<a target="_blank" rel="noopener" href="https://blog.csdn.net/donglaoxie/article/details/104513190">Node.JS 安装说明</a><br />
<a target="_blank" rel="noopener" href="https://blog.csdn.net/donglaoxie/article/details/104520798">Yarn安装、配置、镜像源修改</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install --global yarn</span><br><span class="line">yarn --version</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/donglaoxie/article/details/104532608">Node.js安装本地插件构建工具node-gyp</a><br />
GitHub Mapbox源码地址：<a target="_blank" rel="noopener" href="https://github.com/mapbox/mapbox-gl-js">https://github.com/mapbox/mapbox-gl-js</a>     <a target="_blank" rel="noopener" href="https://github.com/cgcs2000/tippecanoe">2000坐标源码</a>，</p>
<h4 id="%E9%A1%B9%E7%9B%AE%E7%BC%96%E8%AF%91" id="项目编译">项目编译</h4>
<ol>
<li>
<p>yarn install</p>
</li>
<li>
<p>安装headless-gl，并将node_modules/headless-gl/deps/windows/dll/x64/*.dll 复制到c:\windows\system32<br />
npm install gl<br />
yarn run start-debug<br />
yarn run build-dev</p>
<p>准备好js和css文件</p>
</li>
</ol>
</li>
<li>
<h4 id="mapbox-%E5%89%8D%E7%AB%AF%E4%BB%A3%E7%A0%81%E5%AF%BC%E5%85%A5%E5%9C%B0%E5%9B%BE%E6%95%B0%E6%8D%AE%E5%B9%B6%E6%98%BE%E7%A4%BA" id="mapbox-前端代码导入地图数据并显示">mapbox 前端代码导入地图数据并显示</h4>
</li>
<li>
<h4 id="3d%E6%A8%A1%E5%9E%8B" id="3D模型">3D模型</h4>
<p>针对对应的建筑数据，进行建筑物3D显示</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">paint: &#123;</span><br><span class="line">						<span class="comment">// &#x27;fill-color&#x27;: &#x27;red&#x27;,</span></span><br><span class="line">						<span class="comment">// &#x27;fill-opacity&#x27;: 1,</span></span><br><span class="line">						<span class="string">&#x27;fill-extrusion-color&#x27;</span>: <span class="string">&#x27;#f5f4ee&#x27;</span>,</span><br><span class="line">						<span class="comment">// use an &#x27;interpolate&#x27; expression to add a smooth transition effect to the</span></span><br><span class="line">						<span class="comment">// buildings as the user zooms in</span></span><br><span class="line">						<span class="string">&#x27;fill-extrusion-height&#x27;</span>: [</span><br><span class="line">							<span class="string">&quot;interpolate&quot;</span>, [<span class="string">&quot;linear&quot;</span>], [<span class="string">&quot;zoom&quot;</span>],</span><br><span class="line">							<span class="number">15</span>, <span class="number">0</span>,</span><br><span class="line">							<span class="number">15.05</span>, [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;height&quot;</span>]</span><br><span class="line">						],</span><br><span class="line">						<span class="string">&#x27;fill-extrusion-base&#x27;</span>: [</span><br><span class="line">							<span class="string">&quot;interpolate&quot;</span>, [<span class="string">&quot;linear&quot;</span>], [<span class="string">&quot;zoom&quot;</span>],</span><br><span class="line">							<span class="number">15</span>, <span class="number">0</span>,</span><br><span class="line">							<span class="number">15.05</span>, [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;min_height&quot;</span>]</span><br><span class="line">						],</span><br><span class="line">						<span class="string">&#x27;fill-extrusion-opacity&#x27;</span>: <span class="number">0.85</span></span><br><span class="line">					&#125;,</span><br></pre></td></tr></table></figure>
</li>
<li>
<h4 id="vscode-%E6%8F%92%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8" id="vscode-插件服务器">vscode 插件服务器</h4>
<p>插件安装 Live Server</p>
</li>
<li>
<h4 id="%E5%87%86%E5%A4%87%E5%9B%BE%E6%A0%87%E6%95%B0%E6%8D%AE%EF%BC%8Cpbf%E5%AD%97%E4%BD%93%E6%95%B0%E6%8D%AE" id="准备图标数据，PBF字体数据">准备图标数据，PBF字体数据</h4>
<p><a target="_blank" rel="noopener" href="https://github.com/mapbox/spritezero">https://github.com/mapbox/spritezero</a></p>
<p>从零生成图标资源工具，可网上下载</p>
<p>生成如图形式文件，<img src="https://gitee.com/mychimei/picture/raw/master/image-20210322153503623.png" alt="图表数据" /><img src="https://gitee.com/mychimei/picture/raw/master/image-20210322153604432.png" alt="字体数据" /></p>
</li>
<li>
<h4 id="filter-%E5%88%86%E7%B1%BB%E5%9B%BE%E6%A0%87%E6%98%BE%E7%A4%BA" id="filter-分类图标显示">filter 分类图标显示</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;filter&#x27;</span>: [</span><br><span class="line">							<span class="string">&#x27;any&#x27;</span>,</span><br><span class="line">							[</span><br><span class="line">								<span class="string">&#x27;==&#x27;</span>,</span><br><span class="line">								<span class="string">&#x27;fcode&#x27;</span>,</span><br><span class="line">								<span class="string">&#x27;4206002500&#x27;</span><span class="comment">//2</span></span><br><span class="line"></span><br><span class="line">							]</span><br><span class="line">							,[</span><br><span class="line">								<span class="string">&#x27;==&#x27;</span>,</span><br><span class="line">								<span class="string">&#x27;fcode&#x27;</span>,</span><br><span class="line">								<span class="string">&#x27;4305010500&#x27;</span><span class="comment">//2</span></span><br><span class="line"></span><br><span class="line">							]</span><br><span class="line">						],</span><br></pre></td></tr></table></figure>
</li>
<li>
<h4 id="%E5%88%86%E5%B1%82%E6%95%B0%E6%8D%AE%E6%98%BE%E7%A4%BA" id="分层数据显示">分层数据显示</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;layers&quot;: []&#x2F;&#x2F;中越靠前的在底层</span><br></pre></td></tr></table></figure>
</li>
<li>
<h4 id="%E7%BB%86%E8%8A%82%E4%BC%98%E5%8C%96%EF%BC%88%E9%A2%9C%E8%89%B2%EF%BC%8C%E5%85%89%EF%BC%8C%E5%AD%97%E4%BD%93%E5%A4%A7%E5%B0%8F%EF%BC%8C%E5%9B%BE%E7%89%87%E5%A4%A7%E5%B0%8F%EF%BC%89" id="细节优化（颜色，光，字体大小，图片大小）">细节优化（颜色，光，字体大小，图片大小）</h4>
</li>
<li>
<h4 id="%E6%8E%A7%E4%BB%B6%E5%8A%A0%E8%BD%BD" id="控件加载">控件加载</h4>
<p><img src="https://gitee.com/mychimei/picture/raw/master/image-20210322154135351.png" alt="image-20210322154135351" /></p>
<p><a target="_blank" rel="noopener" href="https://iclient.supermap.io/examples/mapboxgl/examples.html#iServer-map">Supermap查看</a></p>
</li>
<li>
<h4 id="%E5%8A%A0%E5%85%A5%E7%82%B9%E5%87%BB%E6%98%BE%E7%A4%BA%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF" id="加入点击显示相关信息">加入点击显示相关信息</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//弹出框</span></span><br><span class="line"></span><br><span class="line">​    map.on(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">​      <span class="keyword">var</span> features = map.queryRenderedFeatures(e.point, &#123;</span><br><span class="line">​        layers: [<span class="string">&#x27;13&#x27;</span>] <span class="comment">// replace this with the id of the layer</span></span><br><span class="line">​      &#125;);</span><br><span class="line">​      <span class="keyword">if</span> (!features.length) &#123;</span><br><span class="line">​        <span class="keyword">return</span>;</span><br><span class="line">​      &#125;</span><br><span class="line">​      <span class="keyword">var</span> feature = features[<span class="number">0</span>];</span><br><span class="line">​      <span class="keyword">var</span> popup = <span class="keyword">new</span> mapboxgl.Popup(&#123; <span class="attr">offset</span>: [<span class="number">0</span>, -<span class="number">15</span>] &#125;)</span><br><span class="line">​        .setLngLat(feature.geometry.coordinates)</span><br><span class="line">​        .setHTML(<span class="string">&#x27;&lt;h3&gt;&#x27;</span> + feature.properties.shortname + <span class="string">&#x27;&lt;/h3&gt;&lt;p&gt;&#x27;</span> + feature.properties.name + <span class="string">&#x27;&lt;/p&gt;&#x27;</span>)</span><br><span class="line">​        .addTo(map);</span><br><span class="line">​    &#125;);</span><br></pre></td></tr></table></figure>
</li>
<li>
<h4 id="wfts-%E5%BA%95%E5%9B%BE%E5%88%87%E6%8D%A2" id="wfts-底图切换">wfts 底图切换</h4>
</li>
<li>
<h4 id="wfs%EF%BC%8Cwms-%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%EF%BC%88%E4%B8%8D%E5%90%8C%E6%95%B0%E6%8D%AE%E6%BA%90%EF%BC%89" id="wfs，wms-数据加载（不同数据源）">wfs，wms 数据加载（不同数据源）</h4>
</li>
<li>
<h4 id="%E5%AE%9A%E4%BD%8D" id="定位">定位</h4>
</li>
<li>
<h4 id="%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2" id="数据查询">数据查询</h4>
</li>
<li>
<h4 id="%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96" id="数据可视化">数据可视化</h4>
<p><img src="https://gitee.com/mychimei/picture/raw/master/image-20210322154411490.png" alt="image-20210322154411490" /></p>
<p><a target="_blank" rel="noopener" href="https://iclient.supermap.io/examples/mapboxgl/examples.html#iServer-map">Supermap查看</a></p>
</li>
<li>
<h4 id="%E4%BC%98%E5%8C%96" id="优化">优化</h4>
<p>窗口样式优化，弹出框样式优化，字体等调节</p>
</li>
</ol>
<h2 id="%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%8A%80%E5%B7%A7" id="一些小技巧">一些小技巧</h2>
<p>待更新</p>
<h2 id="mapbox%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91" id="Mapbox源码编译">Mapbox源码编译</h2>
<h3 id="%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87-1" id="环境准备-v2">环境准备</h3>
<p><strong>GIT环境搭建：</strong><br />
详细点击：<a target="_blank" rel="noopener" href="https://blog.csdn.net/donglaoxie/article/details/104453761">（一）windows 安装 git</a><br />
<strong>Node.JS环境搭建：</strong><br />
详细点击：<a target="_blank" rel="noopener" href="https://blog.csdn.net/donglaoxie/article/details/104513190">（一）Node.JS 安装说明</a><br />
<strong>Yarn环境搭建：</strong><br />
详细点击：<a target="_blank" rel="noopener" href="https://blog.csdn.net/donglaoxie/article/details/104520798">（一）Yarn安装、配置、镜像源修改</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install --global yarn</span><br><span class="line">yarn --version</span><br></pre></td></tr></table></figure>
<p><strong>Npm and node-gyp依赖安装</strong><br />
详细点击：<a target="_blank" rel="noopener" href="https://blog.csdn.net/donglaoxie/article/details/104532608">（二）Node.js安装本地插件构建工具node-gyp</a><br />
<strong>其他地址：</strong><br />
GitHub Mapbox源码地址：<a target="_blank" rel="noopener" href="https://github.com/mapbox/mapbox-gl-js">https://github.com/mapbox/mapbox-gl-js</a></p>
<h3 id="%E9%A1%B9%E7%9B%AE%E7%BC%96%E8%AF%91-1" id="项目编译-v2">项目编译</h3>
<ol>
<li>
<p>yarn install</p>
</li>
<li>
<p>安装headless-gl，并将node_modules/headless-gl/deps/windows/dll/x64/*.dll 复制到c:\windows\system32<br />
npm install gl<br />
yarn run start-debug<br />
yarn run build-dev</p>
</li>
<li>
<p>debug/index.html中代码最上方增加token</p>
<script>
mapboxgl.accessToken='pk.eyJ1IjoibGltbiIsImEiOiJja2t1bG1na2IxZGU0MnZvNmlzY3FhZXM4In0.oQx4VguycOR4TK80Pyusmw';
var map = window.map = new mapboxgl.Map({
</li>
</ol>
<h3 id="mapbox%E4%B8%93%E4%B8%9A%E6%9C%AF%E8%AF%AD" id="MAPBOX专业术语">MAPBOX专业术语</h3>
<p>矢量瓦片：</p>
<p>栅格瓦片：</p>
<h3 id="mapbox%E5%AD%A6%E4%B9%A0" id="MAPBOX学习">MAPBOX学习</h3>
<p>中文文档：<a target="_blank" rel="noopener" href="http://www.mapbox.cn/mapbox-gl-js/api/">http://www.mapbox.cn/mapbox-gl-js/api/</a></p>
<h3 id="styles-(8)" id="Styles-8">Styles (8)</h3>
<p>为地图添加生成的图标<br />
为地图添加动画图标<br />
为地图生成及添加缺失的图标<br />
为地图添加图标<br />
使用自定义样式展示地图<br />
显示卫星地图<br />
改变一个地图的样式<br />
显示一个地图</p>
<h3 id="layers-(30)" id="Layers-30">Layers (30)</h3>
<p>用3D形式呈现建筑物<br />
拉伸多边形以绘制3D室内地图<br />
添加3D模型<br />
调整图层不透明度<br />
为线添加动画效果<br />
为一系列图像添加动画效果<br />
为点添加动画效果<br />
按照缩放级别改变建筑颜色<br />
更改标注的大小写<br />
显示具有自定义属性的HTML聚类<br />
创建样式聚类<br />
使用按钮更改图层颜色<br />
添加自定义样式图层<br />
给线添加数据驱动属性的样式。<br />
给圆添加数据驱动属性的样式<br />
显示多种文本格式并设置其样式<br />
为多边形添加图案<br />
在标签下添加新图层<br />
添加 GeoJSON 线<br />
绘制 GeoJSON 点<br />
添加 GeoJSON 多边形<br />
创建热力图图层<br />
添加晕暄<br />
使用表达式创建渐变色线条<br />
设置海洋深度数据样式<br />
显示和隐藏图层<br />
改变行政边界世界观<br />
根据缩放级别更新等值线图层<br />
变量标签位置<br />
可视化人口密度</p>
<h3 id="sources-(9)" id="Sources-9">Sources (9)</h3>
<p>将本地JSON数据与矢量切片图形连接<br />
添加影像<br />
添加实时数据<br />
更新实时要素<br />
添加栅格切片数据源<br />
添加一个第三方矢量切片来源<br />
添加一个矢量图片数据源<br />
添加一个视频<br />
添加一个 WMS 源</p>
<h3 id="user-interaction-(17)" id="User-interaction-17">User interaction (17)</h3>
<p>基于周边声音给3D建筑添加动画效果<br />
禁用地图旋转<br />
创建可拖动的点<br />
创建可拖动的标记（Marker）<br />
通过文本输入筛选符号<br />
在 map view 中筛选要素<br />
通过切换列表筛选符号<br />
创建悬停效果<br />
显示非交互式地图<br />
更改地图的语言<br />
高亮包含相似数据的部分<br />
从点击点周围选择特征<br />
限制地图平移在某一区域<br />
获取鼠标下点的特征<br />
切换交互<br />
创建时间滑动条<br />
高亮一个选择框范围内的特征</p>
<h3 id="camera-(11)" id="Camera-11">Camera (11)</h3>
<p>使地图相机环绕一点运动<br />
为路线中的点添加动画效果<br />
将地图居中于被单击的符号上<br />
缓慢飞至某个位置<br />
将地图缩放至边界框内<br />
飞至某一位置<br />
使用游戏式控件浏览地图<br />
跳至一系列地点<br />
以幻灯片形式播放地图位置。<br />
根据滚动位置飞到某处<br />
设置 pitch 和 bearing</p>
<h3 id="controls-and-overlays-(16)" id="Controls-and-overlays-16">Controls and overlays (16)</h3>
<p>为标记(marker)添加动画效果<br />
改变注释的默认位置<br />
使用 Markers 添加自定义图标<br />
禁用滚轮缩放<br />
全屏查看地图<br />
定位用户<br />
在不同地图之间滑动<br />
显示驾驶方向<br />
显示已绘制的多边形区域<br />
添加地理编码器<br />
利用地点名称添加标记<br />
点击时显示多边形信息<br />
悬浮时显示弹出窗<br />
点击时显示一个弹出窗<br />
显示一个弹出窗<br />
将弹出窗口附加到 marker 实例</p>
<h3 id="geocoder-(8)" id="Geocoder-8">Geocoder (8)</h3>
<p>从其他数据源中补充进一步的地理编码查询结果<br />
接收输入坐标至地理编码器<br />
使用地理编码器时采用自定义渲染功能<br />
将地理编码的结果限制在指定地区范围内<br />
在使用地理编码器的过程中结合使用自定义相机动画<br />
在地图上添加位置搜索框<br />
将地理编码器进行指定语言的本地化<br />
在Geocoder产生结果后设置一个点</p>
<h3 id="browser-support-(1)" id="Browser-support-1">Browser support (1)</h3>
<p>检查浏览器支持</p>
<h3 id="internationalization-support-(2)" id="Internationalization-support-2">Internationalization support (2)</h3>
<p>使用本地生成的表意文字<br />
为从右至左书写的脚本提供支持</p>
<h1 id="supermap"><a target="_blank" rel="noopener" href="https://iclient.supermap.io/examples/mapboxgl/examples.html#iServer-map">SUPERMAP</a></h1>
<p>一个mapbox华丽外衣与装备</p>
<h1 id="cusium">Cusium</h1>
<blockquote>
<p>3D、2.5D、2D地图展示</p>
</blockquote>
<h2 id="%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E5%87%86%E5%A4%87" id="源码解析准备">源码解析准备</h2>
<p><a target="_blank" rel="noopener" href="https://cesium.com/learn/">官网</a></p>
<p><a target="_blank" rel="noopener" href="http://cesium.xin/cesium/cn/Documentation1.72/index.html">中文文档</a></p>
<p><a target="_blank" rel="noopener" href="https://cesium.com/ion/?t=welcome">注册</a></p>
<p>源码：<a target="_blank" rel="noopener" href="https://cesium.com/learn/cesiumjs-learn/">下载</a></p>
<p>环境：node、npm</p>
<p>使用：VUE</p>
<p>运行：方法一：</p>
<ol>
<li>解压</li>
<li>打开命令行，进入当前目录</li>
<li>安装依赖，输入:cnpm install,等待安装完成，然后输入: node server.js</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cd ./Cesium-<span class="number">1.40</span></span><br><span class="line">$ cnpm install  ...  Installed <span class="number">37</span> packages  Linked <span class="number">569</span> latest versions</span><br><span class="line">$ npm start 或者 node server.js(新版本是 node server.cjs)</span><br><span class="line">Cesium development server running locally.  Connect to http:<span class="comment">//localhost:8080/复制</span></span><br></pre></td></tr></table></figure>
<p>方法二：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">这里如果使用 express发布遇到问题，可以使用 http-server</span><br><span class="line">$ npm install http-server -g</span><br><span class="line">$ http-server -c-<span class="number">1</span> (如果只输入http-server，更新代码后，页面不会同步更新)</span><br></pre></td></tr></table></figure>
<p>方法三：VSCode 插件运行</p>
<h2 id="%E8%8E%B7%E5%8F%96token" id="获取Token">获取Token</h2>
<p><img src="https://gitee.com/mychimei/picture/raw/master/work/image-20220113093336025.png" alt="image-20220113093336025" /></p>
<p>使用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Cesium.Ion.defaultAccessToken = <span class="string">&#x27;token&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> viewer = <span class="keyword">new</span> Cesium.Viewer(<span class="string">&quot;cesiumContainer&quot;</span>, &#123;&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="%E4%B8%BB%E9%A1%B5%E8%AF%B4%E6%98%8E" id="主页说明">主页说明</h2>
<hr />
<hr />
<h3 id="cesium-ion" id="Cesium-ion">Cesium ion</h3>
<p>Cesium ion is your hub for discovering 3D content and tiling your own data for streaming. CesiumJS and ion work together to enable you to build world class 3D mapping applications.</p>
<p><a target="_blank" rel="noopener" href="https://cesium.com/ion/signup/">Sign up for a free account</a> to get your access token required for using ion's Bing Maps global imagery and Cesium World Terrain assets.</p>
<h3 id="local-links" id="Local-links">Local links</h3>
<table>
<thead>
<tr>
<th><a target="_blank" rel="noopener" href="http://126.10.1.204:8081/Build/Documentation/index.html">Documentation</a></th>
<th>The complete API documentation and reference.</th>
</tr>
</thead>
<tbody>
<tr>
<td><a target="_blank" rel="noopener" href="http://126.10.1.204:8081/Apps/HelloWorld.html">Hello World</a></td>
<td>The simplest possible Cesium application.</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="http://126.10.1.204:8081/Apps/CesiumViewer/index.html">Cesium Viewer</a></td>
<td>A sample Cesium reference application which allows you to browse the globe and select from a variety of imagery and terrain layers as well as load CZML, GeoJSON, and other formats supported by Cesium.</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="http://126.10.1.204:8081/Apps/Sandcastle/index.html">Sandcastle</a></td>
<td>Cesium's live code editor and example gallery. Browse examples highlighting features of the Cesium API and edit and run them all in your web browser. Cesium applications created in Sandcastle can be saved and downloaded.</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="http://126.10.1.204:8081/Specs/SpecRunner.html">Run tests</a></td>
<td>Run Cesium's full suite of unit tests</td>
</tr>
</tbody>
</table>
<h3 id="external-links" id="External-links">External links</h3>
<table>
<thead>
<tr>
<th><a target="_blank" rel="noopener" href="https://cesium.com/">Cesium</a></th>
<th>Learn about the Cesium team and the Cesium ion platform</th>
</tr>
</thead>
<tbody>
<tr>
<td><a target="_blank" rel="noopener" href="https://cesium.com/blog/">Cesium Blog</a></td>
<td>Follow project news, developer tips, and posts about Cesium's innovative technology</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://cesium.com/learn/">Tutorials</a></td>
<td>Step-by-step guides for learning to use CesiumJS</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://community.cesium.com/">Community Forum</a></td>
<td>Questions and feedback welcome from all skill levels</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/CesiumGS/cesium">GitHub</a></td>
<td>The official CesiumJS GitHub repository</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://cesium.com/blog/categories/user-stories/">User Stories</a></td>
<td>Demos and information about projects using CesiumJS</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="http://webglreport.com/">WebGL Report</a></td>
<td>Provides technical information about WebGL capabilities supported by your browser</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h2 id="%E7%95%8C%E9%9D%A2%E4%BB%8B%E7%BB%8D" id="界面介绍">界面介绍</h2>
<p><img src="https://gitee.com/mychimei/picture/raw/master/work/image-20220111165928042.png" alt="" /></p>
<h2 id="%E8%87%AA%E9%A1%B9%E7%9B%AE%E7%BC%96%E5%86%99" id="自项目编写">自项目编写</h2>
<p>环境：VUE2 ，cesium  1.89</p>
<p>C:\Users\Administrator&gt;node -v<br />
v14.16.0</p>
<p>C:\Users\Administrator&gt;npm -v<br />
6.14.11</p>
<h3 id="%E9%A1%B9%E7%9B%AE%E5%88%9B%E5%BB%BA" id="项目创建">项目创建</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue init webpack gislearn</span><br></pre></td></tr></table></figure>
<h3 id="%E5%AE%89%E8%A3%85cesium-1.89" id="安装cesium-1-89">安装cesium  1.89</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i cesium</span><br></pre></td></tr></table></figure>
<h3 id="%E4%BF%AE%E6%94%B9webpack.prod.conf.js" id="修改webpack-prod-conf-js">修改webpack.prod.conf.js</h3>
<p>修改 --Cesium--标记处</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;./utils&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&#x27;../config&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">&#x27;webpack-merge&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> baseWebpackConfig = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.base.conf&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;copy-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">&#x27;extract-text-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> OptimizeCSSPlugin = <span class="built_in">require</span>(<span class="string">&#x27;optimize-css-assets-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> UglifyJsPlugin = <span class="built_in">require</span>(<span class="string">&#x27;uglifyjs-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="comment">// 定义路径--Cesium--</span></span><br><span class="line"><span class="keyword">const</span> cesiumSource = <span class="string">&#x27;node_modules/cesium/Source&#x27;</span></span><br><span class="line"><span class="keyword">const</span> cesiumWorkers = <span class="string">&#x27;../Build/Cesium/Workers&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> env = process.env.NODE_ENV === <span class="string">&#x27;testing&#x27;</span></span><br><span class="line">  ? <span class="built_in">require</span>(<span class="string">&#x27;../config/test.env&#x27;</span>)</span><br><span class="line">  : <span class="built_in">require</span>(<span class="string">&#x27;../config/prod.env&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> webpackConfig = merge(baseWebpackConfig, &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: utils.styleLoaders(&#123;</span><br><span class="line">      sourceMap: config.build.productionSourceMap,</span><br><span class="line">      extract: <span class="literal">true</span>,</span><br><span class="line">      usePostCSS: <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  devtool: config.build.productionSourceMap ? config.build.devtool : <span class="literal">false</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: config.build.assetsRoot,</span><br><span class="line">    filename: utils.assetsPath(<span class="string">&#x27;js/[name].[chunkhash].js&#x27;</span>),</span><br><span class="line">    chunkFilename: utils.assetsPath(<span class="string">&#x27;js/[id].[chunkhash].js&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// 添加如下插件--Cesium--</span></span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([&#123; <span class="attr">from</span>: path.join(cesiumSource, cesiumWorkers), <span class="attr">to</span>: <span class="string">&#x27;Workers&#x27;</span> &#125;]),</span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([&#123; <span class="attr">from</span>: path.join(cesiumSource, <span class="string">&#x27;Assets&#x27;</span>), <span class="attr">to</span>: <span class="string">&#x27;Assets&#x27;</span> &#125;]),</span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([&#123; <span class="attr">from</span>: path.join(cesiumSource, <span class="string">&#x27;Widgets&#x27;</span>), <span class="attr">to</span>: <span class="string">&#x27;Widgets&#x27;</span> &#125;]),</span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([&#123; <span class="attr">from</span>: path.join(cesiumSource, <span class="string">&#x27;ThirdParty/Workers&#x27;</span>), <span class="attr">to</span>: <span class="string">&#x27;ThirdParty/Workers&#x27;</span> &#125;]),</span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">      <span class="comment">// 注意这里和dev的配置不同</span></span><br><span class="line">      <span class="comment">// 定义Cesium从哪里加载资源，如果使用默认的&#x27;&#x27;，却变成了绝对路径了，所以这里使用&#x27;./&#x27;，使用相对路径</span></span><br><span class="line">      CESIUM_BASE_URL: <span class="built_in">JSON</span>.stringify(<span class="string">&#x27;./&#x27;</span>)</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// http://vuejs.github.io/vue-loader/en/workflow/production.html</span></span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">      <span class="string">&#x27;process.env&#x27;</span>: env</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> UglifyJsPlugin(&#123;</span><br><span class="line">      uglifyOptions: &#123;</span><br><span class="line">        compress: &#123;</span><br><span class="line">          warnings: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      sourceMap: config.build.productionSourceMap,</span><br><span class="line">      parallel: <span class="literal">true</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// extract css into its own file</span></span><br><span class="line">    <span class="keyword">new</span> ExtractTextPlugin(&#123;</span><br><span class="line">      filename: utils.assetsPath(<span class="string">&#x27;css/[name].[contenthash].css&#x27;</span>),</span><br><span class="line">      <span class="comment">// Setting the following option to `false` will not extract CSS from codesplit chunks.</span></span><br><span class="line">      <span class="comment">// Their CSS will instead be inserted dynamically with style-loader when the codesplit chunk has been loaded by webpack.</span></span><br><span class="line">      <span class="comment">// It&#x27;s currently set to `true` because we are seeing that sourcemaps are included in the codesplit bundle as well when it&#x27;s `false`, </span></span><br><span class="line">      <span class="comment">// increasing file size: https://github.com/vuejs-templates/webpack/issues/1110</span></span><br><span class="line">      allChunks: <span class="literal">true</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// Compress extracted CSS. We are using this plugin so that possible</span></span><br><span class="line">    <span class="comment">// duplicated CSS from different components can be deduped.</span></span><br><span class="line">    <span class="keyword">new</span> OptimizeCSSPlugin(&#123;</span><br><span class="line">      cssProcessorOptions: config.build.productionSourceMap</span><br><span class="line">        ? &#123; <span class="attr">safe</span>: <span class="literal">true</span>, <span class="attr">map</span>: &#123; <span class="attr">inline</span>: <span class="literal">false</span> &#125; &#125;</span><br><span class="line">        : &#123; <span class="attr">safe</span>: <span class="literal">true</span> &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// generate dist index.html with correct asset hash for caching.</span></span><br><span class="line">    <span class="comment">// you can customize output by editing /index.html</span></span><br><span class="line">    <span class="comment">// see https://github.com/ampedandwired/html-webpack-plugin</span></span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      filename: process.env.NODE_ENV === <span class="string">&#x27;testing&#x27;</span></span><br><span class="line">        ? <span class="string">&#x27;index.html&#x27;</span></span><br><span class="line">        : config.build.index,</span><br><span class="line">      template: <span class="string">&#x27;index.html&#x27;</span>,</span><br><span class="line">      inject: <span class="literal">true</span>,</span><br><span class="line">      minify: &#123;</span><br><span class="line">        removeComments: <span class="literal">true</span>,</span><br><span class="line">        collapseWhitespace: <span class="literal">true</span>,</span><br><span class="line">        removeAttributeQuotes: <span class="literal">true</span></span><br><span class="line">        <span class="comment">// more options:</span></span><br><span class="line">        <span class="comment">// https://github.com/kangax/html-minifier#options-quick-reference</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// necessary to consistently work with multiple chunks via CommonsChunkPlugin</span></span><br><span class="line">      chunksSortMode: <span class="string">&#x27;dependency&#x27;</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// keep module.id stable when vendor modules does not change</span></span><br><span class="line">    <span class="keyword">new</span> webpack.HashedModuleIdsPlugin(),</span><br><span class="line">    <span class="comment">// enable scope hoisting</span></span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.ModuleConcatenationPlugin(),</span><br><span class="line">    <span class="comment">// split vendor js into its own file</span></span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">      name: <span class="string">&#x27;vendor&#x27;</span>,</span><br><span class="line">      <span class="function"><span class="title">minChunks</span>(<span class="params"><span class="built_in">module</span></span>)</span> &#123;</span><br><span class="line">        <span class="comment">// any required modules inside node_modules are extracted to vendor</span></span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="built_in">module</span>.resource &amp;&amp;</span><br><span class="line">          /\.js$/.test(<span class="built_in">module</span>.resource) &amp;&amp;</span><br><span class="line">          <span class="built_in">module</span>.resource.indexOf(</span><br><span class="line">            path.join(__dirname, <span class="string">&#x27;../node_modules&#x27;</span>)</span><br><span class="line">          ) === <span class="number">0</span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// extract webpack runtime and module manifest to its own file in order to</span></span><br><span class="line">    <span class="comment">// prevent vendor hash from being updated whenever app bundle is updated</span></span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">      name: <span class="string">&#x27;manifest&#x27;</span>,</span><br><span class="line">      minChunks: <span class="literal">Infinity</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// This instance extracts shared chunks from code splitted chunks and bundles them</span></span><br><span class="line">    <span class="comment">// in a separate chunk, similar to the vendor chunk</span></span><br><span class="line">    <span class="comment">// see: https://webpack.js.org/plugins/commons-chunk-plugin/#extra-async-commons-chunk</span></span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">      name: <span class="string">&#x27;app&#x27;</span>,</span><br><span class="line">      <span class="keyword">async</span>: <span class="string">&#x27;vendor-async&#x27;</span>,</span><br><span class="line">      children: <span class="literal">true</span>,</span><br><span class="line">      minChunks: <span class="number">3</span></span><br><span class="line">    &#125;),</span><br><span class="line"></span><br><span class="line">    <span class="comment">// copy custom static assets</span></span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">from</span>: path.resolve(__dirname, <span class="string">&#x27;../static&#x27;</span>),</span><br><span class="line">        to: config.build.assetsSubDirectory,</span><br><span class="line">        ignore: [<span class="string">&#x27;.*&#x27;</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ])</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (config.build.productionGzip) &#123;</span><br><span class="line">  <span class="keyword">const</span> CompressionWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;compression-webpack-plugin&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  webpackConfig.plugins.push(</span><br><span class="line">    <span class="keyword">new</span> CompressionWebpackPlugin(&#123;</span><br><span class="line">      asset: <span class="string">&#x27;[path].gz[query]&#x27;</span>,</span><br><span class="line">      algorithm: <span class="string">&#x27;gzip&#x27;</span>,</span><br><span class="line">      test: <span class="keyword">new</span> <span class="built_in">RegExp</span>(</span><br><span class="line">        <span class="string">&#x27;\\.(&#x27;</span> +</span><br><span class="line">        config.build.productionGzipExtensions.join(<span class="string">&#x27;|&#x27;</span>) +</span><br><span class="line">        <span class="string">&#x27;)$&#x27;</span></span><br><span class="line">      ),</span><br><span class="line">      threshold: <span class="number">10240</span>,</span><br><span class="line">      minRatio: <span class="number">0.8</span></span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (config.build.bundleAnalyzerReport) &#123;</span><br><span class="line">  <span class="keyword">const</span> BundleAnalyzerPlugin = <span class="built_in">require</span>(<span class="string">&#x27;webpack-bundle-analyzer&#x27;</span>).BundleAnalyzerPlugin</span><br><span class="line">  webpackConfig.plugins.push(<span class="keyword">new</span> BundleAnalyzerPlugin())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="webpack.dev.conf.js" id="webpack-dev-conf-js">webpack.dev.conf.js</h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span></span><br><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;./utils&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&#x27;../config&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">&#x27;webpack-merge&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> baseWebpackConfig = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.base.conf&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;copy-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> FriendlyErrorsPlugin = <span class="built_in">require</span>(<span class="string">&#x27;friendly-errors-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> portfinder = <span class="built_in">require</span>(<span class="string">&#x27;portfinder&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> HOST = process.env.HOST</span><br><span class="line"><span class="keyword">const</span> PORT = process.env.PORT &amp;&amp; <span class="built_in">Number</span>(process.env.PORT)</span><br><span class="line"><span class="comment">// 定义路径：--Cesium--</span></span><br><span class="line"><span class="keyword">const</span> cesiumSource = <span class="string">&#x27;node_modules/cesium/Source&#x27;</span></span><br><span class="line"><span class="keyword">const</span> cesiumWorkers = <span class="string">&#x27;../Build/Cesium/Workers&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> devWebpackConfig = merge(baseWebpackConfig, &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: utils.styleLoaders(&#123; <span class="attr">sourceMap</span>: config.dev.cssSourceMap, <span class="attr">usePostCSS</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// cheap-module-eval-source-map is faster for development</span></span><br><span class="line">  devtool: config.dev.devtool,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// these devServer options should be customized in /config/index.js</span></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    clientLogLevel: <span class="string">&#x27;warning&#x27;</span>,</span><br><span class="line">    historyApiFallback: &#123;</span><br><span class="line">      rewrites: [</span><br><span class="line">        &#123; <span class="attr">from</span>: <span class="regexp">/.*/</span>, to: path.posix.join(config.dev.assetsPublicPath, <span class="string">&#x27;index.html&#x27;</span>) &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;,</span><br><span class="line">    hot: <span class="literal">true</span>,</span><br><span class="line">    contentBase: <span class="literal">false</span>, <span class="comment">// since we use CopyWebpackPlugin.</span></span><br><span class="line">    compress: <span class="literal">true</span>,</span><br><span class="line">    host: HOST || config.dev.host,</span><br><span class="line">    port: PORT || config.dev.port,</span><br><span class="line">    open: config.dev.autoOpenBrowser,</span><br><span class="line">    overlay: config.dev.errorOverlay</span><br><span class="line">      ? &#123; <span class="attr">warnings</span>: <span class="literal">false</span>, <span class="attr">errors</span>: <span class="literal">true</span> &#125;</span><br><span class="line">      : <span class="literal">false</span>,</span><br><span class="line">    publicPath: config.dev.assetsPublicPath,</span><br><span class="line">    proxy: config.dev.proxyTable,</span><br><span class="line">    quiet: <span class="literal">true</span>, <span class="comment">// necessary for FriendlyErrorsPlugin</span></span><br><span class="line">    watchOptions: &#123;</span><br><span class="line">      poll: config.dev.poll,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// 添加如下插件--Cesium--</span></span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([&#123; <span class="attr">from</span>: path.join(cesiumSource, cesiumWorkers), <span class="attr">to</span>: <span class="string">&#x27;Workers&#x27;</span> &#125;]),</span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([&#123; <span class="attr">from</span>: path.join(cesiumSource, <span class="string">&#x27;Assets&#x27;</span>), <span class="attr">to</span>: <span class="string">&#x27;Assets&#x27;</span> &#125;]),</span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([&#123; <span class="attr">from</span>: path.join(cesiumSource, <span class="string">&#x27;Widgets&#x27;</span>), <span class="attr">to</span>: <span class="string">&#x27;Widgets&#x27;</span> &#125;]),</span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([&#123; <span class="attr">from</span>: path.join(cesiumSource, <span class="string">&#x27;ThirdParty/Workers&#x27;</span>), <span class="attr">to</span>: <span class="string">&#x27;ThirdParty/Workers&#x27;</span> &#125;]),</span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">      <span class="comment">// Define relative base path in cesium for loading assets</span></span><br><span class="line">      CESIUM_BASE_URL: <span class="built_in">JSON</span>.stringify(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    &#125;),</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">      <span class="string">&#x27;process.env&#x27;</span>: <span class="built_in">require</span>(<span class="string">&#x27;../config/dev.env&#x27;</span>)</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin(),</span><br><span class="line">    <span class="keyword">new</span> webpack.NamedModulesPlugin(), <span class="comment">// HMR shows correct file names in console on update.</span></span><br><span class="line">    <span class="keyword">new</span> webpack.NoEmitOnErrorsPlugin(),</span><br><span class="line">    <span class="comment">// https://github.com/ampedandwired/html-webpack-plugin</span></span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      filename: <span class="string">&#x27;index.html&#x27;</span>,</span><br><span class="line">      template: <span class="string">&#x27;index.html&#x27;</span>,</span><br><span class="line">      inject: <span class="literal">true</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// copy custom static assets</span></span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">from</span>: path.resolve(__dirname, <span class="string">&#x27;../static&#x27;</span>),</span><br><span class="line">        to: config.dev.assetsSubDirectory,</span><br><span class="line">        ignore: [<span class="string">&#x27;.*&#x27;</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ])</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  portfinder.basePort = process.env.PORT || config.dev.port</span><br><span class="line">  portfinder.getPort(<span class="function">(<span class="params">err, port</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      reject(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// publish the new Port, necessary for e2e tests</span></span><br><span class="line">      process.env.PORT = port</span><br><span class="line">      <span class="comment">// add port to devServer config</span></span><br><span class="line">      devWebpackConfig.devServer.port = port</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Add FriendlyErrorsPlugin</span></span><br><span class="line">      devWebpackConfig.plugins.push(<span class="keyword">new</span> FriendlyErrorsPlugin(&#123;</span><br><span class="line">        compilationSuccessInfo: &#123;</span><br><span class="line">          messages: [<span class="string">`Your application is running here: http://<span class="subst">$&#123;devWebpackConfig.devServer.host&#125;</span>:<span class="subst">$&#123;port&#125;</span>`</span>],</span><br><span class="line">        &#125;,</span><br><span class="line">        onErrors: config.dev.notifyOnErrors</span><br><span class="line">          ? utils.createNotifierCallback()</span><br><span class="line">          : <span class="literal">undefined</span></span><br><span class="line">      &#125;))</span><br><span class="line"></span><br><span class="line">      resolve(devWebpackConfig)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="webpack.base.conf.js" id="webpack-base-conf-js">webpack.base.conf.js</h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;./utils&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&#x27;../config&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> vueLoaderConfig = <span class="built_in">require</span>(<span class="string">&#x27;./vue-loader.conf&#x27;</span>)</span><br><span class="line"><span class="comment">//定义 Cesium 源码路径  --Cesium--</span></span><br><span class="line"><span class="keyword">const</span> cesiumSource = <span class="string">&#x27;../node_modules/cesium/Source&#x27;</span></span><br><span class="line"><span class="keyword">const</span> cesiumWorkers = path.join(cesiumSource, <span class="string">&#x27;Workers&#x27;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolve</span>(<span class="params">dir</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> path.join(__dirname, <span class="string">&#x27;..&#x27;</span>, dir)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> createLintingRule = <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">  test: <span class="regexp">/\.(js|vue)$/</span>,</span><br><span class="line">  loader: <span class="string">&#x27;eslint-loader&#x27;</span>,</span><br><span class="line">  enforce: <span class="string">&#x27;pre&#x27;</span>,</span><br><span class="line">  include: [resolve(<span class="string">&#x27;src&#x27;</span>), resolve(<span class="string">&#x27;test&#x27;</span>)],</span><br><span class="line">  options: &#123;</span><br><span class="line">    formatter: <span class="built_in">require</span>(<span class="string">&#x27;eslint-friendly-formatter&#x27;</span>),</span><br><span class="line">    emitWarning: !config.dev.showEslintErrorsInOverlay</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  context: path.resolve(__dirname, <span class="string">&#x27;../&#x27;</span>),</span><br><span class="line">  entry: &#123;</span><br><span class="line">    app: <span class="string">&#x27;./src/main.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// output: &#123;</span></span><br><span class="line">  <span class="comment">//   path: config.build.assetsRoot,</span></span><br><span class="line">  <span class="comment">//   filename: &#x27;[name].js&#x27;,</span></span><br><span class="line">  <span class="comment">//   publicPath: process.env.NODE_ENV === &#x27;production&#x27;</span></span><br><span class="line">  <span class="comment">//     ? config.build.assetsPublicPath</span></span><br><span class="line">  <span class="comment">//     : config.dev.assetsPublicPath</span></span><br><span class="line">  <span class="comment">// &#125;,</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 让webpack正确处理多行字符串，在output中添加sourcePrefix:&#x27; &#x27;--Cesium--</span></span><br><span class="line">  output: &#123;</span><br><span class="line">    path: config.build.assetsRoot,</span><br><span class="line">    filename: <span class="string">&#x27;[name].js&#x27;</span>,</span><br><span class="line">    publicPath: process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span></span><br><span class="line">      ? config.build.assetsPublicPath</span><br><span class="line">      : config.dev.assetsPublicPath,</span><br><span class="line">    sourcePrefix: <span class="string">&#x27; &#x27;</span> <span class="comment">//让webpack正确处理多行字符串</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// resolve: &#123;</span></span><br><span class="line">  <span class="comment">//   extensions: [&#x27;.js&#x27;, &#x27;.vue&#x27;, &#x27;.json&#x27;],</span></span><br><span class="line">  <span class="comment">//   alias: &#123;</span></span><br><span class="line">  <span class="comment">//     &#x27;vue$&#x27;: &#x27;vue/dist/vue.esm.js&#x27;,</span></span><br><span class="line">  <span class="comment">//     &#x27;@&#x27;: resolve(&#x27;src&#x27;),</span></span><br><span class="line">  <span class="comment">//   &#125;</span></span><br><span class="line">  <span class="comment">// &#125;,</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 需要在resolve中设置cesium别名，这样在引入的时候就可以根据别名找到Cesium的包。--Cesium--</span></span><br><span class="line">  <span class="comment">// （注：也可以不设置别名，导包是直接导入&#x27;cesium/Source/Cesium.js&#x27;就行。其实设置别名的目的就是让“别名”指向/ node_modules / cesium / Source目录）</span></span><br><span class="line">  resolve: &#123;</span><br><span class="line">    extensions: [<span class="string">&#x27;.js&#x27;</span>, <span class="string">&#x27;.vue&#x27;</span>, <span class="string">&#x27;.json&#x27;</span>],</span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="string">&#x27;vue$&#x27;</span>: <span class="string">&#x27;vue/dist/vue.esm.js&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: resolve(<span class="string">&#x27;src&#x27;</span>),</span><br><span class="line">      cesium: path.resolve(__dirname, cesiumSource) <span class="comment">//设置cesium别名</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    <span class="comment">// 解决报错 1.87版本无效，只能暂时退版本--Cesium--</span></span><br><span class="line">    <span class="comment">// npm install @open-wc/webpack-import-meta-loader --save-dev</span></span><br><span class="line">    <span class="comment">//  error  in ./node_modules/cesium/Source/ThirdParty/zip.js</span></span><br><span class="line">    <span class="comment">// Module parse failed: Unexpected token(6400:57)</span></span><br><span class="line">    <span class="comment">// You may need an appropriate loader to handle this file type.</span></span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">&#x27;@open-wc/webpack-import-meta-loader&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// 创建工程师会选择 ESLint 代码校验</span></span><br><span class="line">      <span class="comment">//  Use ESLint to lint your code? Yes</span></span><br><span class="line">      <span class="comment">// ...(config.dev.useEslint ? [createLintingRule()] : []),</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.vue$/</span>,</span><br><span class="line">        loader: <span class="string">&#x27;vue-loader&#x27;</span>,</span><br><span class="line">        options: vueLoaderConfig</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        loader: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">        include: [resolve(<span class="string">&#x27;src&#x27;</span>), resolve(<span class="string">&#x27;test&#x27;</span>), resolve(<span class="string">&#x27;node_modules/webpack-dev-server/client&#x27;</span>)]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpe?g|gif|svg)(\?.*)?$/</span>,</span><br><span class="line">        loader: <span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: <span class="number">10000</span>,</span><br><span class="line">          name: utils.assetsPath(<span class="string">&#x27;img/[name].[hash:7].[ext]&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(mp4|webm|ogg|mp3|wav|flac|aac)(\?.*)?$/</span>,</span><br><span class="line">        loader: <span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: <span class="number">10000</span>,</span><br><span class="line">          name: utils.assetsPath(<span class="string">&#x27;media/[name].[hash:7].[ext]&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(woff2?|eot|ttf|otf)(\?.*)?$/</span>,</span><br><span class="line">        loader: <span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: <span class="number">10000</span>,</span><br><span class="line">          name: utils.assetsPath(<span class="string">&#x27;fonts/[name].[hash:7].[ext]&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    unknownContextCritical: <span class="literal">false</span>,<span class="comment">//阻止依赖警告--Cesium--</span></span><br><span class="line">  &#125;,</span><br><span class="line">  node: &#123;</span><br><span class="line">    <span class="comment">// prevent webpack from injecting useless setImmediate polyfill because Vue</span></span><br><span class="line">    <span class="comment">// source contains it (although only uses it if it&#x27;s native).</span></span><br><span class="line">    setImmediate: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// prevent webpack from injecting mocks to Node native modules</span></span><br><span class="line">    <span class="comment">// that does not make sense for the client</span></span><br><span class="line">    dgram: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">    fs: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">    net: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">    tls: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">    child_process: <span class="string">&#x27;empty&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="%E5%88%9B%E5%BB%BA%E5%9C%B0%E5%9B%BE%E7%BB%84%E4%BB%B6-src%5Cview%5Cearth.vue" id="创建地图组件-src-view-earth-vue">创建地图组件 src\view\earth.vue</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;cesiumContainer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;credit&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="comment">// 这里不能使用 import Cesium from &#x27;cesium/Cesium&#x27; 导入模块，因为Cesium 1.63 版本以后使用的是ES6。应该使用一下方式</span></span></span><br><span class="line"><span class="javascript"><span class="comment">// import &#123; Viewer &#125; from &quot;cesium/Cesium&quot;;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> * <span class="keyword">as</span> Cesium <span class="keyword">from</span> <span class="string">&quot;cesium/Cesium&quot;</span>; <span class="comment">//正确</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> <span class="string">&quot;cesium/Widgets/widgets.css&quot;</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&quot;earth&quot;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;&#125;;</span></span><br><span class="line">  &#125;,</span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// let viewer = new Viewer(&quot;cesiumContainer&quot;);</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 1. Geocoder : 查找位置工具，查找到之后会将镜头对准找到的地址，默认使用bing地图</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 2. Home Button :视角返回初始位置.</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 3. Scene Mode Picker : 选择视角的模式，有三种：3D，2D，哥伦布视图(CV)</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 4. Base Layer Picker : 图层选择器，选择要显示的地图服务和地形服务.</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 5. Navigation Help Button :导航帮助按钮，显示默认的地图控制帮助.</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 6. Animation : 动画器件，控制视图动画的播放速度.</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 7. Timeline :时间线,指示当前时间，并允许用户跳到特定的时间.</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 8. Credits Display :版权显示，显示数据归属，必选</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 9. Fullscreen Button :全屏按钮.</span></span></span><br><span class="line"><span class="javascript">    Cesium.Ion.defaultAccessToken =<span class="string">&quot;自己的token&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> viewer = <span class="keyword">new</span> Cesium.Viewer(<span class="string">&quot;cesiumContainer&quot;</span>, &#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// geocoder: false,</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// homeButton: false,</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// sceneModePicker: false,</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// baseLayerPicker: false,</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// navigationHelpButton: false,</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// animation: false,</span></span></span><br><span class="line"><span class="javascript">      creditContainer: <span class="string">&quot;credit&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// timeline: false,</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// fullscreenButton: false,</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// vrButton: false,</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// skyBox : new Cesium.SkyBox(&#123;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//     sources : &#123;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//     positiveX : &#x27;stars/TychoSkymapII.t3_08192x04096_80_px.jpg&#x27;,</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//     negativeX : &#x27;stars/TychoSkymapII.t3_08192x04096_80_mx.jpg&#x27;,</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//     positiveY : &#x27;stars/TychoSkymapII.t3_08192x04096_80_py.jpg&#x27;,</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//     negativeY : &#x27;stars/TychoSkymapII.t3_08192x04096_80_my.jpg&#x27;,</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//     positiveZ : &#x27;stars/TychoSkymapII.t3_08192x04096_80_pz.jpg&#x27;,</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//     negativeZ : &#x27;stars/TychoSkymapII.t3_08192x04096_80_mz.jpg&#x27;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//     &#125;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// &#125;)</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="comment">// 显示帧速(FPS)</span></span></span><br><span class="line"><span class="javascript">    viewer.scene.debugShowFramesPerSecond = <span class="literal">true</span>;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 绘制形状</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 方式一：</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> redBox = viewer.entities.add(&#123;</span></span><br><span class="line"><span class="javascript">      name: <span class="string">&quot;Red box with black outline&quot;</span>,</span></span><br><span class="line">      position: Cesium.Cartesian3.fromDegrees(-107.0, 40.0, 300000.0),</span><br><span class="line">      box: &#123;</span><br><span class="line"><span class="javascript">        dimensions: <span class="keyword">new</span> Cesium.Cartesian3(<span class="number">400000.0</span>, <span class="number">300000.0</span>, <span class="number">500000.0</span>),</span></span><br><span class="line">        material: Cesium.Color.BLUE.withAlpha(0.5),</span><br><span class="line"><span class="javascript">        outline: <span class="literal">true</span>,</span></span><br><span class="line">        outlineColor: Cesium.Color.BLACK,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    viewer.zoomTo(viewer.entities);</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="comment">// 方式二：</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> czml = [</span></span><br><span class="line">      &#123;</span><br><span class="line"><span class="javascript">        id: <span class="string">&quot;document&quot;</span>,</span></span><br><span class="line"><span class="javascript">        name: <span class="string">&quot;box&quot;</span>,</span></span><br><span class="line"><span class="javascript">        version: <span class="string">&quot;1.0&quot;</span>,</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line"><span class="javascript">        id: <span class="string">&quot;shape2&quot;</span>,</span></span><br><span class="line"><span class="javascript">        name: <span class="string">&quot;Red box with black outline&quot;</span>,</span></span><br><span class="line">        position: &#123;</span><br><span class="line">          cartographicDegrees: [-107.0, 50.0, 300000.0],</span><br><span class="line">        &#125;,</span><br><span class="line">        box: &#123;</span><br><span class="line">          dimensions: &#123;</span><br><span class="line">            cartesian: [400000.0, 300000.0, 500000.0],</span><br><span class="line">          &#125;,</span><br><span class="line">          material: &#123;</span><br><span class="line">            solidColor: &#123;</span><br><span class="line">              color: &#123;</span><br><span class="line">                rgba: [255, 0, 0, 128],</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line"><span class="javascript">          outline: <span class="literal">true</span>,</span></span><br><span class="line">          outlineColor: &#123;</span><br><span class="line">            rgba: [0, 0, 0, 255],</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="comment">// 重复创建Viewer会添加多个窗口</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// var viewer = new Cesium.Viewer(&quot;cesiumContainer&quot;);</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> dataSourcePromise = Cesium.CzmlDataSource.load(czml);</span></span><br><span class="line">    viewer.dataSources.add(dataSourcePromise);</span><br><span class="line">    viewer.zoomTo(dataSourcePromise);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-class">.container</span> &#123;</span></span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-id">#cesiumContainer</span> &#123;</span></span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="comment">/* 不占据空间，无法点击，右上角按钮组，左下角动画控件 ，时间线，logo信息*/</span></span></span><br><span class="line">/* .cesium-viewer-toolbar,</span><br><span class="line"><span class="css"><span class="selector-class">.cesium-viewer-animationContainer</span>,</span></span><br><span class="line"><span class="css"><span class="selector-class">.cesium-viewer-timelineContainer</span>,</span></span><br><span class="line"><span class="css"><span class="selector-class">.cesium-viewer-bottom</span> &#123;</span></span><br><span class="line">  display: none;</span><br><span class="line">&#125; */</span><br><span class="line"><span class="css"><span class="comment">/* 全屏按钮 */</span></span></span><br><span class="line">/* .cesium-viewer-fullscreenContainer  &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: -999em;</span><br><span class="line">&#125; */</span><br><span class="line"></span><br><span class="line">/* 注：全屏按钮不能通过display:none的方式来达到隐藏的目的，这是因为生成的按钮控件的行内样式设置了display属性，会覆盖引入的css属性</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;cesium-viewer-fullscreenContainer&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display: block;&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span> */</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="%E6%B7%BB%E5%8A%A0%E8%B7%AF%E7%94%B1-src%5Crouter%5Cindex.js" id="添加路由-src-router-index-js">添加路由  src\router\index.js</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import Vue from &#39;vue&#39;</span><br><span class="line">import Router from &#39;vue-router&#39;</span><br><span class="line">import HelloWorld from &#39;@&#x2F;components&#x2F;HelloWorld&#39;</span><br><span class="line">import earth from &#39;@&#x2F;view&#x2F;earth&#39;</span><br><span class="line"></span><br><span class="line">Vue.use(Router)</span><br><span class="line"></span><br><span class="line">export default new Router(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: &#39;&#x2F;&#39;,</span><br><span class="line">      name: &#39;HelloWorld&#39;,</span><br><span class="line">      component: HelloWorld</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: &#39;&#x2F;earth&#39;,</span><br><span class="line">      name: &#39;earth&#39;,</span><br><span class="line">      component: earth</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="%E8%BF%90%E8%A1%8C%E6%8A%A5%E9%94%991" id="运行报错1">运行报错1</h3>
<p>error in ./node_modules/cesium/Source/ThirdParty/zip.js</p>
<h4 id="%E8%A7%A3%E5%86%B3" id="解决">解决</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @open-wc&#x2F;webpack-import-meta-loader -S</span><br></pre></td></tr></table></figure>
<h4 id="vue.config.js-%E6%88%96-webpack.base.conf.js%E9%85%8D%E7%BD%AE" id="vue-config-js-或-webpack-base-conf-js配置">vue.config.js 或 webpack.base.conf.js配置</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    configureWebpack: &#123;</span><br><span class="line">        <span class="built_in">module</span>: &#123;</span><br><span class="line">            rules: [</span><br><span class="line">                &#123;</span><br><span class="line">                    test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">                    use: &#123;</span><br><span class="line">                        loader: <span class="string">&#x27;@open-wc/webpack-import-meta-loader&#x27;</span>,</span><br><span class="line">                    &#125;,</span><br><span class="line">                &#125;,</span><br><span class="line">            ],</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="%E8%BF%90%E8%A1%8C%E6%8A%A5%E9%94%992" id="运行报错2">运行报错2</h3>
<p>error  in (webpack)/hot/dev-server.js<br />
Module build failed: TypeError: Cannot read property 'length' of undefined<br />
at Object.module.exports (F:\demo\cesiumtest-master\node_modules@open-wc\webpack-import-meta-loader\webpack-import-meta-loader.js:20:63)</p>
<h4 id="%E8%A7%A3%E5%86%B3-1" id="解决-v2">解决</h4>
<p>点击报错跳转到对应文件行，将其注释即可</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">source</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> relativePath = <span class="built_in">this</span>.context.substring(</span><br><span class="line">    <span class="comment">// this.context.indexOf(this.rootContext) + this.rootContext.length + 1,</span></span><br><span class="line">    <span class="built_in">this</span>.resource.lastIndexOf(path.sep) + <span class="number">1</span>,</span><br><span class="line">  );</span><br></pre></td></tr></table></figure>
<h3 id="%E8%BF%90%E8%A1%8C" id="运行">运行</h3>
<p>npm run dev</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8081/#/earth">http://localhost:8081/#/earth</a></p>
<p><img src="https://gitee.com/mychimei/picture/raw/master/work/image-20220111165928042.png" alt="" /></p>
<p>npm run build  打包成功</p>
<h3 id="%E9%83%A8%E7%BD%B2dist" id="部署dist">部署dist</h3>
<p><a target="_blank" rel="noopener" href="http://xx.xx.xx.11:8084/#/earth">http://xx.xx.xx.11:8084/#/earth</a> 成功</p>
<h2 id="%E5%8A%9F%E8%83%BD%E5%BC%80%E5%8F%91" id="功能开发">功能开发</h2>
<h3 id="%E6%8E%A7%E4%BB%B6%E6%98%BE%E7%A4%BA%E6%8E%A7%E5%88%B6" id="控件显示控制">控件显示控制</h3>
<ol>
<li>Geocoder : 查找位置工具，查找到之后会将镜头对准找到的地址，默认使用bing地图</li>
<li>Home Button :视角返回初始位置.</li>
<li>Scene Mode Picker : 选择视角的模式，有三种：3D，2D，哥伦布视图(CV)</li>
<li>Base Layer Picker : 图层选择器，选择要显示的地图服务和地形服务.</li>
<li>Navigation Help Button :导航帮助按钮，显示默认的地图控制帮助.</li>
<li>Animation : 动画器件，控制视图动画的播放速度.</li>
<li>Timeline :时间线,指示当前时间，并允许用户跳到特定的时间.</li>
<li>Credits Display :版权显示，显示数据归属，必选</li>
<li>Fullscreen Button :全屏按钮.</li>
</ol>
<h4 id="js%E6%96%B9%E5%BC%8F" id="js方式">js方式</h4>
<p><a target="_blank" rel="noopener" href="https://cesium.com/learn/cesiumjs/ref-doc/Viewer.html?classFilter=viewer">官方文档</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> viewer = <span class="keyword">new</span> Viewer(<span class="string">&quot;cesiumContainer&quot;</span>, &#123;</span><br><span class="line">  geocoder: <span class="literal">false</span>,</span><br><span class="line">  homeButton: <span class="literal">false</span>,</span><br><span class="line">  sceneModePicker: <span class="literal">false</span>,</span><br><span class="line">  baseLayerPicker: <span class="literal">false</span>,</span><br><span class="line">  navigationHelpButton: <span class="literal">false</span>,</span><br><span class="line">  animation: <span class="literal">false</span>,</span><br><span class="line">  <span class="comment">// creditContainer: &quot;credit&quot;,</span></span><br><span class="line">  timeline: <span class="literal">false</span>,</span><br><span class="line">  fullscreenButton: <span class="literal">false</span>,</span><br><span class="line">  vrButton: <span class="literal">false</span>,</span><br><span class="line">  <span class="comment">// skyBox : new Cesium.SkyBox(&#123;</span></span><br><span class="line">  <span class="comment">//     sources : &#123;</span></span><br><span class="line">  <span class="comment">//     positiveX : &#x27;stars/TychoSkymapII.t3_08192x04096_80_px.jpg&#x27;,</span></span><br><span class="line">  <span class="comment">//     negativeX : &#x27;stars/TychoSkymapII.t3_08192x04096_80_mx.jpg&#x27;,</span></span><br><span class="line">  <span class="comment">//     positiveY : &#x27;stars/TychoSkymapII.t3_08192x04096_80_py.jpg&#x27;,</span></span><br><span class="line">  <span class="comment">//     negativeY : &#x27;stars/TychoSkymapII.t3_08192x04096_80_my.jpg&#x27;,</span></span><br><span class="line">  <span class="comment">//     positiveZ : &#x27;stars/TychoSkymapII.t3_08192x04096_80_pz.jpg&#x27;,</span></span><br><span class="line">  <span class="comment">//     negativeZ : &#x27;stars/TychoSkymapII.t3_08192x04096_80_mz.jpg&#x27;</span></span><br><span class="line">  <span class="comment">//     &#125;</span></span><br><span class="line">  <span class="comment">// &#125;)</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 显示帧速(FPS)</span></span><br><span class="line">viewer.scene.debugShowFramesPerSecond = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<h4 id="css%E6%96%B9%E5%BC%8F" id="css方式">css方式</h4>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 不占据空间，无法点击 */</span></span><br><span class="line"><span class="selector-class">.cesium-viewer-toolbar</span>,             <span class="comment">/* 右上角按钮组 */</span></span><br><span class="line"><span class="selector-class">.cesium-viewer-animationContainer</span>,  <span class="comment">/* 左下角动画控件 */</span></span><br><span class="line"><span class="selector-class">.cesium-viewer-timelineContainer</span>,   <span class="comment">/* 时间线 */</span></span><br><span class="line"><span class="selector-class">.cesium-viewer-bottom</span>               <span class="comment">/* logo信息 */</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.cesium-viewer-fullscreenContainer</span>  <span class="comment">/* 全屏按钮 */</span></span><br><span class="line">&#123; <span class="attribute">position</span>: absolute; <span class="attribute">top</span>: -<span class="number">999em</span>;  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="%E5%88%9B%E5%BB%BA%E5%BD%A2%E7%8A%B6" id="创建形状">创建形状</h3>
<p><img src="https://gitee.com/mychimei/picture/raw/master/work/image-20220112173200428.png" alt="image-20220112173200428" /></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 绘制形状  正方体</span></span><br><span class="line">    <span class="comment">// 方式一：Entity</span></span><br><span class="line"><span class="comment">//其他形状：http://cesium.xin/cesium/Documentation/Entity.html?classFilter=entity</span></span><br><span class="line">    <span class="keyword">var</span> redBox = viewer.entities.add(&#123;</span><br><span class="line">      name: <span class="string">&quot;Red box with black outline&quot;</span>,</span><br><span class="line">      position: Cesium.Cartesian3.fromDegrees(-<span class="number">107.0</span>, <span class="number">40.0</span>, <span class="number">300000.0</span>),</span><br><span class="line">      box: &#123;</span><br><span class="line">        dimensions: <span class="keyword">new</span> Cesium.Cartesian3(<span class="number">400000.0</span>, <span class="number">300000.0</span>, <span class="number">500000.0</span>),</span><br><span class="line">        material: Cesium.Color.BLUE.withAlpha(<span class="number">0.5</span>),</span><br><span class="line">        outline: <span class="literal">true</span>,</span><br><span class="line">        outlineColor: Cesium.Color.BLACK,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    viewer.zoomTo(viewer.entities);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 方式二：CZML(可创建几何形状也可创建动画)</span></span><br><span class="line">    <span class="keyword">var</span> czml = [</span><br><span class="line">      &#123;</span><br><span class="line">        id: <span class="string">&quot;document&quot;</span>,</span><br><span class="line">        name: <span class="string">&quot;box&quot;</span>,</span><br><span class="line">        version: <span class="string">&quot;1.0&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        id: <span class="string">&quot;shape2&quot;</span>,</span><br><span class="line">        name: <span class="string">&quot;Red box with black outline&quot;</span>,</span><br><span class="line">        position: &#123;</span><br><span class="line">          cartographicDegrees: [-<span class="number">107.0</span>, <span class="number">50.0</span>, <span class="number">300000.0</span>],</span><br><span class="line">        &#125;,</span><br><span class="line">        box: &#123;</span><br><span class="line">          dimensions: &#123;</span><br><span class="line">            cartesian: [<span class="number">400000.0</span>, <span class="number">300000.0</span>, <span class="number">500000.0</span>],</span><br><span class="line">          &#125;,</span><br><span class="line">          material: &#123;</span><br><span class="line">            solidColor: &#123;</span><br><span class="line">              color: &#123;</span><br><span class="line">                rgba: [<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">128</span>],</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          outline: <span class="literal">true</span>,</span><br><span class="line">          outlineColor: &#123;</span><br><span class="line">            rgba: [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>],</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ];</span><br><span class="line">    <span class="comment">// 重复创建Viewer会添加多个窗口</span></span><br><span class="line">    <span class="comment">// var viewer = new Cesium.Viewer(&quot;cesiumContainer&quot;);</span></span><br><span class="line">    <span class="keyword">var</span> dataSourcePromise = Cesium.CzmlDataSource.load(czml);</span><br><span class="line">    viewer.dataSources.add(dataSourcePromise);</span><br><span class="line">    viewer.zoomTo(dataSourcePromise);</span><br></pre></td></tr></table></figure>
<h3 id="%E6%B7%BB%E5%8A%A0%E4%B8%8D%E5%90%8C%E7%B1%BB%E5%9E%8B%E6%95%B0%E6%8D%AE" id="添加不同类型数据">添加不同类型数据</h3>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/98d4c0b2c618">概览</a></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://www.opengeospatial.org/standards/wms">Web Map Service</a> (WMS) - 一种OGC标准，从分布式地理数据库中通过地图的地理范围来请求切片。   Cesium使用 <a target="_blank" rel="noopener" href="https://cesiumjs.org/Cesium/Build/Documentation/WebMapServiceImageryProvider.html">WebMapServiceImageryProvider</a>去支持这种。</p>
<p><a target="_blank" rel="noopener" href="https://cesiumjs.org/Cesium/Build/Documentation/TileMapServiceImageryProvider.html">Tile Map Service</a> (TMS) - 一种访问地图切片的REST接口。  可以用<a target="_blank" rel="noopener" href="http://www.cesiumlab.com">CesiumLab</a>， <a target="_blank" rel="noopener" href="http://www.maptiler.org/">MapTiler</a>  或者 <a target="_blank" rel="noopener" href="http://www.klokan.cz/projects/gdal2tiles/">GDAL2Tiles</a> . Cesium中使用<a target="_blank" rel="noopener" href="https://cesiumjs.org/Cesium/Build/Documentation/TileMapServiceImageryProvider.html">TileMapServiceImageryProvider</a>.</p>
<p><a target="_blank" rel="noopener" href="http://www.opengeospatial.org/standards/wmts">OpenGIS Web Map Tile Service</a> (WMTS) - 一种OGC标准，主要是为预渲染的地图切片形式. Cesium中使用 <a target="_blank" rel="noopener" href="https://cesiumjs.org/Cesium/Build/Documentation/WebMapTileServiceImageryProvider.html">WebMapTileServiceImageryProvider</a>.</p>
<p><a target="_blank" rel="noopener" href="http://wiki.openstreetmap.org/wiki/Main_Page">OpenStreetMap</a> - 访问 OpenStreetMap 切片 或者 任意 <a target="_blank" rel="noopener" href="http://wiki.openstreetmap.org/wiki/Slippy_map_tilenames">Slippy map tiles</a>.有很多方法 <a target="_blank" rel="noopener" href="http://switch2osm.org/serving-tiles/">发布这种服务 </a>.Cesium中使用<a target="_blank" rel="noopener" href="https://cesiumjs.org/Cesium/Build/Documentation/createOpenStreetMapImageryProvider.html">createOpenStreetMapImageryProvider</a>.</p>
<p><a target="_blank" rel="noopener" href="http://www.bing.com/maps/">Bing 地图</a> - 使用<a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/library/ff701713.aspx">Bing 地图 REST 服务</a>访问切片. 在这里 <a target="_blank" rel="noopener" href="https://www.bingmapsportal.com/%E5%88%9B%E5%BB%BABing%E5%9C%B0%E5%9B%BE%E7%9A%84key">https://www.bingmapsportal.com/创建Bing地图的key</a>. Cesium中使用 <a target="_blank" rel="noopener" href="https://cesiumjs.org/Cesium/Build/Documentation/BingMapsImageryProvider.html">BingMapsImageryProvider</a>.</p>
<p>Esri ArcGIS MapServer - 使用 <a target="_blank" rel="noopener" href="http://resources.esri.com/help/9.3/arcgisserver/apis/rest/">ArcGIS Server REST API</a> 访问存储在ArcGIS Server上的切片。Cesium中使用<a target="_blank" rel="noopener" href="https://cesiumjs.org/Cesium/Build/Documentation/ArcGisMapServerImageryProvider.html">ArcGisMapServerImageryProvider</a>.</p>
<p><a target="_blank" rel="noopener" href="http://www.google.com/enterprise/mapsearth/products/earthenterprise.html">Google Earth Enterprise</a> - 访问Google Earth 企业版服务器发布的影像切片。Cesium中 <a target="_blank" rel="noopener" href="https://cesiumjs.org/Cesium/Build/Documentation/GoogleEarthImageryProvider.html">GoogleEarthImageryProvider</a>.</p>
<p><a target="_blank" rel="noopener" href="https://www.mapbox.com/">Mapbox</a> - 使用 <a target="_blank" rel="noopener" href="https://www.mapbox.com/developers/api/">Mapbox API</a>访问切片. 在这里新建用户，并且创建一个 <a target="_blank" rel="noopener" href="https://www.mapbox.com/account/apps/">access token</a>. Cesium中使用 <a target="_blank" rel="noopener" href="https://cesiumjs.org/Cesium/Build/Documentation/MapboxImageryProvider.html">MapboxImageryProvider</a>.</p>
<p>普通图片文件 - 使用一张普通图片创建影像图层. Cesium中使用 <a target="_blank" rel="noopener" href="https://cesiumjs.org/Cesium/Build/Documentation/SingleTileImageryProvider.html">SingleTileImageryProvider</a>.</p>
<p>自定义切片机制 - 使用<a target="_blank" rel="noopener" href="https://cesiumjs.org/Cesium/Build/Documentation/UrlTemplateImageryProvider.html">UrlTemplateImageryProvider</a>, 可以通过 URL 模板连接各种影像资源 。比如TMS服务的URL模板是： <code>//cesiumjs.org/tilesets/imagery/naturalearthii/&#123;z&#125;/&#123;x&#125;/&#123;reverseY&#125;.jpg</code>.</p>
<p><a target="_blank" rel="noopener" href="https://cesiumjs.org/Cesium/Build/Documentation/TileCoordinatesImageryProvider.html">切片坐标</a> -  用来显示全球是如何被切片的，支持多种切片规则，画出每个切片的地理边界，并且用文字标注每个切片的level，x，y坐标。</p>
<p><a target="_blank" rel="noopener" href="https://www.cesiumlab.com">百度地图</a> -  用来加载百度默认地图或者自定义样式地图，请联系我们。</p>
</blockquote>
<h4 id="%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3" id="跨域问题解决">跨域问题解决</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line"></span><br><span class="line">  dev: &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Paths</span></span><br><span class="line">    assetsSubDirectory: <span class="string">&#x27;static&#x27;</span>,</span><br><span class="line">    assetsPublicPath: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="comment">//接口地址原本是/satellite/z=&#123;z&#125;&amp;x=&#123;x&#125;&amp;y=&#123;y&#125; 但是为了匹配代理地址 调用时需在前面加一个 /satellite,  因此接口地址需要写成这样的即可生效 /satellite/satellite/z=&#123;z&#125;&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;</span></span><br><span class="line">    proxyTable: &#123;</span><br><span class="line">      <span class="string">&#x27;/ArcGIS&#x27;</span>: &#123;<span class="comment">//代理的目的：只要是/satellite开头的路径都往localhost:3000进行转发  </span></span><br><span class="line">        target: <span class="string">&#x27;https://sampleserver1.arcgisonline.com&#x27;</span>, <span class="comment">//后端接口地址 设置代理服务器地址 转发地址</span></span><br><span class="line">        ws: <span class="literal">true</span>,<span class="comment">//WebSocket协议</span></span><br><span class="line">        changeOrigin: <span class="literal">true</span>, <span class="comment">//表示是否改变原域名；这个一定要选择为true; 是否允许跨域[ 如果接口跨域 则要配置这个参数]</span></span><br><span class="line">        secure: <span class="literal">false</span>, <span class="comment">// 如果是https接口 需要配置这个参数</span></span><br><span class="line">        pathRewrite: &#123;<span class="comment">// 把程序中的地址转换成“真实地址”+‘/satellite’后面的部分如‘/satellite/satellite/z=&#123;z&#125;&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;&#x27;，被转换成&#x27;http://localhost:3000/satellite/z=&#123;z&#125;&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;&#x27;</span></span><br><span class="line">          <span class="string">&#x27;^/ArcGIS&#x27;</span>: <span class="string">&#x27;&#x27;</span><span class="comment">//修改pathRewrite地址 将前缀&#x27;^satellite&#x27;转为&#x27;/satellite&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<h4 id="%E5%8A%A0%E8%BD%BD%E4%B8%8D%E5%90%8C%E7%B1%BB%E5%9E%8B%E6%95%B0%E6%8D%AE" id="加载不同类型数据">加载不同类型数据</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加载不同类型数据 从上到下依次覆盖==============================================</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">// 数据类型1： -----------------------------------Web Map Service (WMS) -------------------------------------</span></span><br><span class="line">   <span class="comment">// var provider = new Cesium.WebMapServiceImageryProvider(&#123;</span></span><br><span class="line">   <span class="comment">//   // url: &quot;https://sampleserver1.arcgisonline.com/ArcGIS/services/Specialty/ESRI_StatesCitiesRivers_USA/MapServer/WMSServer&quot;,</span></span><br><span class="line">   <span class="comment">//   url: &quot;ArcGIS/ArcGIS/services/Specialty/ESRI_StatesCitiesRivers_USA/MapServer/WMSServer&quot;,</span></span><br><span class="line">   <span class="comment">//   layers: &quot;0&quot;,</span></span><br><span class="line">   <span class="comment">//   // proxy: new Cesium.DefaultProxy(&quot;/proxy/&quot;),</span></span><br><span class="line">   <span class="comment">// &#125;);</span></span><br><span class="line">   <span class="comment">// viewer.imageryLayers.addImageryProvider(provider);</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">// 数据类型2：-----------------------------------OpenGIS Web Map Tile Service (WMTS)-----------------------------------</span></span><br><span class="line">   <span class="comment">// var shadedRelief2 = new Cesium.WebMapTileServiceImageryProvider(&#123;</span></span><br><span class="line">   <span class="comment">//   url: &quot;http://basemap.nationalmap.gov/arcgis/rest/services/USGSShadedReliefOnly/MapServer/WMTS/tile/1.0.0/USGSShadedReliefOnly/&#123;Style&#125;/&#123;TileMatrixSet&#125;/&#123;TileMatrix&#125;/&#123;TileRow&#125;/&#123;TileCol&#125;.jpg&quot;,</span></span><br><span class="line">   <span class="comment">//   layer: &quot;USGSShadedReliefOnly&quot;,</span></span><br><span class="line">   <span class="comment">//   style: &quot;default&quot;,</span></span><br><span class="line">   <span class="comment">//   format: &quot;image/jpeg&quot;,</span></span><br><span class="line">   <span class="comment">//   tileMatrixSetID: &quot;default028mm&quot;,</span></span><br><span class="line">   <span class="comment">//   maximumLevel: 19,</span></span><br><span class="line">   <span class="comment">//   credit: new Cesium.Credit(&quot;U. S. Geological Survey&quot;),</span></span><br><span class="line">   <span class="comment">// &#125;);</span></span><br><span class="line">   <span class="comment">// viewer.imageryLayers.addImageryProvider(shadedRelief2);</span></span><br><span class="line">   <span class="comment">// url:&quot;http://61.175.211.102/arcgis/rest/services/wzmap/map/MapServer/WMTS?service=WMTS&amp;request=GetTile&amp;layer=wzmap&amp;style=default&amp;tilematriX=&#123;TileMatrix&#125;&amp;tilerow=&#123;TileRow&#125;&amp;tilecoL=&#123;TileCol&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">// 数据类型3： -----------------------------------Tile Map Service (TMS)-----------------------------------</span></span><br><span class="line">   <span class="comment">// var tms = new Cesium.TileMapServiceImageryProvider(&#123;</span></span><br><span class="line">   <span class="comment">//   url: &quot;../images/cesium_maptiler/Cesium_Logo_Color&quot;,</span></span><br><span class="line">   <span class="comment">//   fileExtension: &quot;png&quot;,</span></span><br><span class="line">   <span class="comment">//   maximumLevel: 4,</span></span><br><span class="line">   <span class="comment">//   rectangle: new Cesium.Rectangle(</span></span><br><span class="line">   <span class="comment">//     Cesium.Math.toRadians(-120.0),</span></span><br><span class="line">   <span class="comment">//     Cesium.Math.toRadians(20.0),</span></span><br><span class="line">   <span class="comment">//     Cesium.Math.toRadians(-60.0),</span></span><br><span class="line">   <span class="comment">//     Cesium.Math.toRadians(40.0)</span></span><br><span class="line">   <span class="comment">//   ),</span></span><br><span class="line">   <span class="comment">// &#125;);</span></span><br><span class="line">   <span class="comment">// viewer.imageryLayers.addImageryProvider(tms);</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">// 数据类型4： -----------------------------------ArcGis-----------------------------------</span></span><br><span class="line">   <span class="comment">// var esri = new Cesium.ArcGisMapServerImageryProvider(&#123;</span></span><br><span class="line">   <span class="comment">//   url: &quot;https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer&quot;,</span></span><br><span class="line">   <span class="comment">// &#125;);</span></span><br><span class="line">   <span class="comment">// viewer.imageryLayers.addImageryProvider(esri);</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">// 数据类型5：-----------------------------------Mapbox-----------------------------------</span></span><br><span class="line">   <span class="keyword">var</span> mapbox = <span class="keyword">new</span> Cesium.MapboxImageryProvider(&#123;</span><br><span class="line">     mapId: <span class="string">&quot;mapbox.mapbox-streets-v8&quot;</span>,</span><br><span class="line">     accessToken:</span><br><span class="line">       <span class="string">&quot;pk.eyJ1IjoibGltbiIsImEiOiJja2t1bG1na2IxZGU0MnZvNmlzY3FhZXM4In0.oQx4VguycOR4TK80Pyusmw&quot;</span>,</span><br><span class="line">   &#125;);</span><br><span class="line">   viewer.imageryLayers.addImageryProvider(mapbox);</span><br></pre></td></tr></table></figure>
<h1 id="leaflet"><a target="_blank" rel="noopener" href="https://leafletjs.com/">Leaflet </a></h1>
<blockquote>
<h3 id="an-open-source-javascript-library-for-mobile-friendly-interactive-maps" id="an-open-source-JavaScript-library-for-mobile-friendly-interactive-maps">an open-source JavaScript library for mobile-friendly interactive maps</h3>
</blockquote>
<p>Leaflet 是一个为建设移动设备友好的互动地图，而开发的现代的、开源的 JavaScript 库。虽然代码仅有 38 KB，但它具有开发人员开发在线地图的大部分功能。Leaflet设计坚持简便、高性能和可用性好的思想，在所有主要桌面和移动平台能高效运作，在现代浏览器上会利用HTML5和CSS3的优势，同时也支持旧的浏览器访问。支持插件扩展，有一个友好、易于使用的API文档和一个简单的、可读的源代码。详细见官方网站https://leafletjs.com/</p>
<h2 id="3.3.1%E5%9C%B0%E5%9B%BE" id="3-3-1地图">3.3.1地图</h2>
<h3 id="3.3.1.1%E7%9F%A2%E9%87%8F%E7%94%B5%E5%AD%90%E5%9C%B0%E5%9B%BE" id="3-3-1-1矢量电子地图">3.3.1.1矢量电子地图</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>添加电子地图<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--添加leaflet样式--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--添加leafletjs包--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--添加坐标库--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4-compressed.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html &#123;</span><br><span class="line">      height: 100%</span><br><span class="line">    &#125;</span><br><span class="line">    body &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.map</span> &#123;</span></span><br><span class="line">      height: 100%</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mapid&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> res = [</span></span><br><span class="line"><span class="javascript">      <span class="number">0.00549933137239034</span>, <span class="comment">// Level 0</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00274966568619517</span>, <span class="comment">// Level 1</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00137483284309758</span>, <span class="comment">// Level 2</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000687416421548792</span>, <span class="comment">// Level 3</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000343708210774396</span>, <span class="comment">// Level 4</span></span></span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599E-05,</span><br><span class="line">      4.29635263467995E-05,</span><br><span class="line">      2.14817631733998E-05,</span><br><span class="line">      1.07408815866999E-05,</span><br><span class="line">      5.37044079334994E-06,</span><br><span class="line">      2.68522039667497E-06,</span><br><span class="line">      1.34261019833748E-06</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> crs = <span class="keyword">new</span> L.Proj.CRS(<span class="string">&#x27;EPSG:4490&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&#x27;+proj=longlat +ellps=GRS80 +no_defs&#x27;</span>,</span></span><br><span class="line">      &#123;</span><br><span class="line">        resolutions: res,</span><br><span class="line"><span class="javascript">        origin: [<span class="number">118.122911693886</span>, <span class="number">31.2869311022836</span>],    <span class="comment">//切图原点</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = L.map(<span class="string">&#x27;mapid&#x27;</span>, &#123;</span></span><br><span class="line">      crs: crs</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> url = <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> attrib = <span class="string">&quot;&amp;copy 杭州市规划资源局&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> basemap = <span class="keyword">new</span> L.TileLayer(url + <span class="string">&quot;/tile/&#123;z&#125;/&#123;y&#125;/&#123;x&#125;&quot;</span>, &#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      attribution: attrib</span><br><span class="line">    &#125;);</span><br><span class="line">    map.addLayer(basemap);</span><br><span class="line"><span class="javascript">    map.setView([<span class="number">30.25168</span>, <span class="number">120.16179</span>], <span class="number">4</span>); <span class="comment">//设置比例尺和中心点级别             	</span></span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3.3.1.2%E5%BD%B1%E5%83%8F%E7%94%B5%E5%AD%90%E5%9C%B0%E5%9B%BE" id="3-3-1-2影像电子地图">3.3.1.2影像电子地图</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>添加影像地图<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4-compressed.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html &#123;</span><br><span class="line">      height: 100%</span><br><span class="line">    &#125;</span><br><span class="line">    body &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.map</span> &#123;</span></span><br><span class="line">      height: 100%</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mapid&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> res = [</span></span><br><span class="line"><span class="javascript">      <span class="number">0.00549933137239034</span>, <span class="comment">// Level 0</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00274966568619517</span>, <span class="comment">// Level 1</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00137483284309758</span>, <span class="comment">// Level 2</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000687416421548792</span>, <span class="comment">// Level 3</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000343708210774396</span>, <span class="comment">// Level 4</span></span></span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599E-05,</span><br><span class="line">      4.29635263467995E-05,</span><br><span class="line">      2.14817631733998E-05,</span><br><span class="line">      1.07408815866999E-05,</span><br><span class="line">      5.37044079334994E-06,</span><br><span class="line">      2.68522039667497E-06,</span><br><span class="line">      1.34261019833748E-06</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> crs = <span class="keyword">new</span> L.Proj.CRS(<span class="string">&#x27;EPSG:4490&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&#x27;+proj=longlat +ellps=GRS80 +no_defs&#x27;</span>,</span></span><br><span class="line">      &#123;</span><br><span class="line">        resolutions: res,</span><br><span class="line">        origin: [118.122911693886, 31.2869311022836],</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = L.map(<span class="string">&#x27;mapid&#x27;</span>, &#123;</span></span><br><span class="line">      crs: crs</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> url = <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyraster/Mapserver&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> attrib = <span class="string">&quot;&amp;copy 杭州市规划资源局&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> basemap = <span class="keyword">new</span> L.TileLayer(url + <span class="string">&quot;/tile/&#123;z&#125;/&#123;y&#125;/&#123;x&#125;&quot;</span>, &#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      attribution: attrib</span><br><span class="line">    &#125;);</span><br><span class="line">    map.addLayer(basemap);</span><br><span class="line"><span class="javascript">    map.setView([<span class="number">30</span>, <span class="number">120</span>], <span class="number">4</span>); <span class="comment">//设置比例尺和中心点级别</span></span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3.3.1.3%E6%89%8B%E5%8A%A8%E5%8A%A0%E8%BD%BD%2F%E7%A7%BB%E9%99%A4%E5%9C%B0%E5%9B%BE" id="3-3-1-3手动加载-移除地图">3.3.1.3手动加载/移除地图</h3>
<h2 id="3.3.2%E5%9B%BE%E5%B1%82" id="3-3-2图层">3.3.2图层</h2>
<h3 id="3.3.2.1%E5%BC%B9%E5%87%BA%E4%BF%A1%E6%81%AF%E6%A1%86" id="3-3-2-1弹出信息框">3.3.2.1弹出信息框</h3>
<p>点击地图弹出信息，示例代码bindPopup</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>添加电子地图<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--添加leaflet样式--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--添加leafletjs包--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--添加坐标库--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4-compressed.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html &#123;</span><br><span class="line">      height: 100%</span><br><span class="line">    &#125;</span><br><span class="line">    body &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.map</span> &#123;</span></span><br><span class="line">      height: 100%</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mapid&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> res = [</span></span><br><span class="line"><span class="javascript">      <span class="number">0.00549933137239034</span>, <span class="comment">// Level 0</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00274966568619517</span>, <span class="comment">// Level 1</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00137483284309758</span>, <span class="comment">// Level 2</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000687416421548792</span>, <span class="comment">// Level 3</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000343708210774396</span>, <span class="comment">// Level 4</span></span></span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599E-05,</span><br><span class="line">      4.29635263467995E-05,</span><br><span class="line">      2.14817631733998E-05,</span><br><span class="line">      1.07408815866999E-05,</span><br><span class="line">      5.37044079334994E-06,</span><br><span class="line">      2.68522039667497E-06,</span><br><span class="line">      1.34261019833748E-06</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> crs = <span class="keyword">new</span> L.Proj.CRS(<span class="string">&#x27;EPSG:4490&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&#x27;+proj=longlat +ellps=GRS80 +no_defs&#x27;</span>,</span></span><br><span class="line">      &#123;</span><br><span class="line">        resolutions: res,</span><br><span class="line"><span class="javascript">        origin: [<span class="number">118.122911693886</span>, <span class="number">31.2869311022836</span>],    <span class="comment">//切图原点</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = L.map(<span class="string">&#x27;mapid&#x27;</span>, &#123;</span></span><br><span class="line">      crs: crs</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> url = <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> attrib = <span class="string">&quot;&amp;copy 杭州市规划资源局&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> basemap = <span class="keyword">new</span> L.TileLayer(url + <span class="string">&quot;/tile/&#123;z&#125;/&#123;y&#125;/&#123;x&#125;&quot;</span>, &#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      attribution: attrib</span><br><span class="line">    &#125;);</span><br><span class="line">    map.addLayer(basemap);</span><br><span class="line"><span class="javascript">    map.setView([<span class="number">30.25168</span>, <span class="number">120.16179</span>], <span class="number">4</span>); <span class="comment">//设置比例尺和中心点级别					</span></span></span><br><span class="line"><span class="handlebars"><span class="xml">    L.marker([30.25168, 120.16179]).addTo(map).bindPopup(&quot;<span class="tag">&lt;<span class="name">b</span>&gt;</span>Hello world!<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span>I am a popup.&quot;).openPopup();</span></span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="3.3.2.2%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%B1%82%EF%BC%88wms%EF%BC%89" id="3-3-2-2矢量图层（wms）">3.3.2.2矢量图层（wms）</h4>
<p>加载WMS地图服务，支持filter筛选</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>调用WMS<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/Plugins/leaflet.wms.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4-compressed.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html &#123;</span><br><span class="line">      height: 100%</span><br><span class="line">    &#125;</span><br><span class="line">    body &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.map</span> &#123;</span></span><br><span class="line">      height: 100%</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mapid&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> res = [</span></span><br><span class="line"><span class="javascript">      <span class="number">0.00549933137239034</span>, <span class="comment">// Level 0</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00274966568619517</span>, <span class="comment">// Level 1</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00137483284309758</span>, <span class="comment">// Level 2</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000687416421548792</span>, <span class="comment">// Level 3</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000343708210774396</span>, <span class="comment">// Level 4</span></span></span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599E-05,</span><br><span class="line">      4.29635263467995E-05,</span><br><span class="line">      2.14817631733998E-05,</span><br><span class="line">      1.07408815866999E-05,</span><br><span class="line">      5.37044079334994E-06,</span><br><span class="line">      2.68522039667497E-06,</span><br><span class="line">      1.34261019833748E-06</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> crs = <span class="keyword">new</span> L.Proj.CRS(<span class="string">&#x27;EPSG:4490&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&#x27;+proj=longlat +ellps=GRS80 +no_defs&#x27;</span>,</span></span><br><span class="line">      &#123;</span><br><span class="line">        resolutions: res,</span><br><span class="line">        origin: [118.122911693886, 31.2869311022836],</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = L.map(<span class="string">&#x27;mapid&#x27;</span>, &#123;</span></span><br><span class="line">      crs: crs</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> url = <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> attrib = <span class="string">&quot;&amp;copy 杭州市规划资源局&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> basemap = <span class="keyword">new</span> L.TileLayer(url + <span class="string">&quot;/tile/&#123;z&#125;/&#123;y&#125;/&#123;x&#125;&quot;</span>, &#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      attribution: attrib</span><br><span class="line">    &#125;);</span><br><span class="line">    map.addLayer(basemap);</span><br><span class="line"><span class="javascript">    map.setView([<span class="number">30</span>, <span class="number">120</span>], <span class="number">4</span>); <span class="comment">//设置比例尺和中心点级别</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// L.WMS.source</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> wmsurl = L.WMS.overlay(<span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_csbj0619/MapServer/wms&quot;</span>,</span></span><br><span class="line">      &#123;</span><br><span class="line"><span class="javascript">        <span class="string">&quot;transparent&quot;</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;srs&quot;</span>: <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;layers&quot;</span>: <span class="string">&quot;lsyt_dmdz_csbj0619&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;format&quot;</span>: <span class="string">&quot;image/png&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;CQL_FILTER&quot;</span>: <span class="string">&quot;quxian=&#x27;余杭区&#x27;&quot;</span></span></span><br><span class="line">      &#125;);</span><br><span class="line">    map.addLayer(wmsurl);</span><br><span class="line"><span class="javascript">    map.on(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      alert(<span class="string">&quot;You clicked the map at &quot;</span> + e.latlng);</span></span><br><span class="line">    &#125;);              	</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="3.3.2.3%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%B1%82%EF%BC%88wfs%EF%BC%89" id="3-3-2-3矢量图层（wfs）">3.3.2.3矢量图层（wfs）</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>加载WFS电子地图<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/Plugins/leaflet-wfs.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4-compressed.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">    body &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.map</span> &#123;</span></span><br><span class="line">      height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mapid&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> res = [</span></span><br><span class="line"><span class="javascript">      <span class="number">0.00549933137239034</span>, <span class="comment">// Level 0</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00274966568619517</span>, <span class="comment">// Level 1</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00137483284309758</span>, <span class="comment">// Level 2</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000687416421548792</span>, <span class="comment">// Level 3</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000343708210774396</span>, <span class="comment">// Level 4</span></span></span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599e-5,</span><br><span class="line">      4.29635263467995e-5,</span><br><span class="line">      2.14817631733998e-5,</span><br><span class="line">      1.07408815866999e-5,</span><br><span class="line">      5.37044079334994e-6,</span><br><span class="line">      2.68522039667497e-6,</span><br><span class="line">      1.34261019833748e-6,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> crs = <span class="keyword">new</span> L.Proj.CRS(</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;+proj=longlat +ellps=GRS80 +no_defs&quot;</span>,</span></span><br><span class="line">      &#123;</span><br><span class="line">        resolutions: res,</span><br><span class="line">        origin: [118.122911693886, 31.2869311022836],</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = L.map(<span class="string">&quot;mapid&quot;</span>, &#123;</span></span><br><span class="line">      crs: crs,</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> attrib = <span class="string">&quot;&amp;copy 杭州市规划资源局&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> basemap = <span class="keyword">new</span> L.TileLayer(url + <span class="string">&quot;/tile/&#123;z&#125;/&#123;y&#125;/&#123;x&#125;&quot;</span>, &#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      attribution: attrib,</span><br><span class="line">    &#125;);</span><br><span class="line">    map.addLayer(basemap);</span><br><span class="line"><span class="javascript">    map.setView([<span class="number">30</span>, <span class="number">120</span>], <span class="number">4</span>); <span class="comment">//设置比例尺和中心点级别</span></span></span><br><span class="line"><span class="javascript">    map.on(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      alert(<span class="string">&quot;You clicked the map at &quot;</span> + e.latlng);</span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> myStyle = &#123;</span></span><br><span class="line"><span class="javascript">      color: <span class="string">&quot;#ff0000&quot;</span>,</span></span><br><span class="line">      weight: 2,</span><br><span class="line">      opacity: 1,</span><br><span class="line">      fillOpacity: 0.01,</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> mblayer;</span></span><br><span class="line"><span class="javascript">    $.ajax(&#123;</span></span><br><span class="line">      url:</span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&quot;</span>,</span></span><br><span class="line"><span class="javascript">      success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> geojson = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line">        mblayer = L.geoJSON(geojson, &#123;</span><br><span class="line">          style: myStyle,</span><br><span class="line">        &#125;).addTo(map);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="3.3.3%E6%9F%A5%E8%AF%A2" id="3-3-3查询">3.3.3查询</h2>
<h3 id="3.3.3.1%E7%82%B9%E6%9F%A5%E8%AF%A2" id="3-3-3-1点查询">3.3.3.1点查询</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>点查询<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/Plugins/leaflet-wfs.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4-compressed.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">    body &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.map</span> &#123;</span></span><br><span class="line">      height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mapid&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> res = [</span></span><br><span class="line"><span class="javascript">      <span class="number">0.00549933137239034</span>, <span class="comment">// Level 0</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00274966568619517</span>, <span class="comment">// Level 1</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00137483284309758</span>, <span class="comment">// Level 2</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000687416421548792</span>, <span class="comment">// Level 3</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000343708210774396</span>, <span class="comment">// Level 4</span></span></span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599e-5,</span><br><span class="line">      4.29635263467995e-5,</span><br><span class="line">      2.14817631733998e-5,</span><br><span class="line">      1.07408815866999e-5,</span><br><span class="line">      5.37044079334994e-6,</span><br><span class="line">      2.68522039667497e-6,</span><br><span class="line">      1.34261019833748e-6,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> crs = <span class="keyword">new</span> L.Proj.CRS(</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;+proj=longlat +ellps=GRS80 +no_defs&quot;</span>,</span></span><br><span class="line">      &#123;</span><br><span class="line">        resolutions: res,</span><br><span class="line">        origin: [118.122911693886, 31.2869311022836],</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = L.map(<span class="string">&quot;mapid&quot;</span>, &#123;</span></span><br><span class="line">      crs: crs,</span><br><span class="line">      /*fullscreenControl: &#123;</span><br><span class="line"><span class="javascript">        pseudoFullscreen: <span class="literal">false</span></span></span><br><span class="line">      &#125;,*/</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> attrib = <span class="string">&quot;&amp;copy 杭州市规划资源局&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> basemap = <span class="keyword">new</span> L.TileLayer(url + <span class="string">&quot;/tile/&#123;z&#125;/&#123;y&#125;/&#123;x&#125;&quot;</span>, &#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      attribution: attrib,</span><br><span class="line">    &#125;);</span><br><span class="line">    map.addLayer(basemap);</span><br><span class="line"><span class="javascript">    map.setView([<span class="number">30</span>, <span class="number">120</span>], <span class="number">4</span>); <span class="comment">//设置比例尺和中心点级别</span></span></span><br><span class="line"><span class="javascript">    map.on(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// alert(&quot;You clicked the map at &quot; + e.latlng);</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> point = e.latlng.lng + <span class="string">&quot;,&quot;</span> + e.latlng.lat + <span class="string">&quot;,&quot;</span> + e.latlng.lng + <span class="string">&quot;,&quot;</span> + e.latlng.lat;<span class="comment">// &quot;120.16271670916996,30.251675868508478,120.1713094144393,30.25591314629446&quot;;</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> qurl =</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&amp;CQL_FILTER=BBOX(geom,&quot;</span> + point + <span class="string">&quot;)&quot;</span>;</span></span><br><span class="line"><span class="javascript">      $.ajax(&#123;</span></span><br><span class="line">        url: qurl,</span><br><span class="line"><span class="javascript">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> text = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line"><span class="javascript">          alert(<span class="string">&quot;You clicked the map at &quot;</span> + text.features[<span class="number">1</span>].properties[<span class="string">&#x27;quxian&#x27;</span>]);</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> myStyle = &#123;</span></span><br><span class="line"><span class="javascript">      color: <span class="string">&quot;#ff0000&quot;</span>,</span></span><br><span class="line">      weight: 2,</span><br><span class="line">      opacity: 1,</span><br><span class="line">      fillOpacity: 0.01,</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> mblayer;</span></span><br><span class="line"><span class="javascript">    $.ajax(&#123;</span></span><br><span class="line">      url:</span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&quot;</span>,</span></span><br><span class="line"><span class="javascript">      success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> geojson = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line">        mblayer = L.geoJSON(geojson, &#123;</span><br><span class="line">          style: myStyle,</span><br><span class="line">        &#125;).addTo(map);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3.3.3.2%E9%9D%A2%E6%9F%A5%E8%AF%A2" id="3-3-3-2面查询">3.3.3.2面查询</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>面查询<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/Plugins/leaflet-draw/leaflet.draw.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/Plugins/leaflet-wfs.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4-compressed.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/Plugins/leaflet-draw/leaflet.draw.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">    body &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.map</span> &#123;</span></span><br><span class="line">      height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mapid&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> res = [</span></span><br><span class="line"><span class="javascript">      <span class="number">0.00549933137239034</span>, <span class="comment">// Level 0</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00274966568619517</span>, <span class="comment">// Level 1</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00137483284309758</span>, <span class="comment">// Level 2</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000687416421548792</span>, <span class="comment">// Level 3</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000343708210774396</span>, <span class="comment">// Level 4</span></span></span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599e-5,</span><br><span class="line">      4.29635263467995e-5,</span><br><span class="line">      2.14817631733998e-5,</span><br><span class="line">      1.07408815866999e-5,</span><br><span class="line">      5.37044079334994e-6,</span><br><span class="line">      2.68522039667497e-6,</span><br><span class="line">      1.34261019833748e-6,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> crs = <span class="keyword">new</span> L.Proj.CRS(</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;+proj=longlat +ellps=GRS80 +no_defs&quot;</span>,</span></span><br><span class="line">      &#123;</span><br><span class="line">        resolutions: res,</span><br><span class="line">        origin: [118.122911693886, 31.2869311022836],</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = L.map(<span class="string">&quot;mapid&quot;</span>, &#123;</span></span><br><span class="line">      crs: crs,</span><br><span class="line">      /*fullscreenControl: &#123;</span><br><span class="line"><span class="javascript">        pseudoFullscreen: <span class="literal">false</span></span></span><br><span class="line">      &#125;,*/</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> attrib = <span class="string">&quot;&amp;copy 杭州市规划资源局&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> basemap = <span class="keyword">new</span> L.TileLayer(url + <span class="string">&quot;/tile/&#123;z&#125;/&#123;y&#125;/&#123;x&#125;&quot;</span>, &#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      attribution: attrib,</span><br><span class="line">    &#125;);</span><br><span class="line">    map.addLayer(basemap);</span><br><span class="line"><span class="javascript">    map.setView([<span class="number">30</span>, <span class="number">120</span>], <span class="number">4</span>); <span class="comment">//设置比例尺和中心点级别</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//var draw=new L.Control.Draw(map,drawControl.options.rectangle).enable();</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> options = &#123;</span></span><br><span class="line"><span class="javascript">      position: <span class="string">&quot;topleft&quot;</span>,</span></span><br><span class="line">      draw: &#123;</span><br><span class="line"><span class="javascript">        polyline: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">        polygon: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">        circle: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">        marker: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">        circlemarker: <span class="literal">false</span>,</span></span><br><span class="line">        rectangle: &#123;</span><br><span class="line">          shapeOptions: &#123;</span><br><span class="line"><span class="javascript">            clickable: <span class="literal">true</span>,</span></span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> drawControl = <span class="keyword">new</span> L.Control.Draw(options);</span></span><br><span class="line">    map.addControl(drawControl);</span><br><span class="line"><span class="javascript">    map.on(L.Draw.Event.CREATED, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> type = e.layerType;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">if</span> (type == <span class="string">&quot;rectangle&quot;</span>) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> bound = e.layer.getBounds();</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> point =</span></span><br><span class="line">          bound._southWest.lng +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;,&quot;</span> +</span></span><br><span class="line">          bound._southWest.lat +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;,&quot;</span> +</span></span><br><span class="line">          bound._northEast.lng +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;,&quot;</span> +</span></span><br><span class="line"><span class="javascript">          bound._northEast.lat; <span class="comment">// &quot;120.16271670916996,30.251675868508478,120.1713094144393,30.25591314629446&quot;;</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> qurl =</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&amp;CQL_FILTER=BBOX(geom,&quot;</span> +</span></span><br><span class="line">          point +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;)&quot;</span>;</span></span><br><span class="line"><span class="javascript">        $.ajax(&#123;</span></span><br><span class="line">          url: qurl,</span><br><span class="line"><span class="javascript">          success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> text = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line">            alert(</span><br><span class="line"><span class="javascript">              <span class="string">&quot;你选择的是 &quot;</span> + text.features[<span class="number">1</span>].properties[<span class="string">&quot;quxian&quot;</span>]</span></span><br><span class="line">            );</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> myStyle = &#123;</span></span><br><span class="line"><span class="javascript">      color: <span class="string">&quot;#ff0000&quot;</span>,</span></span><br><span class="line">      weight: 2,</span><br><span class="line">      opacity: 1,</span><br><span class="line">      fillOpacity: 0.01,</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> mblayer;</span></span><br><span class="line"><span class="javascript">    $.ajax(&#123;</span></span><br><span class="line">      url:</span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&quot;</span>,</span></span><br><span class="line"><span class="javascript">      success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> geojson = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line">        mblayer = L.geoJSON(geojson, &#123;</span><br><span class="line">          style: myStyle,</span><br><span class="line">        &#125;).addTo(map);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3.3.3.3%E5%B1%9E%E6%80%A7%E6%9F%A5%E8%AF%A2" id="3-3-3-3属性查询">3.3.3.3属性查询</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>点查询<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/Plugins/leaflet-wfs.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4-compressed.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">    body &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.map</span> &#123;</span></span><br><span class="line">      height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.h1</span> &#123;</span></span><br><span class="line">      z-index: 1009;</span><br><span class="line">      position: absolute;</span><br><span class="line">      left: 100px;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mapid&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>点击地图根据属性查询<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> res = [</span></span><br><span class="line"><span class="javascript">      <span class="number">0.00549933137239034</span>, <span class="comment">// Level 0</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00274966568619517</span>, <span class="comment">// Level 1</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00137483284309758</span>, <span class="comment">// Level 2</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000687416421548792</span>, <span class="comment">// Level 3</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000343708210774396</span>, <span class="comment">// Level 4</span></span></span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599e-5,</span><br><span class="line">      4.29635263467995e-5,</span><br><span class="line">      2.14817631733998e-5,</span><br><span class="line">      1.07408815866999e-5,</span><br><span class="line">      5.37044079334994e-6,</span><br><span class="line">      2.68522039667497e-6,</span><br><span class="line">      1.34261019833748e-6,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> crs = <span class="keyword">new</span> L.Proj.CRS(</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;+proj=longlat +ellps=GRS80 +no_defs&quot;</span>,</span></span><br><span class="line">      &#123;</span><br><span class="line">        resolutions: res,</span><br><span class="line">        origin: [118.122911693886, 31.2869311022836],</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = L.map(<span class="string">&quot;mapid&quot;</span>, &#123;</span></span><br><span class="line">      crs: crs,</span><br><span class="line">      /*fullscreenControl: &#123;</span><br><span class="line"><span class="javascript">        pseudoFullscreen: <span class="literal">false</span></span></span><br><span class="line">      &#125;,*/</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> attrib = <span class="string">&quot;&amp;copy 杭州市规划资源局&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> basemap = <span class="keyword">new</span> L.TileLayer(url + <span class="string">&quot;/tile/&#123;z&#125;/&#123;y&#125;/&#123;x&#125;&quot;</span>, &#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      attribution: attrib,</span><br><span class="line">    &#125;);</span><br><span class="line">    map.addLayer(basemap);</span><br><span class="line"><span class="javascript">    map.setView([<span class="number">30</span>, <span class="number">120</span>], <span class="number">4</span>); <span class="comment">//设置比例尺和中心点级别</span></span></span><br><span class="line"><span class="javascript">    map.on(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> point =</span></span><br><span class="line">        e.latlng.lng +</span><br><span class="line"><span class="javascript">        <span class="string">&quot;,&quot;</span> +</span></span><br><span class="line">        e.latlng.lat +</span><br><span class="line"><span class="javascript">        <span class="string">&quot;,&quot;</span> +</span></span><br><span class="line">        e.latlng.lng +</span><br><span class="line"><span class="javascript">        <span class="string">&quot;,&quot;</span> +</span></span><br><span class="line"><span class="javascript">        e.latlng.lat; <span class="comment">// &quot;120.16271670916996,30.251675868508478,120.1713094144393,30.25591314629446&quot;;</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> qurl =</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&amp;CQL_FILTER=&quot;</span>;</span></span><br><span class="line"><span class="javascript">      qurl += <span class="string">&quot; quxian=&#x27;上城区&#x27;&quot;</span>;</span></span><br><span class="line"><span class="javascript">      $.ajax(&#123;</span></span><br><span class="line">        url: qurl,</span><br><span class="line"><span class="javascript">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> text = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line"><span class="javascript">          alert(<span class="string">&quot;根据属性选择的是 &quot;</span> + text.features[<span class="number">0</span>].properties[<span class="string">&quot;quxian&quot;</span>]);</span></span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> myStyle = &#123;</span></span><br><span class="line"><span class="javascript">      color: <span class="string">&quot;#ff0000&quot;</span>,</span></span><br><span class="line">      weight: 2,</span><br><span class="line">      opacity: 1,</span><br><span class="line">      fillOpacity: 0.01,</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> mblayer;</span></span><br><span class="line"><span class="javascript">    $.ajax(&#123;</span></span><br><span class="line">      url:</span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&quot;</span>,</span></span><br><span class="line"><span class="javascript">      success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> geojson = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line">        mblayer = L.geoJSON(geojson, &#123;</span><br><span class="line">          style: myStyle,</span><br><span class="line">        &#125;).addTo(map);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3.3.3.4%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2" id="3-3-3-4组合查询">3.3.3.4组合查询</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>面查询<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/Plugins/leaflet-draw/leaflet.draw.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/Plugins/leaflet-wfs.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4-compressed.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/pro/proj4leaflet.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/leaflet/V1.3/leaflet/Plugins/leaflet-draw/leaflet.draw.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">    body &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.map</span> &#123;</span></span><br><span class="line">      height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mapid&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> res = [</span></span><br><span class="line"><span class="javascript">      <span class="number">0.00549933137239034</span>, <span class="comment">// Level 0</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00274966568619517</span>, <span class="comment">// Level 1</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.00137483284309758</span>, <span class="comment">// Level 2</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000687416421548792</span>, <span class="comment">// Level 3</span></span></span><br><span class="line"><span class="javascript">      <span class="number">0.000343708210774396</span>, <span class="comment">// Level 4</span></span></span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599e-5,</span><br><span class="line">      4.29635263467995e-5,</span><br><span class="line">      2.14817631733998e-5,</span><br><span class="line">      1.07408815866999e-5,</span><br><span class="line">      5.37044079334994e-6,</span><br><span class="line">      2.68522039667497e-6,</span><br><span class="line">      1.34261019833748e-6,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> crs = <span class="keyword">new</span> L.Proj.CRS(</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;+proj=longlat +ellps=GRS80 +no_defs&quot;</span>,</span></span><br><span class="line">      &#123;</span><br><span class="line">        resolutions: res,</span><br><span class="line">        origin: [118.122911693886, 31.2869311022836],</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = L.map(<span class="string">&quot;mapid&quot;</span>, &#123;</span></span><br><span class="line">      crs: crs,</span><br><span class="line">      /*fullscreenControl: &#123;</span><br><span class="line"><span class="javascript">        pseudoFullscreen: <span class="literal">false</span></span></span><br><span class="line">      &#125;,*/</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> attrib = <span class="string">&quot;&amp;copy 杭州市规划资源局&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> basemap = <span class="keyword">new</span> L.TileLayer(url + <span class="string">&quot;/tile/&#123;z&#125;/&#123;y&#125;/&#123;x&#125;&quot;</span>, &#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      attribution: attrib,</span><br><span class="line">    &#125;);</span><br><span class="line">    map.addLayer(basemap);</span><br><span class="line"><span class="javascript">    map.setView([<span class="number">30</span>, <span class="number">120</span>], <span class="number">4</span>); <span class="comment">//设置比例尺和中心点级别</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//var draw=new L.Control.Draw(map,drawControl.options.rectangle).enable();</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> options = &#123;</span></span><br><span class="line"><span class="javascript">      position: <span class="string">&quot;topleft&quot;</span>,</span></span><br><span class="line">      draw: &#123;</span><br><span class="line"><span class="javascript">        polyline: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">        polygon: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">        circle: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">        marker: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">        circlemarker: <span class="literal">false</span>,</span></span><br><span class="line">        rectangle: &#123;</span><br><span class="line">          shapeOptions: &#123;</span><br><span class="line"><span class="javascript">            clickable: <span class="literal">true</span>,</span></span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> drawControl = <span class="keyword">new</span> L.Control.Draw(options);</span></span><br><span class="line">    map.addControl(drawControl);</span><br><span class="line"><span class="javascript">    map.on(L.Draw.Event.CREATED, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> type = e.layerType;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">if</span> (type == <span class="string">&quot;rectangle&quot;</span>) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> bound = e.layer.getBounds();</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> point =</span></span><br><span class="line">          bound._southWest.lng +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;,&quot;</span> +</span></span><br><span class="line">          bound._southWest.lat +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;,&quot;</span> +</span></span><br><span class="line">          bound._northEast.lng +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;,&quot;</span> +</span></span><br><span class="line"><span class="javascript">          bound._northEast.lat; <span class="comment">// &quot;120.16271670916996,30.251675868508478,120.1713094144393,30.25591314629446&quot;;</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> qurl =</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&amp;CQL_FILTER=BBOX(geom,&quot;</span> +</span></span><br><span class="line">          point +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;)&quot;</span>;</span></span><br><span class="line"><span class="javascript">        qurl += <span class="string">&quot; and quxian=&#x27;上城区&#x27;&quot;</span>;</span></span><br><span class="line"><span class="javascript">        $.ajax(&#123;</span></span><br><span class="line">          url: qurl,</span><br><span class="line"><span class="javascript">          success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> text = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (!text.features.length) &#123;</span></span><br><span class="line"><span class="javascript">              alert(<span class="string">&quot;你选择的是非上城区，无查询结果！&quot;</span>);</span></span><br><span class="line"><span class="javascript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">              alert(<span class="string">&quot;你选择的是 &quot;</span> + text.features[<span class="number">0</span>].properties[<span class="string">&quot;quxian&quot;</span>]);</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> myStyle = &#123;</span></span><br><span class="line"><span class="javascript">      color: <span class="string">&quot;#ff0000&quot;</span>,</span></span><br><span class="line">      weight: 2,</span><br><span class="line">      opacity: 1,</span><br><span class="line">      fillOpacity: 0.01,</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> mblayer;</span></span><br><span class="line"><span class="javascript">    $.ajax(&#123;</span></span><br><span class="line">      url:</span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&quot;</span>,</span></span><br><span class="line"><span class="javascript">      success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> geojson = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line">        mblayer = L.geoJSON(geojson, &#123;</span><br><span class="line">          style: myStyle,</span><br><span class="line">        &#125;).addTo(map);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="arcgis">ArcGIS</h1>
<p>ArcGIS API for JavaScript就是ESRI公司用JavaScipt语言编写的一套程序接口。用户可以通过调用API获取ArcGIS server、geoserver等提供的服务，例如浏览、编辑、渲染地图，以及一些常用的空间分析功能。API中包含了ArcGIS API for JavaScript中每个类的详细描述。使用API查找每个类的构造函数选项以及属性、方法和事件。</p>
<p>详情见官方网站https://developers.arcgis.com/javascript/3/jsapi/</p>
<h2 id="3.1.1%E5%9C%B0%E5%9B%BE" id="3-1-1地图">3.1.1地图</h2>
<h3 id="3.1.1.1%E7%9F%A2%E9%87%8F%E7%94%B5%E5%AD%90%E5%9C%B0%E5%9B%BE" id="3-1-1-1矢量电子地图">3.1.1.1矢量电子地图</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;initial-scale=1, maximum-scale=1,user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Map with Vertor<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/dijit/themes/claro/claro.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/esri/css/esri.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html,</span><br><span class="line">    body,</span><br><span class="line"><span class="css">    \<span class="selector-id">#map</span> &#123;</span></span><br><span class="line">      ​ height: 100%;</span><br><span class="line">      ​ width: 100%;</span><br><span class="line">      ​ margin: 0;</span><br><span class="line">      ​ padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.esriControlsBR</span> <span class="selector-class">.logo-med</span> &#123;</span></span><br><span class="line">      ​ display: none;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/init.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">require</span>([</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/map&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayerInfo&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/ArcGISTiledMapServiceLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/geometry/Extent&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/_base/array&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom-construct&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/parser&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/BorderContainer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/ContentPane&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/domReady!&quot;</span>,</span></span><br><span class="line"><span class="javascript">    ], <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">Map</span>,</span></span><br><span class="line">      WMSLayer,</span><br><span class="line">      WMSLayerInfo,</span><br><span class="line">      ArcGISTiledMapServiceLayer,</span><br><span class="line">      Extent,</span><br><span class="line">      array,</span><br><span class="line">      dom,</span><br><span class="line">      domConst,</span><br><span class="line">      parser</span><br><span class="line">    ) &#123;</span><br><span class="line">      parser.parse();</span><br><span class="line"><span class="javascript">      map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="string">&quot;map&quot;</span>, &#123;</span></span><br><span class="line"><span class="javascript">        center: <span class="keyword">new</span> esri.geometry.Point(</span></span><br><span class="line">          120.1594,</span><br><span class="line">          30.2571,</span><br><span class="line"><span class="javascript">          <span class="keyword">new</span> esri.SpatialReference(&#123; <span class="attr">wkid</span>: <span class="number">4490</span> &#125;)</span></span><br><span class="line">        ),</span><br><span class="line">        zoom: 3,</span><br><span class="line">      &#125;);</span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> layer = <span class="keyword">new</span> ArcGISTiledMapServiceLayer(</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver&quot;</span>,</span></span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">          id: <span class="string">&quot;vector&quot;</span>,</span></span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">      map.addLayer(layer);</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;claro&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> ​ <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> ​ <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.ContentPane&quot;</span> ​ <span class="attr">data-dojo-props</span>=<span class="string">&quot;region:&#x27;center&#x27;&quot;</span> ​</span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&quot;overflow: hidden;&quot;</span> \&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="3.1.1.2%E5%BD%B1%E5%83%8F%E7%94%B5%E5%AD%90%E5%9C%B0%E5%9B%BE" id="3-1-1-2影像电子地图">3.1.1.2影像电子地图</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;initial-scale=1, maximum-scale=1,user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Map with Raster<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/dijit/themes/claro/claro.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/esri/css/esri.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html,</span><br><span class="line">    body,</span><br><span class="line"><span class="css">    \<span class="selector-id">#map</span> &#123;</span></span><br><span class="line">      ​ height: 100%;</span><br><span class="line">      ​ width: 100%;</span><br><span class="line">      ​ margin: 0;</span><br><span class="line">      ​ padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.esriControlsBR</span> <span class="selector-class">.logo-med</span> &#123;</span></span><br><span class="line">      ​ display: none;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/init.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">require</span>([</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/map&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayerInfo&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/ArcGISTiledMapServiceLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/geometry/Extent&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/_base/array&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom-construct&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/parser&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/BorderContainer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/ContentPane&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/domReady!&quot;</span>,</span></span><br><span class="line"><span class="javascript">    ], <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">Map</span>,</span></span><br><span class="line">      WMSLayer,</span><br><span class="line">      WMSLayerInfo,</span><br><span class="line">      ArcGISTiledMapServiceLayer,</span><br><span class="line">      Extent,</span><br><span class="line">      array,</span><br><span class="line">      dom,</span><br><span class="line">      domConst,</span><br><span class="line">      parser</span><br><span class="line">    ) &#123;</span><br><span class="line">      parser.parse();</span><br><span class="line"><span class="javascript">      map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="string">&quot;map&quot;</span>, &#123;</span></span><br><span class="line"><span class="javascript">        center: <span class="keyword">new</span> esri.geometry.Point(</span></span><br><span class="line">          120.1594,</span><br><span class="line">          30.2571,</span><br><span class="line"><span class="javascript">          <span class="keyword">new</span> esri.SpatialReference(&#123; <span class="attr">wkid</span>: <span class="number">4490</span> &#125;)</span></span><br><span class="line">        ),</span><br><span class="line">        zoom: 3,</span><br><span class="line">      &#125;);</span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> layer = <span class="keyword">new</span> ArcGISTiledMapServiceLayer(</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyraster/Mapserver&quot;</span>,</span></span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">          id: <span class="string">&quot;raster&quot;</span>,</span></span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">      map.addLayer(layer);</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;claro&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> ​ <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> ​ <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.ContentPane&quot;</span> ​ <span class="attr">data-dojo-props</span>=<span class="string">&quot;region:&#x27;center&#x27;&quot;</span> ​</span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&quot;overflow: hidden;&quot;</span> \&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="3.1.1.3%E6%89%8B%E5%8A%A8%E5%8A%A0%E8%BD%BD%2F%E7%A7%BB%E9%99%A4%E5%9C%B0%E5%9B%BE" id="3-1-1-3手动加载-移除地图">3.1.1.3手动加载/移除地图</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;initial-scale=1, maximum-scale=1,user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Map with Control<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/dijit/themes/claro/claro.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/esri/css/esri.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html,</span><br><span class="line">    body,</span><br><span class="line"><span class="css">    \<span class="selector-id">#map</span> &#123;</span></span><br><span class="line">      ​ height: 100%;</span><br><span class="line">      ​ width: 100%;</span><br><span class="line">      ​ margin: 0;</span><br><span class="line">      ​ padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.esriControlsBR</span> <span class="selector-class">.logo-med</span> &#123;</span></span><br><span class="line">      ​ display: none;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.details</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">      ​ cursor: pointer;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/init.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">require</span>([</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/map&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayerInfo&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/ArcGISTiledMapServiceLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/geometry/Extent&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/_base/array&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom-construct&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/parser&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/BorderContainer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/ContentPane&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/domReady!&quot;</span>,</span></span><br><span class="line"><span class="javascript">    ], <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">Map</span>,</span></span><br><span class="line">      WMSLayer,</span><br><span class="line">      WMSLayerInfo,</span><br><span class="line">      ArcGISTiledMapServiceLayer,</span><br><span class="line">      Extent,</span><br><span class="line">      array,</span><br><span class="line">      dom,</span><br><span class="line">      domConst,</span><br><span class="line">      parser</span><br><span class="line">    ) &#123;</span><br><span class="line">      parser.parse();</span><br><span class="line"><span class="javascript">      map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="string">&quot;map&quot;</span>, &#123;</span></span><br><span class="line"><span class="javascript">        center: <span class="keyword">new</span> esri.geometry.Point(</span></span><br><span class="line">          120.1594,</span><br><span class="line">          30.2571,</span><br><span class="line"><span class="javascript">          <span class="keyword">new</span> esri.SpatialReference(&#123; <span class="attr">wkid</span>: <span class="number">4490</span> &#125;)</span></span><br><span class="line">        ),</span><br><span class="line">        zoom: 3,</span><br><span class="line">      &#125;);</span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> vector = <span class="keyword">new</span> ArcGISTiledMapServiceLayer(</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver&quot;</span>,</span></span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">          id: <span class="string">&quot;vector&quot;</span>,</span></span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line"><span class="javascript">      <span class="comment">// map.addLayer(vector);</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> raster = <span class="keyword">new</span> ArcGISTiledMapServiceLayer(</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyraster/Mapserver&quot;</span>,</span></span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">          id: <span class="string">&quot;raster&quot;</span>,</span></span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line"><span class="javascript">      <span class="comment">// map.addLayer(raster);</span></span></span><br><span class="line"><span class="javascript">      $(<span class="string">&quot;#details span&quot;</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> name = $(<span class="built_in">this</span>).attr(<span class="string">&quot;name&quot;</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">switch</span> (name) &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">case</span> <span class="string">&quot;vector&quot;</span>:</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (!map.getLayer(<span class="string">&quot;vector&quot;</span>)) map.addLayer(vector);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">break</span>;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">case</span> <span class="string">&quot;raster&quot;</span>:</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (!map.getLayer(<span class="string">&quot;raster&quot;</span>)) map.addLayer(raster);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">break</span>;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">case</span> <span class="string">&quot;rvector&quot;</span>:</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (map.getLayer(<span class="string">&quot;vector&quot;</span>)) map.removeLayer(vector);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">break</span>;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">case</span> <span class="string">&quot;rraster&quot;</span>:</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (map.getLayer(<span class="string">&quot;raster&quot;</span>)) map.removeLayer(raster);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">break</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;claro&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span> <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.BorderContainer&quot;</span> <span class="attr">data-dojo-props</span>=<span class="string">&quot;design:&#x27;headline&#x27;, gutters:true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&quot;width: 100%; height: 100%; margin: 0;&quot;</span> \&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> ​ <span class="attr">id</span>=<span class="string">&quot;details&quot;</span> ​ <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.ContentPane&quot;</span> ​ <span class="attr">data-dojo-props</span>=<span class="string">&quot;region:&#x27;left&#x27;, splitter:true&quot;</span> ​</span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">&quot;overflow: auto; width: 200px;&quot;</span> \&gt;</span></span><br><span class="line">      ​ <span class="tag">&lt;<span class="name">span</span> <span class="attr">name</span>=<span class="string">&quot;vector&quot;</span>&gt;</span>添加矢量图层<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      ​ <span class="tag">&lt;<span class="name">span</span> <span class="attr">name</span>=<span class="string">&quot;raster&quot;</span>&gt;</span>添加影像图层<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      ​ <span class="tag">&lt;<span class="name">span</span> <span class="attr">name</span>=<span class="string">&quot;rvector&quot;</span>&gt;</span>移除矢量图层<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      ​ <span class="tag">&lt;<span class="name">span</span> <span class="attr">name</span>=<span class="string">&quot;rraster&quot;</span>&gt;</span>移除影像图层<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> ​ <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> ​ <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.ContentPane&quot;</span> ​ <span class="attr">data-dojo-props</span>=<span class="string">&quot;region:&#x27;center&#x27;&quot;</span> ​</span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">&quot;overflow: hidden;&quot;</span> \&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="3.1.2%E5%9B%BE%E5%B1%82" id="3-1-2图层">3.1.2图层</h2>
<h3 id="3.1.2.1%E5%BC%B9%E5%87%BA%E4%BF%A1%E6%81%AF%E6%A1%86" id="3-1-2-1弹出信息框">3.1.2.1弹出信息框</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;initial-scale=1, maximum-scale=1,user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Map with infoWindow<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/dijit/themes/claro/claro.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/esri/css/esri.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html,</span><br><span class="line">    body,</span><br><span class="line"><span class="css">    \<span class="selector-id">#map</span> &#123;</span></span><br><span class="line">      ​ height: 100%;</span><br><span class="line">      ​ width: 100%;</span><br><span class="line">      ​ margin: 0;</span><br><span class="line">      ​ padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.esriControlsBR</span> <span class="selector-class">.logo-med</span> &#123;</span></span><br><span class="line">      ​ display: none;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/init.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">require</span>([</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/map&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WFSLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayerInfo&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/ArcGISTiledMapServiceLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/geometry/Extent&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/_base/array&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom-construct&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/parser&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/BorderContainer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/ContentPane&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/domReady!&quot;</span>,</span></span><br><span class="line"><span class="javascript">    ], <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">Map</span>,</span></span><br><span class="line">      WFSLayer,</span><br><span class="line">      WMSLayerInfo,</span><br><span class="line">      ArcGISTiledMapServiceLayer,</span><br><span class="line">      Extent,</span><br><span class="line">      array,</span><br><span class="line">      dom,</span><br><span class="line">      domConst,</span><br><span class="line">      parser</span><br><span class="line">    ) &#123;</span><br><span class="line">      parser.parse();</span><br><span class="line"><span class="javascript">      map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="string">&quot;map&quot;</span>, &#123;</span></span><br><span class="line"><span class="javascript">        center: <span class="keyword">new</span> esri.geometry.Point(</span></span><br><span class="line">          120.1594,</span><br><span class="line">          30.2571,</span><br><span class="line"><span class="javascript">          <span class="keyword">new</span> esri.SpatialReference(&#123; <span class="attr">wkid</span>: <span class="number">4490</span> &#125;)</span></span><br><span class="line">        ),</span><br><span class="line">        zoom: 3,</span><br><span class="line">      &#125;);</span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> layer = <span class="keyword">new</span> ArcGISTiledMapServiceLayer(</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver&quot;</span>,</span></span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">          id: <span class="string">&quot;vector&quot;</span>,</span></span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">      map.addLayer(layer);</span><br><span class="line"><span class="javascript">      map.on(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        map.infoWindow.setTitle(<span class="string">&quot;详细信息&quot;</span>);</span></span><br><span class="line"><span class="javascript">        map.infoWindow.setContent(<span class="string">&quot;当前坐标：&quot;</span> + e.mapPoint.x + <span class="string">&quot;,&quot;</span> + e.mapPoint.y);</span></span><br><span class="line">        map.infoWindow.show(e.mapPoint);</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;claro&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> ​ <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> ​ <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.ContentPane&quot;</span> ​ <span class="attr">data-dojo-props</span>=<span class="string">&quot;region:&#x27;center&#x27;&quot;</span> ​</span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&quot;overflow: hidden;&quot;</span> \&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3.1.2.2%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%B1%82%EF%BC%88wms%EF%BC%89" id="3-1-2-2矢量图层（wms）">3.1.2.2矢量图层（wms）</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;initial-scale=1, maximum-scale=1,user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Map with wmslayer<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/dijit/themes/claro/claro.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/esri/css/esri.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html,</span><br><span class="line">    body,</span><br><span class="line"><span class="css">    \<span class="selector-id">#map</span> &#123;</span></span><br><span class="line">      ​ height: 100%;</span><br><span class="line">      ​ width: 100%;</span><br><span class="line">      ​ margin: 0;</span><br><span class="line">      ​ padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.esriControlsBR</span> <span class="selector-class">.logo-med</span> &#123;</span></span><br><span class="line">      ​ display: none;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/init.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">require</span>([</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/map&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayerInfo&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/ArcGISTiledMapServiceLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/geometry/Extent&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/_base/array&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom-construct&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/parser&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/BorderContainer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/ContentPane&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/domReady!&quot;</span>,</span></span><br><span class="line"><span class="javascript">    ], <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">Map</span>,</span></span><br><span class="line">      WMSLayer,</span><br><span class="line">      WMSLayerInfo,</span><br><span class="line">      ArcGISTiledMapServiceLayer,</span><br><span class="line">      Extent,</span><br><span class="line">      array,</span><br><span class="line">      dom,</span><br><span class="line">      domConst,</span><br><span class="line">      parser</span><br><span class="line">    ) &#123;</span><br><span class="line">      parser.parse();</span><br><span class="line"><span class="javascript">      map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="string">&quot;map&quot;</span>, &#123;</span></span><br><span class="line"><span class="javascript">        center: <span class="keyword">new</span> esri.geometry.Point(</span></span><br><span class="line">          120.1594,</span><br><span class="line">          30.2571,</span><br><span class="line"><span class="javascript">          <span class="keyword">new</span> esri.SpatialReference(&#123; <span class="attr">wkid</span>: <span class="number">4490</span> &#125;)</span></span><br><span class="line">        ),</span><br><span class="line">        zoom: 3,</span><br><span class="line">      &#125;);</span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> layer = <span class="keyword">new</span> ArcGISTiledMapServiceLayer(</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver&quot;</span>,</span></span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">          id: <span class="string">&quot;vector&quot;</span>,</span></span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">      map.addLayer(layer);</span><br><span class="line"><span class="javascript">      map.on(<span class="string">&quot;load&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> extent = map.extent;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wms&quot;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> resourceInfo = &#123;</span></span><br><span class="line">          extent: extent,</span><br><span class="line">          layerInfos: [],</span><br><span class="line"><span class="javascript">          version: <span class="string">&quot;1.1.1&quot;</span>,</span></span><br><span class="line"><span class="javascript">          visibleLayers: [<span class="string">&quot;1&quot;</span>],</span></span><br><span class="line">        &#125;;</span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> wmslayer = <span class="keyword">new</span> esri.layers.WMSLayer(url, &#123;</span></span><br><span class="line">          resourceInfo: resourceInfo,</span><br><span class="line">        &#125;);</span><br><span class="line"><span class="javascript">        wmslayer.setImageFormat(<span class="string">&quot;png&quot;</span>);</span></span><br><span class="line"><span class="javascript">        wmslayer.setVisibleLayers(<span class="string">&quot;gpserver&quot;</span>);</span></span><br><span class="line">        map.addLayer(wmslayer);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;claro&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> ​ <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> ​ <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.ContentPane&quot;</span> ​ <span class="attr">data-dojo-props</span>=<span class="string">&quot;region:&#x27;center&#x27;&quot;</span> ​</span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&quot;overflow: hidden;&quot;</span> \&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3.1.2.3%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%B1%82%EF%BC%88wfs%EF%BC%89" id="3-1-2-3矢量图层（wfs）">3.1.2.3矢量图层（wfs）</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;initial-scale=1, maximum-scale=1,user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Map with wfslayer<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/dijit/themes/claro/claro.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/esri/css/esri.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html,</span><br><span class="line">    body,</span><br><span class="line"><span class="css">    \<span class="selector-id">#map</span> &#123;</span></span><br><span class="line">      ​ height: 100%;</span><br><span class="line">      ​ width: 100%;</span><br><span class="line">      ​ margin: 0;</span><br><span class="line">      ​ padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.esriControlsBR</span> <span class="selector-class">.logo-med</span> &#123;</span></span><br><span class="line">      ​ display: none;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/init.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map, symbol;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">require</span>([</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/map&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WFSLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayerInfo&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/ArcGISTiledMapServiceLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/symbols/SimpleLineSymbol&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/symbols/SimpleFillSymbol&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/graphic&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/geometry/Extent&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/geometry/Polygon&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/_base/array&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom-construct&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/parser&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/BorderContainer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/ContentPane&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/domReady!&quot;</span>,</span></span><br><span class="line"><span class="javascript">    ], <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">Map</span>,</span></span><br><span class="line">      WFSLayer,</span><br><span class="line">      WMSLayerInfo,</span><br><span class="line">      ArcGISTiledMapServiceLayer,</span><br><span class="line">      SimpleLineSymbol,</span><br><span class="line">      SimpleFillSymbol,</span><br><span class="line">      Graphic,</span><br><span class="line">      Extent,</span><br><span class="line">      Polygon,</span><br><span class="line">      array,</span><br><span class="line">      dom,</span><br><span class="line">      domConst,</span><br><span class="line">      parser</span><br><span class="line">    ) &#123;</span><br><span class="line">      parser.parse();</span><br><span class="line"><span class="javascript">      map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="string">&quot;map&quot;</span>, &#123;</span></span><br><span class="line"><span class="javascript">        center: <span class="keyword">new</span> esri.geometry.Point(</span></span><br><span class="line">          120.1594,</span><br><span class="line">          30.2571,</span><br><span class="line"><span class="javascript">          <span class="keyword">new</span> esri.SpatialReference(&#123; <span class="attr">wkid</span>: <span class="number">4490</span> &#125;)</span></span><br><span class="line">        ),</span><br><span class="line">        zoom: 3,</span><br><span class="line">      &#125;);</span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> layer = <span class="keyword">new</span> ArcGISTiledMapServiceLayer(</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver&quot;</span>,</span></span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">          id: <span class="string">&quot;vector&quot;</span>,</span></span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">      map.addLayer(layer);</span><br><span class="line"><span class="javascript">      map.on(<span class="string">&quot;load&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> extent = map.extent;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&quot;</span>;</span></span><br><span class="line"><span class="javascript">        $.ajax(&#123;</span></span><br><span class="line">          url: url,</span><br><span class="line"><span class="javascript">          success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> text = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; text.features.length; i++) &#123;</span></span><br><span class="line"><span class="javascript">              symbol = <span class="keyword">new</span> SimpleFillSymbol();</span></span><br><span class="line"><span class="javascript">              <span class="keyword">if</span> (text.features[i].geometry.type == <span class="string">&quot;Polygon&quot;</span>) &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> polygonjson = &#123;</span></span><br><span class="line"><span class="javascript">                  <span class="string">&quot;rings&quot;</span>: text.features[i].geometry.coordinates[<span class="number">0</span>],</span></span><br><span class="line"><span class="javascript">                  <span class="string">&quot;spatialReference&quot;</span>: &#123; <span class="string">&quot;wkid&quot;</span>: <span class="number">4490</span> &#125;</span></span><br><span class="line">                &#125;</span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> poly = <span class="keyword">new</span> Polygon(polygonjson)</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> graphic = <span class="keyword">new</span> Graphic(poly, symbol);</span></span><br><span class="line"><span class="javascript">                <span class="comment">//var gra = new Graphic(text.features[i].geometry, symbol);</span></span></span><br><span class="line">                map.graphics.add(graphic);</span><br><span class="line"><span class="javascript">              &#125; <span class="keyword">else</span> <span class="keyword">if</span> (text.features[i].geometry.type == <span class="string">&quot;MultiPolygon&quot;</span>) &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> len = text.features[i].geometry.coordinates.length;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">for</span> (<span class="keyword">var</span> k = <span class="number">0</span>; k &lt; len; k++) &#123;</span></span><br><span class="line"><span class="javascript">                  <span class="keyword">var</span> polygonjson = &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="string">&quot;rings&quot;</span>: text.features[i].geometry.coordinates[k],</span></span><br><span class="line"><span class="javascript">                    <span class="string">&quot;spatialReference&quot;</span>: &#123; <span class="string">&quot;wkid&quot;</span>: <span class="number">4490</span> &#125;</span></span><br><span class="line">                  &#125;</span><br><span class="line"><span class="javascript">                  <span class="keyword">var</span> poly = <span class="keyword">new</span> Polygon(polygonjson)</span></span><br><span class="line"><span class="javascript">                  <span class="keyword">var</span> graphic = <span class="keyword">new</span> Graphic(poly, symbol);</span></span><br><span class="line">                  map.graphics.add(graphic);</span><br><span class="line">                &#125;</span><br><span class="line"><span class="javascript">              &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line">                alert();</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;claro&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> ​ <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> ​ <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.ContentPane&quot;</span> ​ <span class="attr">data-dojo-props</span>=<span class="string">&quot;region:&#x27;center&#x27;&quot;</span> ​</span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&quot;overflow: hidden;&quot;</span> \&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="3.1.3%E6%9F%A5%E8%AF%A2" id="3-1-3查询">3.1.3查询</h2>
<h3 id="3.1.3.1%E7%82%B9%E6%9F%A5%E8%AF%A2" id="3-1-3-1点查询">3.1.3.1点查询</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;initial-scale=1, maximum-scale=1,user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Query By Point<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/dijit/themes/claro/claro.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/esri/css/esri.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html,</span><br><span class="line">    body,</span><br><span class="line"><span class="css">    \<span class="selector-id">#map</span> &#123;</span></span><br><span class="line">      ​ height: 100%;</span><br><span class="line">      ​ width: 100%;</span><br><span class="line">      ​ margin: 0;</span><br><span class="line">      ​ padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/init.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">require</span>([</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/map&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayerInfo&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/ArcGISTiledMapServiceLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/geometry/Extent&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/_base/array&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom-construct&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/parser&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/BorderContainer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/ContentPane&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/domReady!&quot;</span>,</span></span><br><span class="line"><span class="javascript">    ], <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">Map</span>,</span></span><br><span class="line">      WMSLayer,</span><br><span class="line">      WMSLayerInfo,</span><br><span class="line">      ArcGISTiledMapServiceLayer,</span><br><span class="line">      Extent,</span><br><span class="line">      array,</span><br><span class="line">      dom,</span><br><span class="line">      domConst,</span><br><span class="line">      parser</span><br><span class="line">    ) &#123;</span><br><span class="line">      parser.parse();</span><br><span class="line"><span class="javascript">      map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="string">&quot;map&quot;</span>, &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// basemap: &quot;streets&quot;,</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// center: [120.1594, 30.2571],</span></span></span><br><span class="line"><span class="javascript">        center: <span class="keyword">new</span> esri.geometry.Point(</span></span><br><span class="line">          120.1594,</span><br><span class="line">          30.2571,</span><br><span class="line"><span class="javascript">          <span class="keyword">new</span> esri.SpatialReference(&#123; <span class="attr">wkid</span>: <span class="number">4490</span> &#125;)</span></span><br><span class="line">        ),</span><br><span class="line">        zoom: 3,</span><br><span class="line">      &#125;);</span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> layer2 = <span class="keyword">new</span> ArcGISTiledMapServiceLayer(</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://21.15.116.31/e8b4611714092ac7bc35cb5e8d476e4824f85f3a/Tile/ArcGISREST/hzsyvector.gis&quot;</span>,</span></span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">          <span class="comment">// id: layerInfo.LayerName,</span></span></span><br><span class="line"><span class="javascript">          id: <span class="string">&quot;底图&quot;</span>,</span></span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">      map.addLayer(layer2);</span><br><span class="line"><span class="javascript">      map.on(<span class="string">&quot;load&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> extent = map.extent;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wms&quot;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> resourceInfo = &#123;</span></span><br><span class="line">          extent: extent,</span><br><span class="line">          layerInfos: [],</span><br><span class="line"><span class="javascript">          version: <span class="string">&quot;1.1.1&quot;</span>,</span></span><br><span class="line"><span class="javascript">          visibleLayers: [<span class="string">&quot;1&quot;</span>],</span></span><br><span class="line">        &#125;;</span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> wmslayer = <span class="keyword">new</span> esri.layers.WMSLayer(url, &#123;</span></span><br><span class="line">          resourceInfo: resourceInfo,</span><br><span class="line">        &#125;);</span><br><span class="line"><span class="javascript">        wmslayer.setImageFormat(<span class="string">&quot;png&quot;</span>);</span></span><br><span class="line"><span class="javascript">        wmslayer.setVisibleLayers(<span class="string">&quot;gpserver&quot;</span>);</span></span><br><span class="line">        map.addLayer(wmslayer);</span><br><span class="line">      &#125;);</span><br><span class="line"><span class="javascript">      map.on(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&quot;获取到的点&quot;</span> + e);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> point = e.mapPoint.x + <span class="string">&quot;,&quot;</span> + e.mapPoint.y + <span class="string">&quot;,&quot;</span> + e.mapPoint.x + <span class="string">&quot;,&quot;</span> + e.mapPoint.y;<span class="comment">// &quot;120.16271670916996,30.251675868508478,120.1713094144393,30.25591314629446&quot;;</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> qurl =</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&amp;CQL_FILTER=BBOX(geom,&quot;</span> + point + <span class="string">&quot;)&quot;</span>;</span></span><br><span class="line"><span class="javascript">        $.ajax(&#123;</span></span><br><span class="line">          url: qurl,</span><br><span class="line"><span class="javascript">          success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> text = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line"><span class="javascript">            $(<span class="string">&#x27;#details&#x27;</span>).html(text.features[<span class="number">1</span>].properties[<span class="string">&#x27;quxian&#x27;</span>]);</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;claro&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span> <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.BorderContainer&quot;</span> <span class="attr">data-dojo-props</span>=<span class="string">&quot;design:&#x27;headline&#x27;, gutters:true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&quot;width: 100%; height: 100%; margin: 0;&quot;</span> \&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> ​ <span class="attr">id</span>=<span class="string">&quot;details&quot;</span> ​ <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.ContentPane&quot;</span> ​ <span class="attr">data-dojo-props</span>=<span class="string">&quot;region:&#x27;left&#x27;, splitter:true&quot;</span> ​</span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">&quot;overflow: auto; width: 200px;&quot;</span> \&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> ​ <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> ​ <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.ContentPane&quot;</span> ​ <span class="attr">data-dojo-props</span>=<span class="string">&quot;region:&#x27;center&#x27;&quot;</span> ​</span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">&quot;overflow: hidden;&quot;</span> \&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3.1.3.2%E9%9D%A2%E6%9F%A5%E8%AF%A2" id="3-1-3-2面查询">3.1.3.2面查询</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;initial-scale=1, maximum-scale=1,user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Query By Rectangle<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/dijit/themes/claro/claro.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/esri/css/esri.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html,</span><br><span class="line">    body,</span><br><span class="line"><span class="css">    \<span class="selector-id">#map</span> &#123;</span></span><br><span class="line">      ​ height: 100%;</span><br><span class="line">      ​ width: 100%;</span><br><span class="line">      ​ margin: 0;</span><br><span class="line">      ​ padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/init.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map, toolbar;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">require</span>([</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/map&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayerInfo&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/toolbars/draw&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/symbols/SimpleLineSymbol&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/symbols/SimpleFillSymbol&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/graphic&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/ArcGISTiledMapServiceLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/geometry/Extent&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/_base/array&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom-construct&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/parser&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/BorderContainer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/ContentPane&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/domReady!&quot;</span>,</span></span><br><span class="line"><span class="javascript">    ], <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">Map</span>,</span></span><br><span class="line">      WMSLayer,</span><br><span class="line">      WMSLayerInfo,</span><br><span class="line">      Draw,</span><br><span class="line">      SimpleLineSymbol,</span><br><span class="line">      SimpleFillSymbol,</span><br><span class="line">      Graphic,</span><br><span class="line">      ArcGISTiledMapServiceLayer,</span><br><span class="line">      Extent,</span><br><span class="line">      array,</span><br><span class="line">      dom,</span><br><span class="line">      domConst,</span><br><span class="line">      parser</span><br><span class="line">    ) &#123;</span><br><span class="line">      parser.parse();</span><br><span class="line"><span class="javascript">      map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="string">&quot;map&quot;</span>, &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// basemap: &quot;streets&quot;,</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// center: [120.1594, 30.2571],</span></span></span><br><span class="line"><span class="javascript">        center: <span class="keyword">new</span> esri.geometry.Point(</span></span><br><span class="line">          120.1594,</span><br><span class="line">          30.2571,</span><br><span class="line"><span class="javascript">          <span class="keyword">new</span> esri.SpatialReference(&#123; <span class="attr">wkid</span>: <span class="number">4490</span> &#125;)</span></span><br><span class="line">        ),</span><br><span class="line">        zoom: 3,</span><br><span class="line">      &#125;);</span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> layer2 = <span class="keyword">new</span> ArcGISTiledMapServiceLayer(</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://21.15.116.31/e8b4611714092ac7bc35cb5e8d476e4824f85f3a/Tile/ArcGISREST/hzsyvector.gis&quot;</span>,</span></span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">          <span class="comment">// id: layerInfo.LayerName,</span></span></span><br><span class="line"><span class="javascript">          id: <span class="string">&quot;底图&quot;</span>,</span></span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">      map.addLayer(layer2);</span><br><span class="line"><span class="javascript">      map.on(<span class="string">&quot;load&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> extent = map.extent;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wms&quot;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> resourceInfo = &#123;</span></span><br><span class="line">          extent: extent,</span><br><span class="line">          layerInfos: [],</span><br><span class="line"><span class="javascript">          version: <span class="string">&quot;1.1.1&quot;</span>,</span></span><br><span class="line"><span class="javascript">          visibleLayers: [<span class="string">&quot;1&quot;</span>],</span></span><br><span class="line">        &#125;;</span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> wmslayer = <span class="keyword">new</span> esri.layers.WMSLayer(url, &#123;</span></span><br><span class="line">          resourceInfo: resourceInfo,</span><br><span class="line">        &#125;);</span><br><span class="line"><span class="javascript">        wmslayer.setImageFormat(<span class="string">&quot;png&quot;</span>);</span></span><br><span class="line"><span class="javascript">        wmslayer.setVisibleLayers(<span class="string">&quot;gpserver&quot;</span>);</span></span><br><span class="line">        map.addLayer(wmslayer);</span><br><span class="line"><span class="javascript">        toolbar = <span class="keyword">new</span> Draw(map);</span></span><br><span class="line"><span class="javascript">        toolbar.on(<span class="string">&quot;draw-end&quot;</span>, showinfo);</span></span><br><span class="line"><span class="javascript">        toolbar.activate(Draw[<span class="string">&quot;RECTANGLE&quot;</span>]);</span></span><br><span class="line">      &#125;);</span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">showinfo</span>(<span class="params">evt</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> symbol;</span></span><br><span class="line">        toolbar.deactivate();</span><br><span class="line">        map.graphics.clear();</span><br><span class="line"><span class="javascript">        symbol = <span class="keyword">new</span> SimpleFillSymbol();</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> graphic = <span class="keyword">new</span> Graphic(evt.geometry, symbol);</span></span><br><span class="line">        map.graphics.add(graphic);</span><br><span class="line">        getAttr(evt.geometry);</span><br><span class="line">      &#125;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">getAttr</span>(<span class="params">geo</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> point =</span></span><br><span class="line">          geo.cache._extent.xmin +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;,&quot;</span> +</span></span><br><span class="line">          geo.cache._extent.ymin +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;,&quot;</span> +</span></span><br><span class="line">          geo.cache._extent.xmax +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;,&quot;</span> +</span></span><br><span class="line"><span class="javascript">          geo.cache._extent.ymax; <span class="comment">// &quot;120.16271670916996,30.251675868508478,120.1713094144393,30.25591314629446&quot;;</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> qurl = <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&amp;CQL_FILTER=BBOX(geom,&quot;</span> + point + <span class="string">&quot;)&quot;</span>;</span></span><br><span class="line"><span class="javascript">        $.ajax(&#123;</span></span><br><span class="line">          url: qurl,</span><br><span class="line"><span class="javascript">          success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> text = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> attr = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; text.features.length; i++) &#123;</span></span><br><span class="line"><span class="javascript">              attr += text.features[i].properties[<span class="string">&quot;quxian&quot;</span>] + <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="javascript">            $(<span class="string">&quot;#details&quot;</span>).html(attr);</span></span><br><span class="line"><span class="javascript">            toolbar.activate(Draw[<span class="string">&quot;RECTANGLE&quot;</span>]);</span></span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;claro&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span> <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.BorderContainer&quot;</span> <span class="attr">data-dojo-props</span>=<span class="string">&quot;design:&#x27;headline&#x27;, gutters:true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&quot;width: 100%; height: 100%; margin: 0;&quot;</span> \&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> ​ <span class="attr">id</span>=<span class="string">&quot;details&quot;</span> ​ <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.ContentPane&quot;</span> ​ <span class="attr">data-dojo-props</span>=<span class="string">&quot;region:&#x27;left&#x27;, splitter:true&quot;</span> ​</span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">&quot;overflow: auto; width: 200px;&quot;</span> \&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> ​ <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> ​ <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.ContentPane&quot;</span> ​ <span class="attr">data-dojo-props</span>=<span class="string">&quot;region:&#x27;center&#x27;&quot;</span> ​</span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">&quot;overflow: hidden;&quot;</span> \&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3.1.3.3%E5%B1%9E%E6%80%A7%E6%9F%A5%E8%AF%A2" id="3-1-3-3属性查询">3.1.3.3属性查询</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;initial-scale=1, maximum-scale=1,user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Query by Attr<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/dijit/themes/claro/claro.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/esri/css/esri.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html,</span><br><span class="line">    body,</span><br><span class="line"><span class="css">    \<span class="selector-id">#map</span> &#123;</span></span><br><span class="line">      ​ height: 100%;</span><br><span class="line">      ​ width: 100%;</span><br><span class="line">      ​ margin: 0;</span><br><span class="line">      ​ padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/init.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">require</span>([</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/map&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayerInfo&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/ArcGISTiledMapServiceLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/geometry/Extent&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/_base/array&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom-construct&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/parser&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/BorderContainer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/ContentPane&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/domReady!&quot;</span>,</span></span><br><span class="line"><span class="javascript">    ], <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">Map</span>,</span></span><br><span class="line">      WMSLayer,</span><br><span class="line">      WMSLayerInfo,</span><br><span class="line">      ArcGISTiledMapServiceLayer,</span><br><span class="line">      Extent,</span><br><span class="line">      array,</span><br><span class="line">      dom,</span><br><span class="line">      domConst,</span><br><span class="line">      parser</span><br><span class="line">    ) &#123;</span><br><span class="line">      parser.parse();</span><br><span class="line"><span class="javascript">      map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="string">&quot;map&quot;</span>, &#123;</span></span><br><span class="line"><span class="javascript">        center: <span class="keyword">new</span> esri.geometry.Point(</span></span><br><span class="line">          120.1594,</span><br><span class="line">          30.2571,</span><br><span class="line"><span class="javascript">          <span class="keyword">new</span> esri.SpatialReference(&#123; <span class="attr">wkid</span>: <span class="number">4490</span> &#125;)</span></span><br><span class="line">        ),</span><br><span class="line">        zoom: 3,</span><br><span class="line">      &#125;);</span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> layer2 = <span class="keyword">new</span> ArcGISTiledMapServiceLayer(</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://21.15.116.31/e8b4611714092ac7bc35cb5e8d476e4824f85f3a/Tile/ArcGISREST/hzsyvector.gis&quot;</span>,</span></span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">          id: <span class="string">&quot;底图&quot;</span>,</span></span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">      map.addLayer(layer2);</span><br><span class="line"><span class="javascript">      map.on(<span class="string">&quot;load&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> extent = map.extent;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wms&quot;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> resourceInfo = &#123;</span></span><br><span class="line">          extent: extent,</span><br><span class="line">          layerInfos: [],</span><br><span class="line"><span class="javascript">          version: <span class="string">&quot;1.1.1&quot;</span>,</span></span><br><span class="line"><span class="javascript">          visibleLayers: [<span class="string">&quot;1&quot;</span>],</span></span><br><span class="line">        &#125;;</span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> wmslayer = <span class="keyword">new</span> esri.layers.WMSLayer(url, &#123;</span></span><br><span class="line">          resourceInfo: resourceInfo,</span><br><span class="line">        &#125;);</span><br><span class="line"><span class="javascript">        wmslayer.setImageFormat(<span class="string">&quot;png&quot;</span>);</span></span><br><span class="line"><span class="javascript">        wmslayer.setVisibleLayers(<span class="string">&quot;gpserver&quot;</span>);</span></span><br><span class="line">        map.addLayer(wmslayer);</span><br><span class="line">      &#125;);</span><br><span class="line"><span class="javascript">      map.on(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&quot;获取到的点&quot;</span> + e);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> point =</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;120.16271670916996,30.251675868508478,120.1713094144393,30.25591314629446&quot;</span>; <span class="comment">// &quot;120.16271670916996,30.251675868508478,120.1713094144393,30.25591314629446&quot;;</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> qurl =</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&amp;CQL_FILTER=BBOX(geom,&quot;</span> +</span></span><br><span class="line">          point +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;)&quot;</span>;</span></span><br><span class="line"><span class="javascript">        qurl += <span class="string">&quot; and quxian=&#x27;上城区&#x27;&quot;</span>;</span></span><br><span class="line"><span class="javascript">        $.ajax(&#123;</span></span><br><span class="line">          url: qurl,</span><br><span class="line"><span class="javascript">          success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> text = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> attr = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; text.features.length; i++) &#123;</span></span><br><span class="line"><span class="javascript">              attr += text.features[i].properties[<span class="string">&quot;quxian&quot;</span>] + <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="javascript">            $(<span class="string">&quot;#details&quot;</span>).html(attr);</span></span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;claro&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span> <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.BorderContainer&quot;</span> <span class="attr">data-dojo-props</span>=<span class="string">&quot;design:&#x27;headline&#x27;, gutters:true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&quot;width: 100%; height: 100%; margin: 0;&quot;</span> \&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> ​ <span class="attr">id</span>=<span class="string">&quot;details&quot;</span> ​ <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.ContentPane&quot;</span> ​ <span class="attr">data-dojo-props</span>=<span class="string">&quot;region:&#x27;left&#x27;, splitter:true&quot;</span> ​</span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">&quot;overflow: auto; width: 200px;&quot;</span> \&gt;</span>点击地图实现按属性查询（区县=上城区）<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> ​ <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> ​ <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.ContentPane&quot;</span> ​ <span class="attr">data-dojo-props</span>=<span class="string">&quot;region:&#x27;center&#x27;&quot;</span> ​</span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">&quot;overflow: hidden;&quot;</span> \&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3.1.3.4%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2" id="3-1-3-4组合查询">3.1.3.4组合查询</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;initial-scale=1, maximum-scale=1,user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Query<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/dijit/themes/claro/claro.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/esri/css/esri.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html,</span><br><span class="line">    body,</span><br><span class="line"><span class="css">    \<span class="selector-id">#map</span> &#123;</span></span><br><span class="line">      ​ height: 100%;</span><br><span class="line">      ​ width: 100%;</span><br><span class="line">      ​ margin: 0;</span><br><span class="line">      ​ padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/arcgis_js_api/3.24/init.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map, toolbar;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">require</span>([</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/map&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/WMSLayerInfo&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/toolbars/draw&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/symbols/SimpleLineSymbol&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/symbols/SimpleFillSymbol&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/graphic&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/layers/ArcGISTiledMapServiceLayer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;esri/geometry/Extent&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/_base/array&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/dom-construct&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/parser&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/BorderContainer&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dijit/layout/ContentPane&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="string">&quot;dojo/domReady!&quot;</span>,</span></span><br><span class="line"><span class="javascript">    ], <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">Map</span>,</span></span><br><span class="line">      WMSLayer,</span><br><span class="line">      WMSLayerInfo,</span><br><span class="line">      Draw,</span><br><span class="line">      SimpleLineSymbol,</span><br><span class="line">      SimpleFillSymbol,</span><br><span class="line">      Graphic,</span><br><span class="line">      ArcGISTiledMapServiceLayer,</span><br><span class="line">      Extent,</span><br><span class="line">      array,</span><br><span class="line">      dom,</span><br><span class="line">      domConst,</span><br><span class="line">      parser</span><br><span class="line">    ) &#123;</span><br><span class="line">      parser.parse();</span><br><span class="line"><span class="javascript">      map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="string">&quot;map&quot;</span>, &#123;</span></span><br><span class="line"><span class="javascript">        center: <span class="keyword">new</span> esri.geometry.Point(</span></span><br><span class="line">          120.1594,</span><br><span class="line">          30.2571,</span><br><span class="line"><span class="javascript">          <span class="keyword">new</span> esri.SpatialReference(&#123; <span class="attr">wkid</span>: <span class="number">4490</span> &#125;)</span></span><br><span class="line">        ),</span><br><span class="line">        zoom: 3,</span><br><span class="line">      &#125;);</span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> layer2 = <span class="keyword">new</span> ArcGISTiledMapServiceLayer(</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://21.15.116.31/e8b4611714092ac7bc35cb5e8d476e4824f85f3a/Tile/ArcGISREST/hzsyvector.gis&quot;</span>,</span></span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">          id: <span class="string">&quot;底图&quot;</span>,</span></span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">      map.addLayer(layer2);</span><br><span class="line"><span class="javascript">      map.on(<span class="string">&quot;load&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> extent = map.extent;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wms&quot;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> resourceInfo = &#123;</span></span><br><span class="line">          extent: extent,</span><br><span class="line">          layerInfos: [],</span><br><span class="line"><span class="javascript">          version: <span class="string">&quot;1.1.1&quot;</span>,</span></span><br><span class="line"><span class="javascript">          visibleLayers: [<span class="string">&quot;1&quot;</span>],</span></span><br><span class="line">        &#125;;</span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> wmslayer = <span class="keyword">new</span> esri.layers.WMSLayer(url, &#123;</span></span><br><span class="line">          resourceInfo: resourceInfo,</span><br><span class="line">        &#125;);</span><br><span class="line"><span class="javascript">        wmslayer.setImageFormat(<span class="string">&quot;png&quot;</span>);</span></span><br><span class="line"><span class="javascript">        wmslayer.setVisibleLayers(<span class="string">&quot;gpserver&quot;</span>);</span></span><br><span class="line">        map.addLayer(wmslayer);</span><br><span class="line"><span class="javascript">        toolbar = <span class="keyword">new</span> Draw(map);</span></span><br><span class="line"><span class="javascript">        toolbar.on(<span class="string">&quot;draw-end&quot;</span>, showinfo);</span></span><br><span class="line"><span class="javascript">        toolbar.activate(Draw[<span class="string">&quot;RECTANGLE&quot;</span>]);</span></span><br><span class="line">      &#125;);</span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">showinfo</span>(<span class="params">evt</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> symbol;</span></span><br><span class="line">        toolbar.deactivate();</span><br><span class="line">        map.graphics.clear();</span><br><span class="line"><span class="javascript">        symbol = <span class="keyword">new</span> SimpleFillSymbol();</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> graphic = <span class="keyword">new</span> Graphic(evt.geometry, symbol);</span></span><br><span class="line">        map.graphics.add(graphic);</span><br><span class="line">        getAttr(evt.geometry);</span><br><span class="line">      &#125;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">getAttr</span>(<span class="params">geo</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> point =</span></span><br><span class="line">          geo.cache._extent.xmin +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;,&quot;</span> +</span></span><br><span class="line">          geo.cache._extent.ymin +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;,&quot;</span> +</span></span><br><span class="line">          geo.cache._extent.xmax +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;,&quot;</span> +</span></span><br><span class="line"><span class="javascript">          geo.cache._extent.ymax; <span class="comment">// &quot;120.16271670916996,30.251675868508478,120.1713094144393,30.25591314629446&quot;;</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> qurl =</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&amp;CQL_FILTER=BBOX(geom,&quot;</span> +</span></span><br><span class="line">          point +</span><br><span class="line"><span class="javascript">          <span class="string">&quot;)&quot;</span>;</span></span><br><span class="line"><span class="javascript">        qurl += <span class="string">&quot; and quxian=&#x27;上城区&#x27;&quot;</span>;</span></span><br><span class="line"><span class="javascript">        $.ajax(&#123;</span></span><br><span class="line">          url: qurl,</span><br><span class="line"><span class="javascript">          success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> text = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> attr = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; text.features.length; i++) &#123;</span></span><br><span class="line"><span class="javascript">              attr += text.features[i].properties[<span class="string">&quot;quxian&quot;</span>] + <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="javascript">            $(<span class="string">&quot;#details&quot;</span>).html(attr);</span></span><br><span class="line"><span class="javascript">            toolbar.activate(Draw[<span class="string">&quot;RECTANGLE&quot;</span>]);</span></span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;claro&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span> <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.BorderContainer&quot;</span> <span class="attr">data-dojo-props</span>=<span class="string">&quot;design:&#x27;headline&#x27;, gutters:true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&quot;width: 100%; height: 100%; margin: 0;&quot;</span> \&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> ​ <span class="attr">id</span>=<span class="string">&quot;details&quot;</span> ​ <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.ContentPane&quot;</span> ​ <span class="attr">data-dojo-props</span>=<span class="string">&quot;region:&#x27;left&#x27;, splitter:true&quot;</span> ​</span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">&quot;overflow: auto; width: 200px;&quot;</span> \&gt;</span>在框选范围内查询属性（区县=上城区）的数据<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> ​ <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> ​ <span class="attr">data-dojo-type</span>=<span class="string">&quot;dijit.layout.ContentPane&quot;</span> ​ <span class="attr">data-dojo-props</span>=<span class="string">&quot;region:&#x27;center&#x27;&quot;</span> ​</span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">&quot;overflow: hidden;&quot;</span> \&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<!DOCTYPE html>
<h1 id="openlayers">Openlayers</h1>
<p>OpenLayers 是一个专为Web GIS 客户端开发提供的JavaScript 类库包，用于实现标准格式发布的地图数据访问。OpenLayers实现访问地理空间数据的方法都符合行业标准。OpenLayers 支持Open GIS 协会制定的WMS（Web Mapping Service）和WFS（Web Feature Service）等网络服务规范，可以通过远程服务的方式，将以OGC 服务形式发布的地图数据加载到基于浏览器的OpenLayers 客户端中进行显示。详细见官方网站https://openlayers.org/</p>
<h3 id="%E5%9C%B0%E5%9B%BE" id="地图">地图</h3>
<h4 id="%E7%9F%A2%E9%87%8F%E7%94%B5%E5%AD%90%E5%9C%B0%E5%9B%BE" id="矢量电子地图">矢量电子地图</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>添加电子地图<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/css/ol.css&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/build/ol.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> format = <span class="string">&#x27;image/png&#x27;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> bounds = [<span class="number">119.347618103027</span>, <span class="number">29.7052669525146</span>,</span></span><br><span class="line">      120.698570251465, 30.5366992950439</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> projection = <span class="keyword">new</span> ol.proj.Projection(&#123;</span></span><br><span class="line"><span class="javascript">      code: <span class="string">&#x27;EPSG:4490&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      units: <span class="string">&#x27;degrees&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      axisOrientation: <span class="string">&#x27;neu&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="built_in">global</span>: <span class="literal">true</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> fullExtent = [<span class="number">118.33968849655</span>, <span class="number">29.188589472</span>, <span class="number">120.71408849655</span>, <span class="number">30.5651894750343</span>];</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> resolutions = [</span></span><br><span class="line">      0.00549933137239034,</span><br><span class="line">      0.00274966568619517,</span><br><span class="line">      0.00137483284309758,</span><br><span class="line">      0.000687416421548792,</span><br><span class="line">      0.000343708210774396,</span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599E-05,</span><br><span class="line">      4.29635263467995E-05,</span><br><span class="line">      2.14817631733998E-05,</span><br><span class="line">      1.07408815866999E-05,</span><br><span class="line">      5.37044079334994E-06,</span><br><span class="line">      2.68522039667497E-06,</span><br><span class="line">      1.34261019833748E-06,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileGrid = <span class="keyword">new</span> ol.tilegrid.TileGrid(&#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      origin: [118.122911693886, 31.2869311022836],</span><br><span class="line">      extent: fullExtent,</span><br><span class="line">      resolutions: resolutions</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="comment">// ol.source.XYZ添加瓦片地图的层</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileLayer = <span class="keyword">new</span> ol.layer.Tile(&#123;</span></span><br><span class="line"><span class="javascript">      source: <span class="keyword">new</span> ol.source.XYZ(&#123;</span></span><br><span class="line">        tileGrid: tileGrid,</span><br><span class="line"><span class="javascript">        tileUrlFunction: <span class="function"><span class="keyword">function</span> (<span class="params">tileCoord</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> z = tileCoord[<span class="number">0</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> x = tileCoord[<span class="number">1</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> y = (-tileCoord[<span class="number">2</span>] - <span class="number">1</span>);</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> url = <span class="string">&#x27;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver/tile/&#x27;</span> +</span></span><br><span class="line"><span class="javascript">            z + <span class="string">&#x27;/&#x27;</span> + y + <span class="string">&#x27;/&#x27;</span> + x;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(url);</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> url;</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        projection: <span class="string">&#x27;EPSG:4490&#x27;</span></span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = <span class="keyword">new</span> ol.Map(&#123;</span></span><br><span class="line"><span class="javascript">      target: <span class="string">&#x27;map&#x27;</span>,</span></span><br><span class="line">      layers: [</span><br><span class="line">        tileLayer</span><br><span class="line">      ],</span><br><span class="line"><span class="javascript">      view: <span class="keyword">new</span> ol.View(&#123;</span></span><br><span class="line">        projection: projection</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    map.getView().fit(bounds, map.getSize()); <span class="comment">//非常重要</span></span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="%E5%BD%B1%E5%83%8F%E7%94%B5%E5%AD%90%E5%9C%B0%E5%9B%BE" id="影像电子地图">影像电子地图</h4>
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>添加电子地图</title>
  <link rel="stylesheet" href="http://172.18.109.232:8082/openlayer/v3.20.1/css/ol.css" type="text/css">
  <script src="http://172.18.109.232:8082/openlayer/v3.20.1/build/ol.js"></script>
</head>
<body>
  <div id="map" class="map"></div>
  <script>
    var format = 'image/png';
    var bounds = [119.347618103027, 29.7052669525146,
      120.698570251465, 30.5366992950439
    ];
    var projection = new ol.proj.Projection({
      code: 'EPSG:4490',
      units: 'degrees',
      axisOrientation: 'neu',
      global: true
    });
    var fullExtent = [118.33968849655, 29.188589472, 120.71408849655, 30.5651894750343];
    var resolutions = [
      0.00549933137239034,
      0.00274966568619517,
      0.00137483284309758,
      0.000687416421548792,
      0.000343708210774396,
      0.000171854105387198,
      8.5927052693599E-05,
      4.29635263467995E-05,
      2.14817631733998E-05,
      1.07408815866999E-05,
      5.37044079334994E-06,
      2.68522039667497E-06,
      1.34261019833748E-06,
    ];
    var tileGrid = new ol.tilegrid.TileGrid({
      tileSize: 256,
      origin: [118.122911693886, 31.2869311022836],
      extent: fullExtent,
      resolutions: resolutions
    });
    // ol.source.XYZ添加瓦片地图的层
    var tileLayer = new ol.layer.Tile({
      source: new ol.source.XYZ({
        tileGrid: tileGrid,
        tileUrlFunction: function (tileCoord) {
          var z = tileCoord[0];
          var x = tileCoord[1];
          var y = (-tileCoord[2] - 1);
          var url = 'http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyraster/Mapserver/tile/' +
            z + '/' + y + '/' + x;
          console.log(url);
          return url;
        },
        projection: 'EPSG:4490'
      })
    });
    var map = new ol.Map({
      target: 'map',
      layers: [
        tileLayer
      ],
      view: new ol.View({
        projection: projection
      })
    });
    map.getView().fit(bounds, map.getSize()); //非常重要
  </script>
</body>
</html>
<h3 id="%E5%9B%BE%E5%B1%82" id="图层">图层</h3>
<h4 id="%E5%BC%B9%E5%87%BA%E6%A1%86%E4%BF%A1%E6%81%AF%E6%A1%86" id="弹出框信息框">弹出框信息框</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>弹出信息框<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/css/ol.css&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/build/ol.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-id">#map</span> &#123;</span></span><br><span class="line">    height: 100%;</span><br><span class="line">    width: 100%;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-id">#mypopup</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mypopup&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mypopup-content&quot;</span>&gt;</span>内容自定义<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;closeOverlay&quot;</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> format = <span class="string">&quot;image/png&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> bounds = [</span></span><br><span class="line">      119.347618103027,</span><br><span class="line">      29.7052669525146,</span><br><span class="line">      120.698570251465,</span><br><span class="line">      30.5366992950439,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> projection = <span class="keyword">new</span> ol.proj.Projection(&#123;</span></span><br><span class="line"><span class="javascript">      code: <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line"><span class="javascript">      units: <span class="string">&quot;degrees&quot;</span>,</span></span><br><span class="line"><span class="javascript">      axisOrientation: <span class="string">&quot;neu&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="built_in">global</span>: <span class="literal">true</span>,</span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> fullExtent = [</span></span><br><span class="line">      118.33968849655,</span><br><span class="line">      29.188589472,</span><br><span class="line">      120.71408849655,</span><br><span class="line">      30.5651894750343,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> resolutions = [</span></span><br><span class="line">      0.00549933137239034,</span><br><span class="line">      0.00274966568619517,</span><br><span class="line">      0.00137483284309758,</span><br><span class="line">      0.000687416421548792,</span><br><span class="line">      0.000343708210774396,</span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599e-5,</span><br><span class="line">      4.29635263467995e-5,</span><br><span class="line">      2.14817631733998e-5,</span><br><span class="line">      1.07408815866999e-5,</span><br><span class="line">      5.37044079334994e-6,</span><br><span class="line">      2.68522039667497e-6,</span><br><span class="line">      1.34261019833748e-6,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileGrid = <span class="keyword">new</span> ol.tilegrid.TileGrid(&#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      origin: [118.122911693886, 31.2869311022836],</span><br><span class="line">      extent: fullExtent,</span><br><span class="line">      resolutions: resolutions,</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="comment">// ol.source.XYZ添加瓦片地图的层</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileLayer = <span class="keyword">new</span> ol.layer.Tile(&#123;</span></span><br><span class="line"><span class="javascript">      source: <span class="keyword">new</span> ol.source.XYZ(&#123;</span></span><br><span class="line">        tileGrid: tileGrid,</span><br><span class="line"><span class="javascript">        tileUrlFunction: <span class="function"><span class="keyword">function</span> (<span class="params">tileCoord</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> z = tileCoord[<span class="number">0</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> x = tileCoord[<span class="number">1</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> y = -tileCoord[<span class="number">2</span>] - <span class="number">1</span>;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">            <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver/tile/&quot;</span> +</span></span><br><span class="line">            z +</span><br><span class="line"><span class="javascript">            <span class="string">&quot;/&quot;</span> +</span></span><br><span class="line">            y +</span><br><span class="line"><span class="javascript">            <span class="string">&quot;/&quot;</span> +</span></span><br><span class="line">            x;</span><br><span class="line"><span class="javascript">          <span class="comment">// console.log(url);</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> url;</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        projection: <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> info = $(<span class="string">&quot;#mypopup&quot;</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> content = $(<span class="string">&quot;#mypopup-content&quot;</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> overlay = <span class="keyword">new</span> ol.Overlay(&#123;</span></span><br><span class="line">      element: info[0],</span><br><span class="line"><span class="javascript">      autopan: <span class="literal">true</span>,</span></span><br><span class="line">      autoPanMargin: 20,</span><br><span class="line"><span class="javascript">      positioning: <span class="string">&quot;center-center&quot;</span>,</span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="comment">//map.addOverlay(overlay);</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = <span class="keyword">new</span> ol.Map(&#123;</span></span><br><span class="line"><span class="javascript">      target: <span class="string">&quot;map&quot;</span>,</span></span><br><span class="line">      layers: [tileLayer],</span><br><span class="line">      overlays: [overlay],</span><br><span class="line"><span class="javascript">      view: <span class="keyword">new</span> ol.View(&#123;</span></span><br><span class="line">        projection: projection,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    map.getView().fit(bounds, map.getSize()); <span class="comment">//非常重要</span></span></span><br><span class="line"><span class="javascript">    $(<span class="string">&quot;#closeOverlay&quot;</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line">      info.hide();</span><br><span class="line"><span class="javascript">      <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    map.on(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> location = e.coordinate;</span></span><br><span class="line"><span class="javascript">      content.html(<span class="string">&quot;这是信息框&quot;</span>);</span></span><br><span class="line">      info.show();</span><br><span class="line">      overlay.setPosition(location);</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%B1%82%EF%BC%88wms%EF%BC%89" id="矢量图层（wms）">矢量图层（wms）</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>添加电子地图<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/css/ol.css&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/build/ol.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> format = <span class="string">&#x27;image/png&#x27;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> bounds = [<span class="number">119.347618103027</span>, <span class="number">29.7052669525146</span>,</span></span><br><span class="line">      120.698570251465, 30.5366992950439</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> projection = <span class="keyword">new</span> ol.proj.Projection(&#123;</span></span><br><span class="line"><span class="javascript">      code: <span class="string">&#x27;EPSG:4490&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      units: <span class="string">&#x27;degrees&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      axisOrientation: <span class="string">&#x27;neu&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="built_in">global</span>: <span class="literal">true</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> fullExtent = [<span class="number">118.33968849655</span>, <span class="number">29.188589472</span>, <span class="number">120.71408849655</span>, <span class="number">30.5651894750343</span>];</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> resolutions = [</span></span><br><span class="line">      0.00549933137239034,</span><br><span class="line">      0.00274966568619517,</span><br><span class="line">      0.00137483284309758,</span><br><span class="line">      0.000687416421548792,</span><br><span class="line">      0.000343708210774396,</span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599E-05,</span><br><span class="line">      4.29635263467995E-05,</span><br><span class="line">      2.14817631733998E-05,</span><br><span class="line">      1.07408815866999E-05,</span><br><span class="line">      5.37044079334994E-06,</span><br><span class="line">      2.68522039667497E-06,</span><br><span class="line">      1.34261019833748E-06,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileGrid = <span class="keyword">new</span> ol.tilegrid.TileGrid(&#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      origin: [118.122911693886, 31.2869311022836],</span><br><span class="line">      extent: fullExtent,</span><br><span class="line">      resolutions: resolutions</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="comment">// ol.source.XYZ添加瓦片地图的层</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileLayer = <span class="keyword">new</span> ol.layer.Tile(&#123;</span></span><br><span class="line"><span class="javascript">      source: <span class="keyword">new</span> ol.source.XYZ(&#123;</span></span><br><span class="line">        tileGrid: tileGrid,</span><br><span class="line"><span class="javascript">        tileUrlFunction: <span class="function"><span class="keyword">function</span> (<span class="params">tileCoord</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> z = tileCoord[<span class="number">0</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> x = tileCoord[<span class="number">1</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> y = (-tileCoord[<span class="number">2</span>] - <span class="number">1</span>);</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> url = <span class="string">&#x27;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver/tile/&#x27;</span> +</span></span><br><span class="line"><span class="javascript">            z + <span class="string">&#x27;/&#x27;</span> + y + <span class="string">&#x27;/&#x27;</span> + x;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(url);</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> url;</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        projection: <span class="string">&#x27;EPSG:4490&#x27;</span></span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> untiled = <span class="keyword">new</span> ol.layer.Image(&#123;</span></span><br><span class="line"><span class="javascript">      source: <span class="keyword">new</span> ol.source.ImageWMS(&#123;</span></span><br><span class="line">        ratio: 1,</span><br><span class="line"><span class="javascript">        <span class="comment">//url: &#x27;http://126.10.2.27:8080/geoserver/gpserver/wms&#x27;,</span></span></span><br><span class="line"><span class="javascript">        url: <span class="string">&#x27;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wms?&#x27;</span>,</span></span><br><span class="line">        params: &#123;</span><br><span class="line"><span class="javascript">          <span class="string">&#x27;FORMAT&#x27;</span>: format,</span></span><br><span class="line"><span class="javascript">          <span class="string">&#x27;VERSION&#x27;</span>: <span class="string">&#x27;1.1.1&#x27;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;LAYERS&quot;</span>: <span class="string">&#x27;lsyt_dmdz_qxbj0619&#x27;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;exceptions&quot;</span>: <span class="string">&#x27;application/vnd.ogc.se_inimage&#x27;</span>,</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = <span class="keyword">new</span> ol.Map(&#123;</span></span><br><span class="line"><span class="javascript">      target: <span class="string">&#x27;map&#x27;</span>,</span></span><br><span class="line">      layers: [</span><br><span class="line">        tileLayer,</span><br><span class="line">        untiled</span><br><span class="line">      ],</span><br><span class="line"><span class="javascript">      view: <span class="keyword">new</span> ol.View(&#123;</span></span><br><span class="line">        projection: projection</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    map.getView().fit(bounds, map.getSize()); <span class="comment">//非常重要</span></span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%B1%82%EF%BC%88wfs%EF%BC%89" id="矢量图层（wfs）">矢量图层（wfs）</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>添加WFS电子地图<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/css/ol.css&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/build/ol.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> format = <span class="string">&quot;image/png&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> bounds = [</span></span><br><span class="line">      119.347618103027,</span><br><span class="line">      29.7052669525146,</span><br><span class="line">      120.698570251465,</span><br><span class="line">      30.5366992950439,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> projection = <span class="keyword">new</span> ol.proj.Projection(&#123;</span></span><br><span class="line"><span class="javascript">      code: <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line"><span class="javascript">      units: <span class="string">&quot;degrees&quot;</span>,</span></span><br><span class="line"><span class="javascript">      axisOrientation: <span class="string">&quot;neu&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="built_in">global</span>: <span class="literal">true</span>,</span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> fullExtent = [</span></span><br><span class="line">      118.33968849655,</span><br><span class="line">      29.188589472,</span><br><span class="line">      120.71408849655,</span><br><span class="line">      30.5651894750343,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> resolutions = [</span></span><br><span class="line">      0.00549933137239034,</span><br><span class="line">      0.00274966568619517,</span><br><span class="line">      0.00137483284309758,</span><br><span class="line">      0.000687416421548792,</span><br><span class="line">      0.000343708210774396,</span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599e-5,</span><br><span class="line">      4.29635263467995e-5,</span><br><span class="line">      2.14817631733998e-5,</span><br><span class="line">      1.07408815866999e-5,</span><br><span class="line">      5.37044079334994e-6,</span><br><span class="line">      2.68522039667497e-6,</span><br><span class="line">      1.34261019833748e-6,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileGrid = <span class="keyword">new</span> ol.tilegrid.TileGrid(&#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      origin: [118.122911693886, 31.2869311022836],</span><br><span class="line">      extent: fullExtent,</span><br><span class="line">      resolutions: resolutions,</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="comment">// ol.source.XYZ添加瓦片地图的层</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileLayer = <span class="keyword">new</span> ol.layer.Tile(&#123;</span></span><br><span class="line"><span class="javascript">      source: <span class="keyword">new</span> ol.source.XYZ(&#123;</span></span><br><span class="line">        tileGrid: tileGrid,</span><br><span class="line"><span class="javascript">        tileUrlFunction: <span class="function"><span class="keyword">function</span> (<span class="params">tileCoord</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> z = tileCoord[<span class="number">0</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> x = tileCoord[<span class="number">1</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> y = -tileCoord[<span class="number">2</span>] - <span class="number">1</span>;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">            <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver/tile/&quot;</span> +</span></span><br><span class="line">            z +</span><br><span class="line"><span class="javascript">            <span class="string">&quot;/&quot;</span> +</span></span><br><span class="line">            y +</span><br><span class="line"><span class="javascript">            <span class="string">&quot;/&quot;</span> +</span></span><br><span class="line">            x;</span><br><span class="line"><span class="javascript">          <span class="comment">//console.log(url);</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> url;</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        projection: <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vectorSource = <span class="keyword">new</span> ol.source.Vector(&#123;</span></span><br><span class="line"><span class="javascript">      format: <span class="keyword">new</span> ol.format.GeoJSON(),</span></span><br><span class="line"><span class="javascript">      url: <span class="function"><span class="keyword">function</span> (<span class="params">extent</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&quot;</span>;</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="comment">//strategy: bboxStrategy,</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vector = <span class="keyword">new</span> ol.layer.Vector(&#123;</span></span><br><span class="line">      source: vectorSource,</span><br><span class="line"><span class="javascript">      style: <span class="keyword">new</span> ol.style.Style(&#123;</span></span><br><span class="line"><span class="javascript">        stroke: <span class="keyword">new</span> ol.style.Stroke(&#123;</span></span><br><span class="line"><span class="javascript">          color: <span class="string">&quot;rgba(0, 0, 255, 1.0)&quot;</span>,</span></span><br><span class="line">          width: 2,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = <span class="keyword">new</span> ol.Map(&#123;</span></span><br><span class="line"><span class="javascript">      target: <span class="string">&quot;map&quot;</span>,</span></span><br><span class="line">      layers: [tileLayer, vector],</span><br><span class="line"><span class="javascript">      view: <span class="keyword">new</span> ol.View(&#123;</span></span><br><span class="line">        projection: projection,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    map.getView().fit(bounds, map.getSize()); <span class="comment">//非常重要</span></span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="%E6%9F%A5%E8%AF%A2" id="查询">查询</h3>
<h4 id="%E7%82%B9%E6%9F%A5%E8%AF%A2" id="点查询">点查询</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>点查询<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/css/ol.css&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/build/ol.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> format = <span class="string">&quot;image/png&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> bounds = [</span></span><br><span class="line">      119.347618103027,</span><br><span class="line">      29.7052669525146,</span><br><span class="line">      120.698570251465,</span><br><span class="line">      30.5366992950439,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> projection = <span class="keyword">new</span> ol.proj.Projection(&#123;</span></span><br><span class="line"><span class="javascript">      code: <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line"><span class="javascript">      units: <span class="string">&quot;degrees&quot;</span>,</span></span><br><span class="line"><span class="javascript">      axisOrientation: <span class="string">&quot;neu&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="built_in">global</span>: <span class="literal">true</span>,</span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> fullExtent = [</span></span><br><span class="line">      118.33968849655,</span><br><span class="line">      29.188589472,</span><br><span class="line">      120.71408849655,</span><br><span class="line">      30.5651894750343,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> resolutions = [</span></span><br><span class="line">      0.00549933137239034,</span><br><span class="line">      0.00274966568619517,</span><br><span class="line">      0.00137483284309758,</span><br><span class="line">      0.000687416421548792,</span><br><span class="line">      0.000343708210774396,</span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599e-5,</span><br><span class="line">      4.29635263467995e-5,</span><br><span class="line">      2.14817631733998e-5,</span><br><span class="line">      1.07408815866999e-5,</span><br><span class="line">      5.37044079334994e-6,</span><br><span class="line">      2.68522039667497e-6,</span><br><span class="line">      1.34261019833748e-6,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileGrid = <span class="keyword">new</span> ol.tilegrid.TileGrid(&#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      origin: [118.122911693886, 31.2869311022836],</span><br><span class="line">      extent: fullExtent,</span><br><span class="line">      resolutions: resolutions,</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="comment">// ol.source.XYZ添加瓦片地图的层</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileLayer = <span class="keyword">new</span> ol.layer.Tile(&#123;</span></span><br><span class="line"><span class="javascript">      source: <span class="keyword">new</span> ol.source.XYZ(&#123;</span></span><br><span class="line">        tileGrid: tileGrid,</span><br><span class="line"><span class="javascript">        tileUrlFunction: <span class="function"><span class="keyword">function</span> (<span class="params">tileCoord</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> z = tileCoord[<span class="number">0</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> x = tileCoord[<span class="number">1</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> y = -tileCoord[<span class="number">2</span>] - <span class="number">1</span>;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">            <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver/tile/&quot;</span> +</span></span><br><span class="line">            z +</span><br><span class="line"><span class="javascript">            <span class="string">&quot;/&quot;</span> +</span></span><br><span class="line">            y +</span><br><span class="line"><span class="javascript">            <span class="string">&quot;/&quot;</span> +</span></span><br><span class="line">            x;</span><br><span class="line"><span class="javascript">          <span class="comment">//console.log(url);</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> url;</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        projection: <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vectorSource = <span class="keyword">new</span> ol.source.Vector(&#123;</span></span><br><span class="line"><span class="javascript">      format: <span class="keyword">new</span> ol.format.GeoJSON(),</span></span><br><span class="line"><span class="javascript">      url: <span class="function"><span class="keyword">function</span> (<span class="params">extent</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&quot;</span>;</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="comment">//strategy: bboxStrategy,</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vector = <span class="keyword">new</span> ol.layer.Vector(&#123;</span></span><br><span class="line">      source: vectorSource,</span><br><span class="line"><span class="javascript">      style: <span class="keyword">new</span> ol.style.Style(&#123;</span></span><br><span class="line"><span class="javascript">        stroke: <span class="keyword">new</span> ol.style.Stroke(&#123;</span></span><br><span class="line"><span class="javascript">          color: <span class="string">&quot;rgba(0, 0, 255, 1.0)&quot;</span>,</span></span><br><span class="line">          width: 2,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = <span class="keyword">new</span> ol.Map(&#123;</span></span><br><span class="line"><span class="javascript">      target: <span class="string">&quot;map&quot;</span>,</span></span><br><span class="line">      layers: [tileLayer, vector],</span><br><span class="line"><span class="javascript">      view: <span class="keyword">new</span> ol.View(&#123;</span></span><br><span class="line">        projection: projection,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    map.getView().fit(bounds, map.getSize()); <span class="comment">//非常重要</span></span></span><br><span class="line"><span class="javascript">    map.on(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> location = e.coordinate;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> point = location[<span class="number">0</span>] + <span class="string">&quot;,&quot;</span> + location[<span class="number">1</span>] + <span class="string">&quot;,&quot;</span> + location[<span class="number">0</span>] + <span class="string">&quot;,&quot;</span> + location[<span class="number">1</span>];<span class="comment">// &quot;120.16271670916996,30.251675868508478,120.1713094144393,30.25591314629446&quot;;</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> qurl =</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&amp;CQL_FILTER=BBOX(geom,&quot;</span> + point + <span class="string">&quot;)&quot;</span>;</span></span><br><span class="line"><span class="javascript">      $.ajax(&#123;</span></span><br><span class="line">        url: qurl,</span><br><span class="line"><span class="javascript">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> text = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line"><span class="javascript">          alert(<span class="string">&quot;You clicked the map at &quot;</span> + text.features[<span class="number">1</span>].properties[<span class="string">&#x27;quxian&#x27;</span>]);</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="%E9%9D%A2%E6%9F%A5%E8%AF%A2" id="面查询">面查询</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>框选查询<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/css/ol.css&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/build/ol.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> format = <span class="string">&quot;image/png&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> bounds = [</span></span><br><span class="line">      119.347618103027,</span><br><span class="line">      29.7052669525146,</span><br><span class="line">      120.698570251465,</span><br><span class="line">      30.5366992950439,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> projection = <span class="keyword">new</span> ol.proj.Projection(&#123;</span></span><br><span class="line"><span class="javascript">      code: <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line"><span class="javascript">      units: <span class="string">&quot;degrees&quot;</span>,</span></span><br><span class="line"><span class="javascript">      axisOrientation: <span class="string">&quot;neu&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="built_in">global</span>: <span class="literal">true</span>,</span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> fullExtent = [</span></span><br><span class="line">      118.33968849655,</span><br><span class="line">      29.188589472,</span><br><span class="line">      120.71408849655,</span><br><span class="line">      30.5651894750343,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> resolutions = [</span></span><br><span class="line">      0.00549933137239034,</span><br><span class="line">      0.00274966568619517,</span><br><span class="line">      0.00137483284309758,</span><br><span class="line">      0.000687416421548792,</span><br><span class="line">      0.000343708210774396,</span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599e-5,</span><br><span class="line">      4.29635263467995e-5,</span><br><span class="line">      2.14817631733998e-5,</span><br><span class="line">      1.07408815866999e-5,</span><br><span class="line">      5.37044079334994e-6,</span><br><span class="line">      2.68522039667497e-6,</span><br><span class="line">      1.34261019833748e-6,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileGrid = <span class="keyword">new</span> ol.tilegrid.TileGrid(&#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      origin: [118.122911693886, 31.2869311022836],</span><br><span class="line">      extent: fullExtent,</span><br><span class="line">      resolutions: resolutions,</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="comment">// ol.source.XYZ添加瓦片地图的层</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileLayer = <span class="keyword">new</span> ol.layer.Tile(&#123;</span></span><br><span class="line"><span class="javascript">      source: <span class="keyword">new</span> ol.source.XYZ(&#123;</span></span><br><span class="line">        tileGrid: tileGrid,</span><br><span class="line"><span class="javascript">        tileUrlFunction: <span class="function"><span class="keyword">function</span> (<span class="params">tileCoord</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> z = tileCoord[<span class="number">0</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> x = tileCoord[<span class="number">1</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> y = -tileCoord[<span class="number">2</span>] - <span class="number">1</span>;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">            <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver/tile/&quot;</span> +</span></span><br><span class="line">            z +</span><br><span class="line"><span class="javascript">            <span class="string">&quot;/&quot;</span> +</span></span><br><span class="line">            y +</span><br><span class="line"><span class="javascript">            <span class="string">&quot;/&quot;</span> +</span></span><br><span class="line">            x;</span><br><span class="line"><span class="javascript">          <span class="comment">//console.log(url);</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> url;</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        projection: <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vectorSource = <span class="keyword">new</span> ol.source.Vector(&#123;</span></span><br><span class="line"><span class="javascript">      format: <span class="keyword">new</span> ol.format.GeoJSON(),</span></span><br><span class="line"><span class="javascript">      url: <span class="function"><span class="keyword">function</span> (<span class="params">extent</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&quot;</span>;</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="comment">//strategy: bboxStrategy,</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vector = <span class="keyword">new</span> ol.layer.Vector(&#123;</span></span><br><span class="line">      source: vectorSource,</span><br><span class="line"><span class="javascript">      style: <span class="keyword">new</span> ol.style.Style(&#123;</span></span><br><span class="line"><span class="javascript">        stroke: <span class="keyword">new</span> ol.style.Stroke(&#123;</span></span><br><span class="line"><span class="javascript">          color: <span class="string">&quot;rgba(0, 0, 255, 1.0)&quot;</span>,</span></span><br><span class="line">          width: 2,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = <span class="keyword">new</span> ol.Map(&#123;</span></span><br><span class="line"><span class="javascript">      target: <span class="string">&quot;map&quot;</span>,</span></span><br><span class="line">      layers: [tileLayer, vector],</span><br><span class="line"><span class="javascript">      view: <span class="keyword">new</span> ol.View(&#123;</span></span><br><span class="line">        projection: projection,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    map.getView().fit(bounds, map.getSize()); <span class="comment">//非常重要</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> dragbox = <span class="keyword">new</span> ol.interaction.DragBox();</span></span><br><span class="line">    map.addInteraction(dragbox);</span><br><span class="line"><span class="javascript">    dragbox.on(<span class="string">&quot;boxend&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> extent = dragbox.getGeometry().getExtent();</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> point = extent[<span class="number">0</span>] + <span class="string">&quot;,&quot;</span> + extent[<span class="number">1</span>] + <span class="string">&quot;,&quot;</span> + extent[<span class="number">0</span>] + <span class="string">&quot;,&quot;</span> + extent[<span class="number">1</span>];<span class="comment">// &quot;120.16271670916996,30.251675868508478,120.1713094144393,30.25591314629446&quot;;</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> qurl =</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&amp;CQL_FILTER=BBOX(geom,&quot;</span> + point + <span class="string">&quot;)&quot;</span>;</span></span><br><span class="line"><span class="javascript">      $.ajax(&#123;</span></span><br><span class="line">        url: qurl,</span><br><span class="line"><span class="javascript">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> text = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line"><span class="javascript">          alert(<span class="string">&quot;You clicked the map at &quot;</span> + text.features[<span class="number">0</span>].properties[<span class="string">&#x27;quxian&#x27;</span>]);</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="%E5%B1%9E%E6%80%A7%E6%9F%A5%E8%AF%A2" id="属性查询">属性查询</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>属性查询<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/css/ol.css&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/build/ol.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> format = <span class="string">&quot;image/png&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> bounds = [</span></span><br><span class="line">      119.347618103027,</span><br><span class="line">      29.7052669525146,</span><br><span class="line">      120.698570251465,</span><br><span class="line">      30.5366992950439,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> projection = <span class="keyword">new</span> ol.proj.Projection(&#123;</span></span><br><span class="line"><span class="javascript">      code: <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line"><span class="javascript">      units: <span class="string">&quot;degrees&quot;</span>,</span></span><br><span class="line"><span class="javascript">      axisOrientation: <span class="string">&quot;neu&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="built_in">global</span>: <span class="literal">true</span>,</span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> fullExtent = [</span></span><br><span class="line">      118.33968849655,</span><br><span class="line">      29.188589472,</span><br><span class="line">      120.71408849655,</span><br><span class="line">      30.5651894750343,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> resolutions = [</span></span><br><span class="line">      0.00549933137239034,</span><br><span class="line">      0.00274966568619517,</span><br><span class="line">      0.00137483284309758,</span><br><span class="line">      0.000687416421548792,</span><br><span class="line">      0.000343708210774396,</span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599e-5,</span><br><span class="line">      4.29635263467995e-5,</span><br><span class="line">      2.14817631733998e-5,</span><br><span class="line">      1.07408815866999e-5,</span><br><span class="line">      5.37044079334994e-6,</span><br><span class="line">      2.68522039667497e-6,</span><br><span class="line">      1.34261019833748e-6,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileGrid = <span class="keyword">new</span> ol.tilegrid.TileGrid(&#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      origin: [118.122911693886, 31.2869311022836],</span><br><span class="line">      extent: fullExtent,</span><br><span class="line">      resolutions: resolutions,</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="comment">// ol.source.XYZ添加瓦片地图的层</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileLayer = <span class="keyword">new</span> ol.layer.Tile(&#123;</span></span><br><span class="line"><span class="javascript">      source: <span class="keyword">new</span> ol.source.XYZ(&#123;</span></span><br><span class="line">        tileGrid: tileGrid,</span><br><span class="line"><span class="javascript">        tileUrlFunction: <span class="function"><span class="keyword">function</span> (<span class="params">tileCoord</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> z = tileCoord[<span class="number">0</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> x = tileCoord[<span class="number">1</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> y = -tileCoord[<span class="number">2</span>] - <span class="number">1</span>;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">            <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver/tile/&quot;</span> +</span></span><br><span class="line">            z +</span><br><span class="line"><span class="javascript">            <span class="string">&quot;/&quot;</span> +</span></span><br><span class="line">            y +</span><br><span class="line"><span class="javascript">            <span class="string">&quot;/&quot;</span> +</span></span><br><span class="line">            x;</span><br><span class="line"><span class="javascript">          <span class="comment">//console.log(url);</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> url;</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        projection: <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vectorSource = <span class="keyword">new</span> ol.source.Vector(&#123;</span></span><br><span class="line"><span class="javascript">      format: <span class="keyword">new</span> ol.format.GeoJSON(),</span></span><br><span class="line"><span class="javascript">      url: <span class="function"><span class="keyword">function</span> (<span class="params">extent</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&quot;</span>;</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="comment">//strategy: bboxStrategy,</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vector = <span class="keyword">new</span> ol.layer.Vector(&#123;</span></span><br><span class="line">      source: vectorSource,</span><br><span class="line"><span class="javascript">      style: <span class="keyword">new</span> ol.style.Style(&#123;</span></span><br><span class="line"><span class="javascript">        stroke: <span class="keyword">new</span> ol.style.Stroke(&#123;</span></span><br><span class="line"><span class="javascript">          color: <span class="string">&quot;rgba(0, 0, 255, 1.0)&quot;</span>,</span></span><br><span class="line">          width: 2,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = <span class="keyword">new</span> ol.Map(&#123;</span></span><br><span class="line"><span class="javascript">      target: <span class="string">&quot;map&quot;</span>,</span></span><br><span class="line">      layers: [tileLayer, vector],</span><br><span class="line"><span class="javascript">      view: <span class="keyword">new</span> ol.View(&#123;</span></span><br><span class="line">        projection: projection,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    map.getView().fit(bounds, map.getSize()); <span class="comment">//非常重要</span></span></span><br><span class="line"><span class="javascript">    map.on(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> location = e.coordinate;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> point = location[<span class="number">0</span>] + <span class="string">&quot;,&quot;</span> + location[<span class="number">1</span>] + <span class="string">&quot;,&quot;</span> + location[<span class="number">0</span>] + <span class="string">&quot;,&quot;</span> + location[<span class="number">1</span>];<span class="comment">// &quot;120.16271670916996,30.251675868508478,120.1713094144393,30.25591314629446&quot;;</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> qurl =</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&amp;CQL_FILTER=&quot;</span>;</span></span><br><span class="line"><span class="javascript">      qurl += <span class="string">&quot; quxian=&#x27;上城区&#x27;&quot;</span>;</span></span><br><span class="line"><span class="javascript">      $.ajax(&#123;</span></span><br><span class="line">        url: qurl,</span><br><span class="line"><span class="javascript">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> text = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line"><span class="javascript">          alert(<span class="string">&quot;根据属性选择的是&quot;</span> + text.features[<span class="number">0</span>].properties[<span class="string">&#x27;quxian&#x27;</span>]);</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2" id="组合查询">组合查询</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>组合查询<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/css/ol.css&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/openlayer/v3.20.1/build/ol.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://172.18.109.232:8082/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> format = <span class="string">&quot;image/png&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> bounds = [</span></span><br><span class="line">      119.347618103027,</span><br><span class="line">      29.7052669525146,</span><br><span class="line">      120.698570251465,</span><br><span class="line">      30.5366992950439,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> projection = <span class="keyword">new</span> ol.proj.Projection(&#123;</span></span><br><span class="line"><span class="javascript">      code: <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line"><span class="javascript">      units: <span class="string">&quot;degrees&quot;</span>,</span></span><br><span class="line"><span class="javascript">      axisOrientation: <span class="string">&quot;neu&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="built_in">global</span>: <span class="literal">true</span>,</span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> fullExtent = [</span></span><br><span class="line">      118.33968849655,</span><br><span class="line">      29.188589472,</span><br><span class="line">      120.71408849655,</span><br><span class="line">      30.5651894750343,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> resolutions = [</span></span><br><span class="line">      0.00549933137239034,</span><br><span class="line">      0.00274966568619517,</span><br><span class="line">      0.00137483284309758,</span><br><span class="line">      0.000687416421548792,</span><br><span class="line">      0.000343708210774396,</span><br><span class="line">      0.000171854105387198,</span><br><span class="line">      8.5927052693599e-5,</span><br><span class="line">      4.29635263467995e-5,</span><br><span class="line">      2.14817631733998e-5,</span><br><span class="line">      1.07408815866999e-5,</span><br><span class="line">      5.37044079334994e-6,</span><br><span class="line">      2.68522039667497e-6,</span><br><span class="line">      1.34261019833748e-6,</span><br><span class="line">    ];</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileGrid = <span class="keyword">new</span> ol.tilegrid.TileGrid(&#123;</span></span><br><span class="line">      tileSize: 256,</span><br><span class="line">      origin: [118.122911693886, 31.2869311022836],</span><br><span class="line">      extent: fullExtent,</span><br><span class="line">      resolutions: resolutions,</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="comment">// ol.source.XYZ添加瓦片地图的层</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> tileLayer = <span class="keyword">new</span> ol.layer.Tile(&#123;</span></span><br><span class="line"><span class="javascript">      source: <span class="keyword">new</span> ol.source.XYZ(&#123;</span></span><br><span class="line">        tileGrid: tileGrid,</span><br><span class="line"><span class="javascript">        tileUrlFunction: <span class="function"><span class="keyword">function</span> (<span class="params">tileCoord</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> z = tileCoord[<span class="number">0</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> x = tileCoord[<span class="number">1</span>];</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> y = -tileCoord[<span class="number">2</span>] - <span class="number">1</span>;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> url =</span></span><br><span class="line"><span class="javascript">            <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver/tile/&quot;</span> +</span></span><br><span class="line">            z +</span><br><span class="line"><span class="javascript">            <span class="string">&quot;/&quot;</span> +</span></span><br><span class="line">            y +</span><br><span class="line"><span class="javascript">            <span class="string">&quot;/&quot;</span> +</span></span><br><span class="line">            x;</span><br><span class="line"><span class="javascript">          <span class="comment">//console.log(url);</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> url;</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        projection: <span class="string">&quot;EPSG:4490&quot;</span>,</span></span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vectorSource = <span class="keyword">new</span> ol.source.Vector(&#123;</span></span><br><span class="line"><span class="javascript">      format: <span class="keyword">new</span> ol.format.GeoJSON(),</span></span><br><span class="line"><span class="javascript">      url: <span class="function"><span class="keyword">function</span> (<span class="params">extent</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&quot;</span>;</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="comment">//strategy: bboxStrategy,</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vector = <span class="keyword">new</span> ol.layer.Vector(&#123;</span></span><br><span class="line">      source: vectorSource,</span><br><span class="line"><span class="javascript">      style: <span class="keyword">new</span> ol.style.Style(&#123;</span></span><br><span class="line"><span class="javascript">        stroke: <span class="keyword">new</span> ol.style.Stroke(&#123;</span></span><br><span class="line"><span class="javascript">          color: <span class="string">&quot;rgba(0, 0, 255, 1.0)&quot;</span>,</span></span><br><span class="line">          width: 2,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> map = <span class="keyword">new</span> ol.Map(&#123;</span></span><br><span class="line"><span class="javascript">      target: <span class="string">&quot;map&quot;</span>,</span></span><br><span class="line">      layers: [tileLayer, vector],</span><br><span class="line"><span class="javascript">      view: <span class="keyword">new</span> ol.View(&#123;</span></span><br><span class="line">        projection: projection,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    map.getView().fit(bounds, map.getSize()); <span class="comment">//非常重要</span></span></span><br><span class="line"><span class="javascript">    map.on(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> location = e.coordinate;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> point = location[<span class="number">0</span>] + <span class="string">&quot;,&quot;</span> + location[<span class="number">1</span>] + <span class="string">&quot;,&quot;</span> + location[<span class="number">0</span>] + <span class="string">&quot;,&quot;</span> + location[<span class="number">1</span>];<span class="comment">// &quot;120.16271670916996,30.251675868508478,120.1713094144393,30.25591314629446&quot;;</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> qurl =</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.0.0&amp;request=getfeature&amp;typename=lsyt_dmdz_qxbj0619&amp;outputFormat=application/json&amp;CQL_FILTER=BBOX(geom,&quot;</span> + point + <span class="string">&quot;)&quot;</span>;</span></span><br><span class="line"><span class="javascript">      qurl += <span class="string">&quot; and quxian=&#x27;上城区&#x27;&quot;</span>;</span></span><br><span class="line"><span class="javascript">      $.ajax(&#123;</span></span><br><span class="line">        url: qurl,</span><br><span class="line"><span class="javascript">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> text = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line"><span class="javascript">          <span class="keyword">if</span> (!text.features.length) &#123;</span></span><br><span class="line"><span class="javascript">            alert(<span class="string">&quot;你选择的是非上城区，无查询结果！&quot;</span>);</span></span><br><span class="line"><span class="javascript">          &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">            alert(<span class="string">&quot;你选择的是 &quot;</span> + text.features[<span class="number">0</span>].properties[<span class="string">&quot;quxian&quot;</span>]);</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="cygwin">Cygwin</h1>
<p>windows使用linux环境（部分机型失败）</p>
<h1 id="tippecanoe"><a target="_blank" rel="noopener" href="https://github.com/mapbox/tippecanoe">Tippecanoe</a></h1>
<blockquote>
<p>Tippecanoe是Mapbox的一个开源切片工具，项目地址：<a target="_blank" rel="noopener" href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fmapbox%2Ftippecanoe">https://github.com/mapbox/tippecanoe</a>，Mapbox常规的切片方法tilelive-copy参见<a target="_blank" rel="noopener" href="https://www.oschina.net/action/GoToLink?url=http%3A%2F%2Fblog.csdn.net%2Fwan_yanyan528%2Farticle%2Fdetails%2F69266362">另一篇博客</a>。Tippecanoe主要在处理大数据量时有很大的优势，具有很高的效率，并且有很多参数可以控制。Tippecanoe只能处理GeoJSON，因此在切片前需要将矢量数据转换为GeoJSON，推荐使用ogr2ogr工具转换。切片以后的格式为mbtiles，可自行导入mongodb等数据库。</p>
<p>目的：根据你的数据创造一个可自由缩放的视图</p>
</blockquote>
<p>引用地址：<a target="_blank" rel="noopener" href="https://my.oschina.net/u/1464512/blog/1631972">https://my.oschina.net/u/1464512/blog/1631972</a></p>
<h4 id="%E5%B8%B8%E7%94%A8tippecanoe%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE" id="常用tippecanoe参数设置"><a target="_blank" rel="noopener" href="https://blog.csdn.net/u012539364/article/details/107068474/">常用tippecanoe参数设置</a></h4>
<h1 id="geojson">GEOJSON</h1>
<h1 id="geosever"><a target="_blank" rel="noopener" href="http://geoserver.org/">GeoSever</a></h1>
<p>GeoServer是OGC Web服务器规范的J2EE实现，利用GeoServer可以方便地发布地图数据，允许用户对特征数据进行更新、删除、插入操作，通过GeoServer可以比较容易地在用户之间迅速共享空间地理信息。GeoServer是开源软件。</p>
<p>GeoServer主要包含如下一些特点：</p>
<ul>
<li>
<p>兼容WMS和WFS特性</p>
</li>
<li>
<p>支持PostGIS、Shapefile、ArcSDE、Oracle、VPF、MySQL、MapInfo</p>
</li>
<li>
<p>支持上百种投影</p>
</li>
<li>
<p>能够将网络地图输出为JPEG、GIF、PNG、SVG、KML等格式</p>
</li>
<li>
<p>能够运行在任何基于J2EE/Servlet容器之上</p>
</li>
<li>
<p>嵌入MapBuilder支持AJAX的地图客户端OpenLayers</p>
</li>
</ul>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35732147/article/details/81869864">引用地址</a></p>
</blockquote>
<h1 id="wms-%26%26-wfs">WMS &amp;&amp; WFS</h1>
<p>WMS是由服务器将一地图图像发送给客户端，而WFS是服务器将矢量数据发送给客户端，也就是在使用WMS时地图由服务器绘制，在使用WFS时地图由客户端绘制。</p>
<h2 id="wms" id="WMS">WMS</h2>
<h3 id="1.2.1-wms%E6%9C%8D%E5%8A%A1%E7%AE%80%E4%BB%8B" id="1-2-1-WMS服务简介">1.2.1 WMS服务简介</h3>
<p>Web Map Service（网络地图服务），简称WMS，由开放地理信息联盟（Open GeoSpatial Consortium，OGC）制定。该规范定义了Web客户端从网络地图服务器获取地图的接口标准。一个WMS可以动态地生成具有地理参考数据的地图，这些地图通常用GIF、JPEG或PNG等图像格式等，使用者通过指定的参数获取相应的地图图片。</p>
<h3 id="1.2.2-%E6%9C%8D%E5%8A%A1%E6%93%8D%E4%BD%9C%E5%88%97%E8%A1%A8" id="1-2-2-服务操作列表">1.2.2 服务操作列表</h3>
<p>WMS实现规范由三个基础性操作协议(GetCapabilities，GetMap和GetFeatureInfo)组成，这些协议共同构成了利用WMS创建和叠加显示不同来源的远程异构地图服务的基础。WMS服务操作列表见下表所示。</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>实现要求</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>GetCapabilities</td>
<td>强制实现</td>
<td>暂关闭</td>
</tr>
<tr>
<td>GetMap</td>
<td>强制实现</td>
<td>获取地图图片。该操作根据客户端发出的请求参数在服务端进行检索，服务器端返回一个地图图像，其地理空间参数和大小参数是已经明确定义的，返回的地图图像可以是GIF、JPEG、PNG或SVG格式。</td>
</tr>
<tr>
<td>GetFeatureInfo</td>
<td>选择实现</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="1.2.3%E6%9C%8D%E5%8A%A1%E6%93%8D%E4%BD%9C%E7%9A%84%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8" id="1-2-3服务操作的参数列表">1.2.3服务操作的参数列表</h3>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数个数</th>
<th>参数类型和值</th>
</tr>
</thead>
<tbody>
<tr>
<td>service</td>
<td>1个(必选)</td>
<td>字符类型，服务类型值为“WMS”</td>
</tr>
<tr>
<td>request</td>
<td>1个(必选)</td>
<td>字符类型，请求的操作名称，值为“GetCapabilities”</td>
</tr>
<tr>
<td>version</td>
<td>0或1个(可选)</td>
<td>字符类型，值为请求的WMS的版本号</td>
</tr>
<tr>
<td>format</td>
<td>0或1个(可选)</td>
<td>MIME类型，值为服务元数据的输出格式</td>
</tr>
</tbody>
</table>
<p>GetMap操作请求方法实现参数</p>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数个数</th>
<th>参数类型和值</th>
</tr>
</thead>
<tbody>
<tr>
<td>service</td>
<td>1个(必选)</td>
<td>字符类型，服务类型标识值为“WMS”</td>
</tr>
<tr>
<td>request</td>
<td>1个(必选)</td>
<td>字符类型，值为“GetMap”</td>
</tr>
<tr>
<td>version</td>
<td>1个(必选)</td>
<td>字符类型，值为请求的WMS的版本号</td>
</tr>
<tr>
<td>layers</td>
<td>1个(必选)</td>
<td>字符类型，值为一个或多个地图图层列表，多个图层之间用”,”隔开</td>
</tr>
<tr>
<td>styles</td>
<td>1个(必选)</td>
<td>字符类型，值为请求图层的地图渲染样式</td>
</tr>
<tr>
<td>CRS</td>
<td>1个(必选)</td>
<td>字符类型，值为坐标参照系统</td>
</tr>
<tr>
<td>BBOX</td>
<td>1个(必选)</td>
<td>Wkt格式，值为某个CRS下的地图边界范围的坐标序列</td>
</tr>
<tr>
<td>width</td>
<td>1个(必选)</td>
<td>整型类型，值为地图图片的像素宽度</td>
</tr>
<tr>
<td>height</td>
<td>1个(必选)</td>
<td>整型类型，值为地图图片的像素高度</td>
</tr>
<tr>
<td>format</td>
<td>1个(必选)</td>
<td>字符类型，值为地图的输出格式</td>
</tr>
<tr>
<td>transparent</td>
<td>0或1个(可选)</td>
<td>字符类型，值为true或者false，用来表示地图图层是否透明(默认情况下是不透明的)</td>
</tr>
<tr>
<td>filter</td>
<td>0或1个(可选)</td>
<td>请求要素的过滤条件</td>
</tr>
</tbody>
</table>
<h3 id="1.2.4-%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B" id="1-2-4-接口调用示例">1.2.4 接口调用示例</h3>
<table>
<thead>
<tr>
<th>实例名称</th>
<th>调用实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>GetCapabilities</td>
<td>暂关闭</td>
</tr>
<tr>
<td>GetMap</td>
<td><a target="_blank" rel="noopener" href="http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_csbj0619/MapServer/wms?SERVICE=WMS&amp;VERSION=1.1.1&amp;REQUEST=GetMap&amp;FORMAT=image%2Fpng&amp;TRANSPARENT=true&amp;LAYERS=gpserver%3Alsyt_dmdz_csbj0619&amp;CQL_FILTER=quxian%3D%27%E6%BB%A8%E6%B1%9F%E5%8C%BA%27&amp;SRS=EPSG%3A4490&amp;STYLES=&amp;WIDTH=768&amp;HEIGHT=546&amp;BBOX=120.05413055419922%2C30.084686279296875%2C120.31780242919922%2C30.272140502929688">http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_csbj0619/MapServer/wms?SERVICE=WMS&amp;VERSION=1.1.1&amp;REQUEST=GetMap&amp;FORMAT=image%2Fpng&amp;TRANSPARENT=true&amp;LAYERS=gpserver%3Alsyt_dmdz_csbj0619&amp;CQL_FILTER=quxian%3D'滨江区'&amp;SRS=EPSG%3A4490&amp;STYLES=&amp;WIDTH=768&amp;HEIGHT=546&amp;BBOX=120.05413055419922%2C30.084686279296875%2C120.31780242919922%2C30.272140502929688</a></td>
</tr>
</tbody>
</table>
<h2 id="wfs" id="WFS">WFS</h2>
<h3 id="1.3.1-wfs%E6%9C%8D%E5%8A%A1%E7%AE%80%E4%BB%8B" id="1-3-1-WFS服务简介">1.3.1 WFS服务简介</h3>
<p>Web Feature Service（网络要素服务），简称WFS，由开放地理信息联盟（Open GeoSpatial Consortium，OGC）制定。该规范主要对OpenGIS简单要素的数据编辑操作进行规范，从而使服务器端和客户端能够在要素层面进行“通讯”。其返回结果的是XML格式的WFS服务元数据文档，通过该文档用户能够了解：WFS服务器支持的所有操作操作列表，GetFeature操作返回的数据格式，可用的坐标参照系统列表，操作异常信息的列表，WFS服务提供商的相关信息，WFS服务器的可用要素类列表等。</p>
<h3 id="1.3.2-%E6%9C%8D%E5%8A%A1%E6%93%8D%E4%BD%9C%E5%88%97%E8%A1%A8" id="1-3-2-服务操作列表">1.3.2 服务操作列表</h3>
<p>WFS服务接口规范定义了GetCapabilities，DescribeFeatureType、GetFeature、Transaction等操作。其中GetCapabilities，DescribeFeatureType和GetFeature为必须实现的操作，也即只要实现了这三个操作的服务均可称为WFS服务。WFS的操作见下表所示。</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>实现要求</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>GetCapabilities</td>
<td>强制实现</td>
<td>GetCapabilities请求用于查询WFS服务的能力信息，包括支持的操作、支持的格式、空间坐标、包含的资源等。它主要的目的是使客户端在使用GetFeature请求前可以对WFS服务有一个基本的了解，从而可以设置正确的参数。</td>
</tr>
<tr>
<td>DescribeFeatureType</td>
<td>强制实现</td>
<td>用于生成一个 Schema 描述，该 Schema 描述了 WFS 服务提供的要素类型（Feature Type），以及要素类型的结构信息。该 Schema 还定义了 WFS 服务所期望的要素实例在输入时如何编码以及输出时如何生成要素实例。</td>
</tr>
<tr>
<td>GetFeature</td>
<td>强制实现</td>
<td>GetFeature用于向WFS的客户端程序提供查询特定地理信息的能力，通过GetFeature操作可以由指定的属性条件、空间条件或者两者叠加的条件进行空间查询。</td>
</tr>
<tr>
<td>Transaction</td>
<td>选择实现</td>
<td>允许Transaction操作，使客户端可对服务器端所提供的地图要素类执插入，更新，删除等命令</td>
</tr>
</tbody>
</table>
<h3 id="1.3.3%E6%9C%8D%E5%8A%A1%E6%93%8D%E4%BD%9C%E7%9A%84%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8" id="1-3-3服务操作的参数列表">1.3.3服务操作的参数列表</h3>
<p>GetCapabilities操作请求方法实现参数</p>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数个数</th>
<th>参数类型和值</th>
</tr>
</thead>
<tbody>
<tr>
<td>service</td>
<td>1个(必选)</td>
<td>字符类型，服务类型值为“WFS”</td>
</tr>
<tr>
<td>request</td>
<td>1个(必选)</td>
<td>字符类型，请求的操作名称，值为“GetCapabilities”</td>
</tr>
<tr>
<td>versions</td>
<td>0或1个(可选)</td>
<td>字符类型，值为请求的WFS的版本号</td>
</tr>
</tbody>
</table>
<p>DescribeFeatureType操作请求方法实现参数</p>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数个数</th>
<th>参数类型和值</th>
</tr>
</thead>
<tbody>
<tr>
<td>service</td>
<td>1个(必选)</td>
<td>字符类型，服务类型值为“WFS”</td>
</tr>
<tr>
<td>request</td>
<td>1个(必选)</td>
<td>字符类型，请求的操作名称，值为“DescribeFeatureType”</td>
</tr>
<tr>
<td>typeName</td>
<td>0或1个(可选)</td>
<td>字符类型，值为要素类型的列表，多个值之间用“，”隔开，默认解析包括的全部要素类型</td>
</tr>
<tr>
<td>outputFormat</td>
<td>0或1个(可选)</td>
<td>MIME类型，值为输出格式</td>
</tr>
</tbody>
</table>
<p>GetFeature操作请求方法实现参数</p>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数个数</th>
<th>参数类型和值</th>
</tr>
</thead>
<tbody>
<tr>
<td>service</td>
<td>1个(必选)</td>
<td>字符类型，服务类型标识值为“WFS”</td>
</tr>
<tr>
<td>request</td>
<td>1个(必选)</td>
<td>字符类型，请求的操作值为“GetFeature”</td>
</tr>
<tr>
<td>typeName</td>
<td>1个(必选)</td>
<td>字符类型，值为请求的要素类型的名称，多个名称之间用“，”隔开</td>
</tr>
<tr>
<td>version</td>
<td>0或1个(可选)</td>
<td>字符类型，值为请求的WFS的版本号</td>
</tr>
<tr>
<td>outputFormat</td>
<td>0或1个(可选)</td>
<td>MIME类型，值为输出格式</td>
</tr>
<tr>
<td>resultType</td>
<td>0或1个(可选)</td>
<td>字符类型，值为请求的结果类型</td>
</tr>
<tr>
<td>propertyName</td>
<td>0或1个(可选)</td>
<td>字符类型，值为请求要素的属性名，多个值之间用“，”隔开</td>
</tr>
<tr>
<td>featureVersion</td>
<td>0或1个(可选)</td>
<td>字符类型，值为要素的版本，值为ALL返回请求的要素的所有版本，没有值默认为返回请求要素的最新版本</td>
</tr>
<tr>
<td>maxFeature</td>
<td>0或1个(可选)</td>
<td>整型类型，值为请求要素的最大数，默认值为满足查询的所有结果集</td>
</tr>
<tr>
<td>expiry</td>
<td>0或1个(可选)</td>
<td>数字类型，要素被锁定的时间</td>
</tr>
<tr>
<td>SRSName</td>
<td>0或1个(可选)</td>
<td>字符类型，值为坐标系统名</td>
</tr>
<tr>
<td>featureID</td>
<td>0或1个(可选)</td>
<td>字符类型，值为要素的ID，多个ID之间用“，”隔开</td>
</tr>
<tr>
<td>filter</td>
<td>0或1个(可选)</td>
<td>请求要素的过滤条件</td>
</tr>
<tr>
<td>bBox</td>
<td>0或1个(可选)</td>
<td>Wkt格式，请求指定要素查询范围，可以替代featureId和filter参数</td>
</tr>
</tbody>
</table>
<h3 id="1.3.4-%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B" id="1-3-4-接口调用示例">1.3.4 接口调用示例</h3>
<table>
<thead>
<tr>
<th>实例名称</th>
<th>调用实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>GetCapabilities</td>
<td><a target="_blank" rel="noopener" href="http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_csbj0619/MapServer/wfs?service=wfs&amp;version=1.1.0&amp;request=getcapabilities">http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_csbj0619/MapServer/wfs?service=wfs&amp;version=1.1.0&amp;request=getcapabilities</a></td>
</tr>
<tr>
<td>DescribeFeatureType</td>
<td><a target="_blank" rel="noopener" href="http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.1.0&amp;request=describefeaturetype&amp;typename=lsyt_dmdz_csbj0619">http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_qxbj0619/MapServer/wfs?service=wfs&amp;version=1.1.0&amp;request=describefeaturetype&amp;typename=lsyt_dmdz_csbj0619</a></td>
</tr>
<tr>
<td>GetFeature</td>
<td><a target="_blank" rel="noopener" href="http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_csbj0619/MapServer/wfs?service=wfs&amp;version=1.1.0&amp;request=getfeature&amp;typename=lsyt_dmdz_csbj0619&amp;outputFormat=json&amp;CQL_FILTER=zhenjie=%27%E9%97%B2%E6%9E%97%E8%A1%97%E9%81%93%27">http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/lsyt_dmdz_csbj0619/MapServer/wfs?service=wfs&amp;version=1.1.0&amp;request=getfeature&amp;typename=lsyt_dmdz_csbj0619&amp;outputFormat=json&amp;CQL_FILTER=zhenjie='闲林街道'</a></td>
</tr>
</tbody>
</table>
<h1 id="wmts">WMTS</h1>
<h2 id="wmts-1" id="WMTS">WMTS</h2>
<h3 id="1.1-wmts%E6%9C%8D%E5%8A%A1%E7%AE%80%E4%BB%8B" id="1-1-WMTS服务简介">1.1 WMTS服务简介</h3>
<p>​		Web Map Tile Service（网络地图瓦片服务），简称WMTS，由开放地理信息联盟（Open GeoSpatial Consortium，OGC）制定，是和WMS并列的重要OGC规范之一。WMTS标准定义了一些操作，这些操作允许用户访问切片地图，是OGC首个支持RESTful访问的服务标准。WMTS不同于WMS,它最重要的特征是采用缓存技术能够缓解WebGIS服务器端数据处理的压力，提高交互响应速度，大幅改善在线地图应用客户端的用户体验。WMTS是OGC主推的缓存技术规范，是目前各种缓存技术相互兼容的一种方法。</p>
<p>WMTS的切片坐标系统和其组织方式可参考下图：</p>
<p><img src="https://gitee.com/mychimei/picture/raw/master/work/clip_image001.png" alt="这里写图片描述" /></p>
<h3 id="1.2-%E6%9C%8D%E5%8A%A1%E6%93%8D%E4%BD%9C%E5%88%97%E8%A1%A8" id="1-2-服务操作列表">1.2 服务操作列表</h3>
<p>WMTS服务支持RESTful访问，其接口包括GetCapabilities、GetTile和GetFeatureInfo3个操作，这些操作允许用户访问切片地图。</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>操作</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>GetCapabilities</td>
<td>强制实现</td>
<td>获取WMTS的能力文档（即元数据文档），里面包含服务的信息</td>
</tr>
<tr>
<td>GetTile</td>
<td>强制实现</td>
<td>该操作根据客户端发出的请求参数在服务端进行检索，服务器端返回地图瓦片图像</td>
</tr>
<tr>
<td>GetFeatureInfo</td>
<td>选择实现</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="1.3-%E6%9C%8D%E5%8A%A1%E6%93%8D%E4%BD%9C%E7%9A%84%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8" id="1-3-服务操作的参数列表">1.3 服务操作的参数列表</h3>
<p>GetCapabilities操作请求方法实现参数</p>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数个数</th>
<th>参数类型和值</th>
</tr>
</thead>
<tbody>
<tr>
<td>service</td>
<td>1个(必选)</td>
<td>字符类型，服务类型值为“WMTS”</td>
</tr>
<tr>
<td>request</td>
<td>1个(必选)</td>
<td>字符类型，请求的操作名称，值为“GetCapabilities”</td>
</tr>
</tbody>
</table>
<p>GetTile操作请求方法实现参数</p>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数个数</th>
<th>参数类型和值</th>
</tr>
</thead>
<tbody>
<tr>
<td>service</td>
<td>1个(必选)</td>
<td>字符类型，服务类型标识值为“WMTS”</td>
</tr>
<tr>
<td>request</td>
<td>1个(必选)</td>
<td>字符类型，请求的操作值为“GetTile”</td>
</tr>
<tr>
<td>version</td>
<td>1个(必选)</td>
<td>字符类型，值为请求的WMTS的版本号</td>
</tr>
<tr>
<td>layer</td>
<td>1个(必选)</td>
<td>字符类型，值为请求的图层名称</td>
</tr>
<tr>
<td>style</td>
<td>1个(必选)</td>
<td>字符类型，值为请求图层的渲染样式</td>
</tr>
<tr>
<td>format</td>
<td>1个(必选)</td>
<td>字符类型，值为瓦片地图的输出格式</td>
</tr>
<tr>
<td>tileMatrixSet</td>
<td>1个(必选)</td>
<td>字符类型，瓦片矩阵数据集，其值在服务的元数据文档中指定</td>
</tr>
<tr>
<td>tileMatrix</td>
<td>1个(必选)</td>
<td>字符类型，瓦片矩阵，其值在服务的元数据文档中指定</td>
</tr>
<tr>
<td>tileRow</td>
<td>1个(必选)</td>
<td>整型类型，值为大于0的整数，表示瓦片矩阵的行号</td>
</tr>
<tr>
<td>tileCol</td>
<td>1个(必选)</td>
<td>整型类型，值为大于0的整数，表示瓦片矩阵的列号</td>
</tr>
</tbody>
</table>
<h3 id="1.4%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B" id="1-4接口调用示例">1.4接口调用示例</h3>
<table>
<thead>
<tr>
<th>实例名称</th>
<th>调用实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>GetCapabilities操作</td>
<td><a target="_blank" rel="noopener" href="http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver/WMTS?service=wmts&amp;request=GetCapabilities">http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver/WMTS?service=wmts&amp;request=GetCapabilities</a></td>
</tr>
<tr>
<td>GetTile操作</td>
<td><a target="_blank" rel="noopener" href="http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver/WMTS?service=wmts&amp;request=getTile&amp;version=1.0.0&amp;layer=hzsyvector&amp;Style=&amp;tilematrixset=hzsyvector&amp;tilematrix=3&amp;tilerow=5&amp;tilecol=7&amp;format=png">http://172.18.109.232:8080/68DE38F71E38CD8C508FAB3035752EA8ED8F9221EDE18FDBE593B01FCDD12BD296F09FE27CD7D2733AD075EAF994851B/PBS/rest/services/hzsyvector/Mapserver/WMTS?service=wmts&amp;request=getTile&amp;version=1.0.0&amp;layer=hzsyvector&amp;Style=&amp;tilematrixset=hzsyvector&amp;tilematrix=3&amp;tilerow=5&amp;tilecol=7&amp;format=png</a>  ****</td>
</tr>
</tbody>
</table>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css"></div><div class="article-licensing box"><div class="licensing-title"><p>GIS</p><p><a href="http://mrdemonlxl.github.io/2021/02/22/Draft/2021/GIS/">http://mrdemonlxl.github.io/2021/02/22/Draft/2021/GIS/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><a href="http://MrDemonlxl.github.io"><p>魑魅先生</p></a></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-02-22</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2022-03-23</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 推荐文章</span><br><span>  1.<a class="is-size-6" href="/2021/02/25/Draft/2021/%E5%BF%AB%E6%9F%A5/" target="_blank">快查</a><br></span><span>  2.<a class="is-size-6" href="/2021/11/10/Draft/2021/JVM%20%E4%B8%8E%E4%B8%8A%E5%B1%82%E6%8A%80%E6%9C%AF/" target="_blank">JVM 与上层技术</a><br></span><span>  3.<a class="is-size-6" href="/2021/02/18/Draft/2021/%E4%BA%94%E5%88%86%E9%92%9F%E6%90%AD%E5%BB%BA%E5%9C%A8%E7%BA%BF%E5%8D%9A%E5%AE%A2/" target="_blank">五分钟搭建在线博客</a><br></span><span>  4.<a class="is-size-6" href="/2021/03/01/Draft/2021/JAVA%E5%BA%94%E7%94%A8/" target="_blank">魑魅先生 | 业务技术</a><br></span><span>  5.<a class="is-size-6" href="/2021/03/01/Draft/2021/%E5%89%8D%E7%AB%AF/" target="_blank">魑魅先生 | 前端</a><br></span><span>  6.<a class="is-size-6" href="/2021/03/01/Draft/2021/Redis/" target="_blank">魑魅先生 | Redis</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="https://gitee.com/mychimei/picture/raw/master/1c4f12804cc5a92919acd743d93a869.jpg" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="https://gitee.com/mychimei/picture/raw/master/260e4f4bc9e4053108cd9d02bae7386.png" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/02/24/Draft/2021/Java/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Java基础深入</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/02/20/Draft/2021/%E8%B5%84%E6%BA%90%E7%AF%87/"><span class="level-item">魑魅先生 | 资源篇</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><div class="card"><div class="card-content"><div class="title is-5">评论</div><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.0/gitalk.css"><script> $.getScript('/js/gitalk.min.js', function () { 
            var gitalk = new Gitalk({
            language:'zh-CN',
            id: '8aed1d935e7f063b128198e8e550082c',
            repo: 'MrDemonlxl.github.io',
            owner: 'MrDemonlxl',
            clientID: '20ef8321698ab8c0c37b',
            clientSecret: '4faa4daae14b55afd2ed357fba92d1e9c7c3f729',
            admin: ["MrDemonlxl"],
            createIssueManually: true,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: 'last',
            proxy: 'https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token',
            
            enableHotKey: true,
            isLocked: false
        })
        gitalk.render('comment-container')});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="is-flex is-mobile" href="#mapbox"><span>MAPBOX</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#mapbox%E6%B5%81%E7%A8%8B"><span>MAPBOX流程</span></a></li><li><a class="is-flex is-mobile" href="#%E8%AF%A6%E7%BB%86%E6%AD%A5%E9%AA%A4"><span>详细步骤</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#ubuntu%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%9A"><span>Ubuntu虚拟机：</span></a></li><li><a class="is-flex is-mobile" href="#windows%EF%BC%9A"><span>windows：</span></a></li><li><a class="is-flex is-mobile" href="#%E4%BC%98%E5%8C%96"><span>优化</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%8A%80%E5%B7%A7"><span>一些小技巧</span></a></li><li><a class="is-flex is-mobile" href="#mapbox%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91"><span>Mapbox源码编译</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87-1"><span>环境准备</span></a></li><li><a class="is-flex is-mobile" href="#%E9%A1%B9%E7%9B%AE%E7%BC%96%E8%AF%91-1"><span>项目编译</span></a></li><li><a class="is-flex is-mobile" href="#%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%B1%82%EF%BC%88wfs%EF%BC%89"><span>矢量图层（wfs）</span></a></li><li><a class="is-flex is-mobile" href="#%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2"><span>组合查询</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#cygwin"><span>Cygwin</span></a></li><li><a class="is-flex is-mobile" href="#tippecanoe"><span>Tippecanoe</span></a><ul class="menu-list"><ul class="menu-list"><li><a class="is-flex is-mobile" href="#%E5%B8%B8%E7%94%A8tippecanoe%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE"><span>常用tippecanoe参数设置</span></a></li></ul></ul></li><li><a class="is-flex is-mobile" href="#geojson"><span>GEOJSON</span></a></li><li><a class="is-flex is-mobile" href="#geosever"><span>GeoSever</span></a></li><li><a class="is-flex is-mobile" href="#wms-%26%26-wfs"><span>WMS &amp;&amp; WFS</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#wms"><span>WMS</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#1.2.1-wms%E6%9C%8D%E5%8A%A1%E7%AE%80%E4%BB%8B"><span>1.2.1 WMS服务简介</span></a></li><li><a class="is-flex is-mobile" href="#1.2.2-%E6%9C%8D%E5%8A%A1%E6%93%8D%E4%BD%9C%E5%88%97%E8%A1%A8"><span>1.2.2 服务操作列表</span></a></li><li><a class="is-flex is-mobile" href="#1.2.3%E6%9C%8D%E5%8A%A1%E6%93%8D%E4%BD%9C%E7%9A%84%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8"><span>1.2.3服务操作的参数列表</span></a></li><li><a class="is-flex is-mobile" href="#1.2.4-%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B"><span>1.2.4 接口调用示例</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#wfs"><span>WFS</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#1.3.1-wfs%E6%9C%8D%E5%8A%A1%E7%AE%80%E4%BB%8B"><span>1.3.1 WFS服务简介</span></a></li><li><a class="is-flex is-mobile" href="#1.3.2-%E6%9C%8D%E5%8A%A1%E6%93%8D%E4%BD%9C%E5%88%97%E8%A1%A8"><span>1.3.2 服务操作列表</span></a></li><li><a class="is-flex is-mobile" href="#1.3.3%E6%9C%8D%E5%8A%A1%E6%93%8D%E4%BD%9C%E7%9A%84%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8"><span>1.3.3服务操作的参数列表</span></a></li><li><a class="is-flex is-mobile" href="#1.3.4-%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B"><span>1.3.4 接口调用示例</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#wmts"><span>WMTS</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#wmts-1"><span>WMTS</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#1.1-wmts%E6%9C%8D%E5%8A%A1%E7%AE%80%E4%BB%8B"><span>1.1 WMTS服务简介</span></a></li><li><a class="is-flex is-mobile" href="#1.2-%E6%9C%8D%E5%8A%A1%E6%93%8D%E4%BD%9C%E5%88%97%E8%A1%A8"><span>1.2 服务操作列表</span></a></li><li><a class="is-flex is-mobile" href="#1.3-%E6%9C%8D%E5%8A%A1%E6%93%8D%E4%BD%9C%E7%9A%84%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8"><span>1.3 服务操作的参数列表</span></a></li><li><a class="is-flex is-mobile" href="#1.4%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B"><span>1.4接口调用示例</span></a></li></ul></li></ul></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://gitee.com/mychimei/picture/raw/master/微信图片_20210131173244.jpg" alt="魑魅先生"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">魑魅先生</p><p class="is-size-6 is-block">快乐永远在解决问题的间隙里(*￣︶￣)</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>浙江-杭州</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">54</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">85</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">43</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/MrDemonlxl" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/MrDemonlxl"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Weibo" href="https://weibo.com/MrDemonlxl"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="/714416426@qq.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Next" href="https://mrdemonlxl.github.io"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="https://mp.weixin.qq.com/mp/profile_ext?action=home&amp;__biz=MzI5NDc0MDg1Mg==#wechat_redirect"><i class="fas fa-rss"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"来源《"+data.from+"》</p><p>提供者-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://www.jianshu.com/u/4af2d33dbe6f" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">简书</span></span><span class="level-right"><span class="level-item tag">www.jianshu.com</span></span></a></li><li><a class="level is-mobile" href="https://blog.csdn.net/qq_37862970" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">CSDN</span></span><span class="level-right"><span class="level-item tag">blog.csdn.net</span></span></a></li><li><a class="level is-mobile" href="https://github.com/MrDemonlxl" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">GitHub</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新评论</h3><span class="body_hot_comment">加载中，最新评论有1分钟缓存...</span></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><figure class="media-left"><a class="image" href="/2021/12/13/Draft/2021/CRUD/"><img src="https://gitee.com/mychimei/picture/raw/master/wallhaven-j8d3rm.png" alt="魑魅先生 | CRUD"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-12-13T14:10:43.000Z">2021-12-13</time></p><p class="title"><a href="/2021/12/13/Draft/2021/CRUD/">魑魅先生 | CRUD</a></p><p class="categories"><a href="/categories/%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/">程序基础</a> / <a href="/categories/%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/CRUD/">CRUD</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/11/10/Draft/2021/JVM%20%E4%B8%8E%E4%B8%8A%E5%B1%82%E6%8A%80%E6%9C%AF/"><img src="https://gitee.com/mychimei/picture/raw/master/39go6v.jpg" alt="JVM 与上层技术"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-11-10T14:10:43.000Z">2021-11-10</time></p><p class="title"><a href="/2021/11/10/Draft/2021/JVM%20%E4%B8%8E%E4%B8%8A%E5%B1%82%E6%8A%80%E6%9C%AF/">JVM 与上层技术</a></p><p class="categories"><a href="/categories/%E5%BA%95%E5%B1%82%E5%AD%A6%E4%B9%A0/">底层学习</a> / <a href="/categories/%E5%BA%95%E5%B1%82%E5%AD%A6%E4%B9%A0/JVM-%E4%B8%8E%E4%B8%8A%E5%B1%82%E6%8A%80%E6%9C%AF/">JVM 与上层技术</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/10/20/Draft/2021/MyBatis-Plus/"><img src="https://gitee.com/mychimei/picture/raw/master/webp.png" alt="MyBatis-Plus"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-10-20T14:10:43.000Z">2021-10-20</time></p><p class="title"><a href="/2021/10/20/Draft/2021/MyBatis-Plus/">MyBatis-Plus</a></p><p class="categories"><a href="/categories/Frame/">Frame</a> / <a href="/categories/Frame/MyBatis-Plus/">MyBatis-Plus</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/07/20/Draft/2021/%E9%97%AA%E5%85%89/"><img src="https://gitee.com/mychimei/picture/raw/master/webp.png" alt="思维闪光"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-07-20T14:10:43.000Z">2021-07-20</time></p><p class="title"><a href="/2021/07/20/Draft/2021/%E9%97%AA%E5%85%89/">思维闪光</a></p><p class="categories"><a href="/categories/%E4%B8%B4%E6%97%B6%E8%AE%B0%E5%BD%95/">临时记录</a> / <a href="/categories/%E4%B8%B4%E6%97%B6%E8%AE%B0%E5%BD%95/%E6%80%9D%E7%BB%B4%E9%97%AA%E5%85%89/">思维闪光</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/05/31/Draft/2021/Python3%E5%AD%A6%E4%B9%A0/"><img src="https://gitee.com/mychimei/picture/raw/master/webp1.png" alt="Python 学习"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-05-31T14:10:43.000Z">2021-05-31</time></p><p class="title"><a href="/2021/05/31/Draft/2021/Python3%E5%AD%A6%E4%B9%A0/">Python 学习</a></p><p class="categories"><a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a> / <a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Python%E5%AD%A6%E4%B9%A0/">Python学习</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/BUG%E8%AE%B0%E5%BD%95/"><span class="level-start"><span class="level-item">BUG记录</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/BUG%E8%AE%B0%E5%BD%95/BUG/"><span class="level-start"><span class="level-item">BUG</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/English/"><span class="level-start"><span class="level-item">English</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/English/%E7%A8%8B%E5%BA%8F%E5%91%98%E8%8B%B1%E8%AF%AD/"><span class="level-start"><span class="level-item">程序员英语</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Frame/"><span class="level-start"><span class="level-item">Frame</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Frame/MyBatis-Plus/"><span class="level-start"><span class="level-item">MyBatis-Plus</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Frame/Spring/"><span class="level-start"><span class="level-item">Spring</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Frame/SpringBoot/"><span class="level-start"><span class="level-item">SpringBoot</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Frame/SpringCloud/"><span class="level-start"><span class="level-item">SpringCloud</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Frame/SpringMVC/"><span class="level-start"><span class="level-item">SpringMVC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/12/"><span class="level-start"><span class="level-item">十二月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/11/"><span class="level-start"><span class="level-item">十一月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/07/"><span class="level-start"><span class="level-item">七月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/05/"><span class="level-start"><span class="level-item">五月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/%E5%B7%A5%E5%85%B7%E6%95%99%E7%A8%8B/"><span class="tag">工具教程</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Frame/"><span class="tag">Frame</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BUG/"><span class="tag">BUG</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SpringCloud/"><span class="tag">SpringCloud</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%89%8D%E7%AB%AF/"><span class="tag">前端</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CRUD/"><span class="tag">CRUD</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dubbo/"><span class="tag">Dubbo</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/English/"><span class="tag">English</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Interesting-Programs/"><span class="tag">Interesting Programs</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Life/"><span class="tag">Life</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MongoDB/"><span class="tag">MongoDB</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NO-GAME-NO-LIFE/"><span class="tag">NO GAME NO LIFE</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Nginx/"><span class="tag">Nginx</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python%E5%AD%A6%E4%B9%A0/"><span class="tag">Python学习</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RabbitMQ/"><span class="tag">RabbitMQ</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Redis/"><span class="tag">Redis</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Software-Engineer/"><span class="tag">Software Engineer</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%B8%B4%E6%97%B6%E8%AE%B0%E5%BD%95/"><span class="tag">临时记录</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%B9%A6%E5%BD%B1%E9%9F%B3/"><span class="tag">书影音</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E5%B8%88/"><span class="tag">信息系统项目管理师</span><span class="tag is-grey-lightest">1</span></a></div></div><div class="field is-grouped is-grouped-multiline"><a class="tags has-addons" href="/tags/"><span class="tag">查看全部&gt;&gt;</span></a></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=mrdemonlxlFeedsId&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="mrdemonlxlFeedsId" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://gitee.com/mychimei/picture/raw/master/彩色logo.png" alt="魑魅先生" height="28"></a><p class="size-small"><span>&copy; 2022 魑魅先生</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© <a href="http://www.beian.miit.gov.cn/" target="_blank">川ICP备88888888号-8</a><br></span><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️本站自 <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> 已运行 <strong>" + dnum + "</strong> 天 <strong>" + hnum + "</strong> 小时 <strong>" + mnum + "</strong> 分 <strong>" + snum + "</strong> 秒！❤️";
        }var now = new Date();setInterval("createTime('2021/02/18 00:00:00')", 250,"");</script><br></span><div class="size-small"><span>❤️感谢 <strong><span id="busuanzi_value_site_uv">99+</span></strong> 小伙伴的 <strong><span id="busuanzi_value_site_pv">99+</span></strong> 次光临！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="3071252637" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('20ef8321698ab8c0c37b','4faa4daae14b55afd2ed357fba92d1e9c7c3f729','MrDemonlxl','MrDemonlxl.github.io',false);})</script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(true){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('20ef8321698ab8c0c37b','4faa4daae14b55afd2ed357fba92d1e9c7c3f729','MrDemonlxl','MrDemonlxl.github.io',false);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>